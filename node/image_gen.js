!function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=13)}([function(t,e,i){"use strict";(function(t){i.d(e,"c",function(){return s}),i.d(e,"d",function(){return h}),i.d(e,"b",function(){return l}),i.d(e,"a",function(){return c});var r=i(5),n=i(2);class s{constructor(t){this.config=t}_setFeatureSource(){}drawScale(t){}getConfig(){return t(!0,{},this.config)}setConfigAttribute(t,e){this.config[t]=e,"url"===t&&this._setFeatureSource()}getFeatureAt(t,e,i,r){return null}setConfig(t){this.config.url!==t.url?(this.config=t,this._setFeatureSource()):this._setFeatureSource()}getFeatures(t,e,i,r,n){return this.feature_source.getFeatures(t,e,i,r,n)}static calculateLabel(t){"string"!=typeof t&&(t=t[0]);let e=t.split("/"),i=e[e.length-1];return i=(e=i.split("."))[0]}addExtraControls(t,e){}static getTypeFromURL(t){let e={};return"string"!=typeof t?e:(t.endsWith("bw")?(e.type="bigwig",e.format="wig"):t.endsWith(".bed.gz")?(e.type="bed",e.format="feature"):t.endsWith(".bb")&&!e.type?(e.type="bigbed",e.format="feature"):t.endsWith(".fasta")?(e.type="fasta",e.format="sequence"):t.endsWith(".bam")&&(e.type="bam",e.format="alignment"),e)}static parseConfig(e){let i=t(!0,{},e);if(!i.type&&i.url){let t=s.getTypeFromURL(i.url);t.type&&(i.type=t.type,i.format=t.format)}return"bed"!==i.type&&"bigbed"!==i.type||(i.format="feature"),!i.short_label&&i.url&&(i.short_label=s.calculateLabel(i.url)),i.track_id||(i.track_id=i.url),"feature"===i.format&&(i.displayMode=i.displayMode||"COLLAPSED",i.labelDisplayMode="SLANT",i.squishedCallHeight=i.squishedCallHeight||30,i.expandedCallHeight=i.expandedCallHeight||15,i.featureHeight=i.featureHeight||12),"wig"!==i.format&&"bigwig"!==i.type||(i.scale||(i.scale="dynamic"),i.min_y||(i.min_y=0),i.max_y||(i.max_y=100),i.height||(i.height=100)),"bam"===i.type&&(i.featureHeight||(i.featureHeight=12)),i.height||(i.height=100),i.color||("bam"===i.type?i.color="#D3D3D3":i.color="black"),i.opacity||(i.opacity=1),i}static getTrack(t){t=s.parseConfig(t);let e=s.track_types[t.type];if(!e)throw new Error("Track type "+t.type+" not recognised");return new e.class(t)}}s.custom_tracks={},s.track_types={};class a extends s{constructor(t){t||(t={track_id:"ruler"+a.count,format:"ruler",short_label:"Ruler",type:"ruler"}),super(t),this.height=30,this.config.height=30,this.name="",this.disableButtons=!0,this.ignoreTrackMenu=!0,this.order=-Number.MAX_VALUE,a.count++}getFeatures(t,e,i){return new Promise(function(t,e){t([])})}drawFeatures(t){var e,i,r,n,s,o,l=t.context;e={textAlign:"center",font:"10px PT Sans",fillStyle:"rgba(64, 64, 64, 1)",strokeStyle:"rgba(64, 64, 64, 1)"},i=Math.floor(1100*t.bpPerPixel),n=(r=a.findSpacing(i)).majorTick,s=Math.floor(t.bpStart/n)-1,o=0;let h=t.top+this.height;for(c.setProperties(l,e);o<t.pixelWidth;){var u=Math.floor(s*n),f=2;o=Math.round((u-1-t.bpStart+.5)/t.bpPerPixel);var d=p(u/r.unitMultiplier,0)+" "+r.majorUnit;s%1==0&&c.fillText(l,d,o,h-15),c.strokeLine(l,o,h-10,o,h-f),s++}function p(t,e){var i=10;switch(e){case 0:i=1;break;case 1:i=10;break;case 2:i=100;break;default:i=1e3}var r=""+Math.abs(Math.round(t*i)/i);-1==r.indexOf(".")&&(r+=".");for(var n=r.substr(0,r.indexOf(".")),s=n-0,a=r.substr(r.indexOf("."));a.length-1<e;)a+="0";if("."==a&&(a=""),s>=1e3){var o=n.length;n=parseInt(""+s/1e3)+","+n.substring(o-3,o)}s>=1e6&&(o=n.length,n=parseInt(""+s/1e6)+","+n.substring(o-7,o));var l=n+a;return t<0&&(l="("+l+")"),l}return c.strokeLine(l,0,h-f,t.pixelWidth,h-f),h}static findSpacing(t){if(t<10)return new o(1,"",1);var e,i,r=Math.floor((e=t,i=Math.log(10),Math.log(e)/i)),n="",s=1;r>9&&(n="gb",s=1e9),r>6?(n="mb",s=1e6):r>3&&(n="kb",s=1e3);var a=t/Math.pow(10,r-1);return new o(a<25?Math.pow(10,r-1):Math.pow(10,r)/2,n,s)}}a.count=0,s.track_types.ruler={class:a,name:"Ruler"};class o{constructor(t,e,i){this.majorTick=t,this.majorUnit=e,this.unitMultiplier=i}}class l extends s{constructor(t){super(t),this._setFeatureSource(),this.filter_function=null,this.color_function=null}_setFeatureSource(){this.feature_source=new n.d(this.config)}setFilterFunction(t){this.filter_function=t}setColorFunction(t){this.color_function=t}getCurrentFeatures(t,e,i){return this.feature_source.featureCache.queryFeatures(t,e,i)}drawFeatures(t){let e=0;var i,r=t.features,n=t.context,s=t.bpPerPixel,a=t.bpStart,o=t.pixelWidth,l=(t.pixelHeight,a+o*s+1);let h=0;t.top&&(h=t.top),this.top=h;let c=this.config,u=0+o;this.config.squishedCallHeight=this.config.featureHeight+10,this.config.expandedCallHeight=this.config.featureHeight/2+2;let f=null;if(r.length>5e4&&(f=Math.round(r.length/5e4)+1),r){let t=this.config.opacity?this.config.opacity:1;n.globalAlpha=t;for(var d,p=0,g=r.length;p<g;p++){if(f&&p%f!=0)continue;if(d=r[p],this.filter_function&&!this.filter_function(d)){d.display=!1;continue}if(d.display=!0,d.end<a)continue;if(d.start>l)break;let t=this.calculateFeatureCoordinates(d,a,s),g=c.featureHeight;"SQUISHED"===c.displayMode&&void 0!=d.row?(g=c.featureHeight/2,i=c.expandedCallHeight*d.row+2):i="EXPANDED"===c.displayMode&&void 0!=d.row?c.squishedCallHeight*d.row+5:5,(i+=h)+g>e&&(e=i+g),t.py=i,t.h=g;let m={bpPerPixel:s,bpStart:a,pixelWidth:o};this.color_function&&(d.color=this.color_function(d)),this.renderFeature(d,t,n,m),this.renderFeatureLabel(n,d,t.px,t.px1,i,0,u)}n.globalAlpha=1}else console.log("No feature list");return this.bottom=e,"COLLAPSED"===this.config.displayMode&&(e+=25),e}renderFeatureLabel(t,e,i,r,n,s,a){let o=this.config;var l,h,u,f,d,p;r<s||i>a?(u=i,f=r):(u=Math.max(i,s),f=Math.min(r,a));let g=e.name;this.label_function&&(g=this.label_function(e)),f-u>t.measureText(g).width&&"SQUISHED"!=o.displayMode&&g&&(l={font:"10px PT Sans",textAlign:"center",fillStyle:o.color,strokeStyle:o.color},"COLLAPSED"===o.displayMode&&"SLANT"===o.labelDisplayMode&&(h={rotate:{angle:45}},delete l.textAlign),d=u+(f-u)/2,p=function(t,e){return e?t+o.featureHeight+14:t+o.featureHeight+7}(n,h),c.fillText(t,g,d,p,l,h))}calculateFeatureCoordinates(t,e,i){var r=Math.round((t.start-e)/i),n=Math.round((t.end-e)/i),s=n-r;return s<3&&(s=3,r-=1),{px:r,px1:n,pw:s}}renderFeature(t,e,i,r){var n,s,a,o,l,h,u,f,d,p,g,m=this.config.color;t.color&&(m=t.color),i.fillStyle=m,i.strokeStyle=m,p=(a=e.py+e.h/2)-(g=e.h/2)/2;let _=t.exons?t.exons.length:0;if(0==_)i.fillRect(e.px,e.py,e.pw,e.h);else{for(e.px=Math.max(e.px,0),e.px1=Math.min(e.px1,r.pixelWidth),c.strokeLine(i,e.px+1,a,e.px1-1,a),o="+"==t.strand?1:-1,s=e.px+10;s<e.px1;s+=20)c.strokeLine(i,s-2*o,a-2,s,a),c.strokeLine(i,s-2*o,a+2,s,a);for(n=0;n<_;n++)if(l=t.exons[n],h=Math.round((l.start-r.bpStart)/r.bpPerPixel),u=Math.round((l.end-r.bpStart)/r.bpPerPixel),d=Math.max(1,u-h),l.utr)i.fillRect(h,p,d,g);else if(l.cdStart&&(f=Math.round((l.cdStart-r.bpStart)/r.bpPerPixel),i.fillRect(h,p,f-h,g),d-=f-h,h=f),l.cdEnd&&(f=Math.round((l.cdEnd-r.bpStart)/r.bpPerPixel),i.fillRect(f,p,u-f,g),d-=u-f,u=f),i.fillRect(h,e.py,d,e.h),d>25){for(i.fillStyle="white",i.strokeStyle="white",s=h+10;s<u;s+=20)c.strokeLine(i,s-2*o,a-2,s,a),c.strokeLine(i,s-2*o,a+2,s,a);i.fillStyle=m,i.strokeStyle=m}}}getFeatureAt(t,e,i,r){let n=i.y-this.top;if(this.feature_source.featureCache){var s,a=2*r,o=this.feature_source.featureCache.queryFeatures(e,t-a,t+a);if("COLLAPSED"!=this.config.displayMode&&(s=Math.floor("SQUISHED"===this.config.displayMode?n/this.config.expandedCallHeight:n/this.config.squishedCallHeight)),o&&o.length>0){for(let e of o)if(e.end>=t-a&&e.start<=t+a&&(void 0===s||void 0===e.row||s===e.row)&&e.display)return e}}return null}}s.track_types.bed={class:l,name:"bed(tabix)"};s.track_types.bigbed={class:class extends l{constructor(t){super(t)}_setFeatureSource(){this.feature_source=new n.a(this.config)}},name:"BigBed"};class h extends s{constructor(t){t.format="wig",super(t),this._setFeatureSource()}_setFeatureSource(){this.feature_source=new r.a(this.config)}drawScale(t,e){if(this.config.scale_link_to&&this.config.group)return;let i=t,r=0;this.config.discrete&&(r=this.top,i=this.bottom);this.max_y,this.min_y;e.beginPath(),e.moveTo(0,r),e.lineTo(0,i),e.moveTo(0,r),e.lineTo(20,r),e.moveTo(0,i),e.lineTo(20,i),e.font="12px Arial",e.stroke(),e.textBaseline="top",e.fillStyle="black",e.fillText(this.max_y.toFixed(2),20,r),e.textBaseline="alphabetic",e.fillText(this.min_y,20,i)}drawFeatures(t){let e,i=this,r=t.features,n=i.config.color,s=t.context,a=t.bpPerPixel,o=t.bpStart,l=t.pixelWidth,h=t.pixelHeight,u=this.config.discrete?t.top:0,f=o+l*a+1;if(this.config.group?h=t.height:this.config.discrete&&(h=this.config.height),n||(n="black"),i.prev_coords={x:0,y:0},r){if(i.scale_link_to){let t=i.scale_link_to.config;t&&(i.config.scale=t.scale,i.max_y=i.scale_link_to.max_y,i.min_y=i.scale_link_to.min_y)}else if(i.set_scale)i.min_y=i.set_scale.min,i.max_y=i.set_scale.max;else if(void 0===i.max_y&&"automatic"===i.config.scale||"dynamic"===i.config.scale){var d=function(t){var e=0,i=-Number.MAX_VALUE;return t.forEach(function(t){e=Math.min(e,t.value),i=Math.max(i,t.value)}),{min:e,max:i}}(r);i.min_y=d.min,i.max_y=d.max}else"fixed"===i.config.scale&&(i.min_y=i.config.min_y,i.max_y=i.config.max_y);e=i.max_y-i.min_y;if(s.globalAlpha=this.config.opacity?this.config.opacity:1,i.is_line){let t=(1-i.config.value/e)*h;c.strokeLine(s,0,t,l,t,{strokeStyle:i.config.color,lineWidth:i.config.width?i.config.width:1})}else r.forEach(function(t,r,l){var d,p,g,m,_,v,b;if(t.end<o)return;if(t.start>f)return;t.end===t.start&&(t.start-=1);g=Math.floor((t.start-o)/a),b=Math.floor((t.end-o)/a),_=Math.max(0,b-g),y=i.min_y,x=i.max_y,y>0&&x<0||y<0&&x>0?t.value<0?(d=i.max_y/e,p=-t.value/e):(d=(i.max_y-t.value)/e,p=t.value/e):i.min_y<0?(d=0,p=-t.value/e):(d=1-(t.value-i.min_y)/e,p=(t.value+i.min_y)/e);var y,x;m=(m=d*h+u)<u?u:m,v=(v=p*h)>h?h:v,"line"===i.config.display?(i.prev_coords.x&&c.strokeLine(s,g,m,i.prev_coords.x,i.prev_coords.y,{strokeStyle:n,lineWidth:3}),i.prev_coords.x=g,i.prev_coords.y=m):c.fillRect(s,g,m,_,v,{fillStyle:n})});if(s.globalAlpha=1,i.config.threshold){let t=u+(1-i.config.threshold/e)*h;c.strokeLine(s,0,t,l,t,{strokeStyle:"black",lineWidth:1})}}if(this.top=u,this.bottom=u+h,this.config.discrete)return this.bottom;this.top=0,this.bottom=0}}s.track_types.bigwig={class:h,name:"BigWig"};s.track_types.line={class:class extends h{constructor(t){super(t),this.is_line=!0}getFeatures(t,e,i){return new Promise(function(t,e){t([])})}},name:"Line Track"};s.track_types.fasta={class:class extends s{constructor(t){super(t),this._setFeatureSource(t),this.sequenceType=t.sequenceType||"dna",this.height=15}_setFeatureSource(t){this.feature_source=new n.b(t.url)}getFeatures(t,e,i,r,n){let s=this;return new Promise(function(r,a){n.bpPerPixel>1?r(null):s.feature_source.getSequence(t,e,i).then(r).catch(a)})}drawFeatures(t){var e,i,r,n,s,a,o,l,h,u,f=t.features,d=t.context,p=t.bpPerPixel,g=t.bpStart,m=g+t.pixelWidth*p+1;let _=t.top;if(f)for(e=f.length,i=1/p,r=_+this.height/2,n=g;n<=m;n++)(s=n-g)<e&&(a=f[s],o=Math.floor(s*i),l=Math.floor((s+1)*i),h=Math.round((o+l)/2),(u=this.color?this.color:"dna"===this.sequenceType?c.nucleotideColors[a]:"rgb(0, 0, 150)")||(u="gray"),p>.15?c.fillRect(d,o,_,l-o,10,{fillStyle:u}):c.strokeText(d,a,h,r,{strokeStyle:u,font:"normal 10px Arial",textAlign:"center"}));return _+10}},name:"Fasta"};class c{static setProperties(t,e){for(var i in e)if(e.hasOwnProperty(i)){var r=e[i];t[i]=r}}static strokeLine(t,e,i,r,n,s){e=Math.floor(e)+.5,i=Math.floor(i)+.5,r=Math.floor(r)+.5,n=Math.floor(n)+.5,t.save(),s&&c.setProperties(t,s),t.beginPath(),t.moveTo(e,i),t.lineTo(r,n),t.stroke(),t.restore()}static fillRect(t,e,i,r,n,s){e=Math.round(e),i=Math.round(i),s&&(t.save(),c.setProperties(t,s)),t.fillRect(e,i,r,n),s&&t.restore()}static fillPolygon(t,e,i,r){t.save(),r&&c.setProperties(t,r),c.doPath(t,e,i),t.fill(),t.restore()}static strokePolygon(t,e,i,r){t.save(),r&&c.setProperties(t,r),c.doPath(t,e,i),t.stroke(),t.restore()}static fillText(t,e,i,r,n,s){if(n&&(t.save(),c.setProperties(t,n)),t.save(),t.translate(i,r),s)for(var a in s){var o=s[a];"translate"==a&&t.translate(o.x,o.y),"rotate"==a&&t.rotate(o.angle*Math.PI/180)}t.fillText(e,0,0),t.restore(),n&&t.restore()}static strokeText(t,e,i,r,n,s){if(t.save(),n&&c.setProperties(t,n),t.translate(i,r),s)for(var a in s){var o=s[a];"translate"==a&&t.translate(o.x,o.y),"rotate"==a&&t.rotate(o.angle*Math.PI/180)}t.strokeText(e,0,0),t.restore()}static strokeCircle(t,e,i,r){t.beginPath(),t.arc(e,i,r,0,2*Math.PI),t.stroke()}static fillCircle(t,e,i,r){t.beginPath(),t.arc(e,i,r,0,2*Math.PI),t.fill()}static drawArrowhead(t,e,i,r,n){t.save(),r||(r=5),n&&(t.lineWidth=n),t.beginPath(),t.moveTo(e,i-r/2),t.lineTo(e,i+r/2),t.lineTo(e+r,i),t.lineTo(e,i-r/2),t.closePath(),t.fill(),t.restore()}static dashedLine(t,e,i,r,n,s,a){t.save(),e=Math.round(e),i=Math.round(i),r=Math.round(r),n=Math.round(n),s=Math.round(s),log("dashedLine"),a&&c.setProperties(t,a),void 0==s&&(s=2),t.moveTo(e,i);for(var o=r-e,l=n-i,h=Math.floor(Math.sqrt(o*o+l*l)/s),u=o/h,f=l/h,d=0;d++<h;)e+=u,i+=f,t[d%2==0?"moveTo":"lineTo"](e,i);t[d%2==0?"moveTo":"lineTo"](r,n),t.restore()}static doPath(t,e,i){var r,n=e.length;for(r=0;r<n;r++)e[r]=Math.round(e[r]),i[r]=Math.round(i[r]);for(t.beginPath(),t.moveTo(e[0],i[0]),r=1;r<n;r++)t.lineTo(e[r],i[r]);t.closePath()}}c.nucleotideColors={A:"green",T:"red",G:"black",C:"blue",a:"green",t:"red",c:"black",g:"blue"}}).call(this,i(11))},function(t,e,i){"use strict";(function(t,r){i.d(e,"a",function(){return h}),i.d(e,"b",function(){return c});var n=i(3);let s=!1;try{navigator}catch(t){s=!0}t.Zlib||(t.Zlib=t);const a=0,o=1,l=2;class h{static load(t,e){return new Promise(function(i,n){var a,o,l,h,c=new r,u=e.sendData,f=e.method||(u?"POST":"GET"),d=e.range,p=e.responseType,g=e.contentType,m=e.mimeType,_=e.headers,v=(!s&&(0==navigator.vendor.indexOf("Apple")&&/\sSafari\//.test(navigator.userAgent)),e.withCredentials);if(c.open(f,t),d){var b=d.size?d.start+d.size-1:"";c.setRequestHeader("Range","bytes="+d.start+"-"+b)}if(g&&c.setRequestHeader("Content-Type",g),m&&c.overrideMimeType(m),p&&(c.responseType=p),_)for(a=Object.keys(_),h=0;h<a.length;h++)l=_[o=a[h]],c.setRequestHeader(o,l);!0===v&&(c.withCredentials=!0),c.timeout=3e4,c.onload=function(e){0==c.status||c.status>=200&&c.status<=300?d&&206!=c.status?y("ERROR: range-byte header was ignored for url: "+t):i(c.response,c):416===c.status?y("Unsatisfiable range"):y("Error accessing resource: "+c.status)},c.onerror=function(e){y("Error accessing resource: "+t+" Status: "+c.status)},c.ontimeout=function(t){y("Timed out")},c.onabort=function(t){console.log("Aborted"),n(new igv.AbortLoad)};try{c.send(u)}catch(t){n(t)}function y(t){if(!n)throw Error(t);n(t)}})}static loadArrayBuffer(t,e){return void 0===e&&(e={}),e.responseType="arraybuffer",h.load(t,e)}static loadJson(t,e){return"POST"==(e.method||(e.sendData?"POST":"GET"))&&(e.contentType="application/json"),new Promise(function(i,r){h.load(t,e).then(function(t){i(t?JSON.parse(t):t)}).catch(r)})}static loadString(t,e){var i,r,n;return void 0===e&&(e={}),r=(n=t.indexOf("?"))>0?t.substring(0,n):t,(i=e.bgz?l:r.endsWith(".gz")?o:a)===a?(e.mimeType="text/plain; charset=x-user-defined",h.load(t,e)):(e.responseType="arraybuffer",new Promise(function(r,n){h.load(t,e).then(function(t){var e=h.arrayBufferToString(t,i);r(e)}).catch(n)}))}static loadStringFromFile(t,e){return new Promise(function(i,r){var n=new FileReader;e.range;n.onload=function(r){var s,c;s=e.bgz?l:t.name.endsWith(".gz")?o:a,c=h.arrayBufferToString(n.result,s),i(c,t)},n.onerror=function(e){console.log("reject uploading local file "+t.name),r(null,n)},n.readAsArrayBuffer(t)})}static isCrossDomain(t){var e=window.location.origin;return!t.startsWith(e)}static arrayBufferToString(e,i){for(var r,n="",s=0,a=(r=i===o?new t.Zlib.Gunzip(new Uint8Array(e)).decompress():i===l?new Uint8Array(c(e)):new Uint8Array(e)).length;s<a;s++)n+=String.fromCharCode(r[s]);return n}}let c=function(t,e){var i=[],r=[0],s=0;for(e=e||t.byteLength-18;r[0]<e;){var a=new Uint8Array(t,r[0],18),o=a[11]<<8|a[10],l=(a[12],a[13],a[15],a[14],a[17]<<8|a[16]+1),h=12+o+r[0],c=t.byteLength-h;if(c<l+8)break;var u=Object(n.b)(t,h,c,r);r[0]+=8,s+=u.byteLength,i.push(u)}if(1==i.length)return i[0];for(var f=new Uint8Array(s),d=0,p=0;p<i.length;++p){var g=new Uint8Array(i[p]);Object(n.a)(g,0,f,d,g.length),d+=g.length}return f.buffer}}).call(this,i(9),i(12))},function(t,e,i){"use strict";i.d(e,"c",function(){return o}),i.d(e,"b",function(){return k}),i.d(e,"a",function(){return h}),i.d(e,"d",function(){return l});var r=i(7),n=i(1),s=i(6),a=i(5);class o{constructor(t){this.config=t||{}}getFileHeader(){return this.is_indexed=!0,new Promise(function(t,e){t()})}getFeatures(t,e,i,r,n){if(this.is_indexed)return this._getFeatures(t,e,i,r,n);var s=this;return new Promise(function(a,o){s.getFileHeader().then(function(){s._getFeatures(t,e,i,r,n).then(function(t){a(t)}).catch(o)}).catch(o)})}_getFeatures(t,e,i,r,n){0===e&&(e=1);var s=this;return s.time=Date.now(),new Promise(function(a,l){s.featureCache&&t!==s.featureCache.range.chr&&(s.featureCache=null);var h=new w(t,e,i),c=s.featureCache,u=s.config.maxRows||500;let f=!1;if(c?void 0!==c.range&&(f=c.range.rangesToGet(h)):f={all:[e,i]},f){let c=[],d=[];for(let e in f){let i=f[e];c.push(s.retrieveFeatures(t,i[0],i[1],r,n)),d.push([e,f[e]])}Promise.all(c).then(function(r){let n=[];s.featureCache&&(n=s.featureCache.allFeatures());let l=0;for(let t of r){if(null===t&&(t=[]),"left"===d[l][0]){let e=d[l][1][1],i=0;for(let r=t.length-1;r>=0&&!(t[r].end<e);r--)i++;0!==i&&t.splice(-i)}if("right"===d[l][0]){let e=d[l][1][0],i=0;for(i=0;i<t.length&&!(t[i].start>e);i++);0!==i&&t.splice(0,i)}l++,n=n.concat(t)}let c=s.featureCache?s.featureCache.range:h;s.featureCache=new g(n,c),o.packFeatures(n,u),a(s.featureCache.queryFeatures(t,e,i))}).catch(function(t){l(t)})}else a(s.featureCache.queryFeatures(t,e,i))})}static packFeatures(t,e){if(null!=t&&0!==t.length){var i={},r=[];t.forEach(function(t){var e=t.chr,n=i[e];n||(n=[],i[e]=n,r.push(e)),n.push(t)}),r.forEach(function(t){!function(t,e){var i=[];t.sort(function(t,e){return t.start-e.start}),i.push(-1e3),t.forEach(function(t){var r,n=Math.min(i.length,e),s=t.start;for(r=0;r<n;r++)if(s>=i[r])return t.row=r,void(i[r]=t.end);t.row=r,i[r]=t.end})}(i[t],e)})}}}class l extends o{constructor(t,e){super(t),this.reader=new u(t,e)}retrieveFeatures(t,e,i){return this.reader.readFeatures(t,e,i)}getFileHeader(){var t=this;return new Promise(function(e,i){t.reader.readHeader().then(function(){t.is_indexed=!0,e()}).catch(i)})}}class h extends o{constructor(t,e){t.sourceType="gtex",super(t),this.header=!0,this.feature_source=new a.a(t,e)}retrieveFeatures(t,e,i,r,n){return this.feature_source.getFeatures(t,e,i,!1,n)}}const c=65536;class u{constructor(t,e){if(this.config=t||{},t.localFile)this.localFile=t.localFile,this.filename=t.localFile.name;else{this.url=t.url,this.indexURL=t.indexURL,this.headURL=t.headURL||this.filename;var i=r.a.parseUri(t.url);this.filename=i.file,this.path=i.path}this.format=t.format,this.parser=this.getParser(this.format,e)}getParser(t,e){switch(t){case"vcf":return new VcfParser;case"seg":return new SegParser;default:return new p(t,e,this.config)}}isIndexable(){var t=this.config.indexURL,e=this.type,i=this.config.indexed;return t||"wig"!=e&&0!=i}loadIndex(){var t=this.indexURL;return this.filename.endsWith(".gz")?(t||(t=this.url+".tbi"),Object(s.c)(t,this.config,!0)):(t||(t=this.url+".idx"),loadTribbleIndex(t,this.config))}loadFeaturesNoIndex(){var t=this;return new Promise(function(e,i){var r=t.parser,s={headers:t.config.headers,withCredentials:t.config.withCredentials};function a(i){t.header=r.parseHeader(i),t.header instanceof String&&t.header.startsWith("##gff-version 3")&&(t.format="gff3"),e(r.parseFeatures(i))}t.localFile?n.a.loadStringFromFile(t.localFile,s).then(a).catch(i):n.a.loadString(t.url,s).then(a).catch(i)})}loadFeaturesWithIndex(t,e,i){var r=this;return new Promise(function(s,a){var o,l=r.index,h=l&&l.tabix?l.sequenceIndexMap[t]:t,u=[];(o=l.blocksForRange(h,e,i))&&0!==o.length?(o.forEach(function(s){u.push(new Promise(function(a,o){var h,u=s.minv.block,f=s.minv.offset,d=s.maxv.block+(l.tabix?c:0),p={headers:r.config.headers,range:{start:u,size:d-u+1},withCredentials:r.config.withCredentials};h=function(s){var o,h;o=l.tabix?n.a.arrayBufferToString(Object(n.b)(s)):s,h=f?o.slice(f):o;var c=r.parser.parseFeatures(h,t,e,i);a(c)},r.localFile?n.a.loadStringFromFile(r.localFile,p).then(h).catch(o):l.tabix?n.a.loadArrayBuffer(r.url,p).then(h).catch(o):n.a.loadString(r.url,p).then(h).catch(o)}))}),Promise.all(u).then(function(t){var e,i;if(1===t.length)i=t[0];else{for(i=t[0],e=1;e<t.length;e++)i=i.concat(t[e]);i.sort(function(t,e){return t.start-e.start})}s(i)}).catch(a)):s(null)})}getIndex(){var t=this,e=this.isIndexable();return new Promise(function(i,r){void 0===t.indexed&&e?t.loadIndex().then(function(e){e?(t.index=e,t.indexed=!0):t.indexed=!1,i(t.index)}).catch(r):i(t.index)})}readHeader(){var t=this;return new Promise(function(e,i){t.header?e(t.header):t.getIndex().then(function(r){if(r){var s={headers:t.config.headers,bgz:r.tabix,range:{start:0,size:65e3},withCredentials:t.config.withCredentials},a=function(i){t.header=t.parser.parseHeader(i),e(t.header)};t.localFile?n.a.loadStringFromFile(t.localFile,s).then(a):n.a.loadString(t.url,s).then(a).catch(i)}else t.loadFeaturesNoIndex(void 0).then(function(i){var r=t.header||{};r.features=i,e(r)}).catch(error)}).catch(i)})}readFeatures(t,e,i){var r=this;return new Promise(function(n,s){function a(t){n(t)}r.index?r.loadFeaturesWithIndex(t,e,i).then(a).catch(s):r.loadFeaturesNoIndex().then(a)})}}const f=Number.MAX_VALUE,d=["Name","gene_name","gene","gene_id","alias","locus"];class p{constructor(t,e,i){this.format=t,this.nameField=i?i.nameField:void 0,this.skipRows=0,e?(this.delimiter=/\s+/,this.decode=function(t,i){let r={chr:t[0],start:parseInt(t[1]),end:parseInt(t[2])};return e(t.slice(3),r),r}):"generic"===i.decode_function?this.decode=function(t,e){let i={chr:t[0],start:parseInt(t[1]),end:parseInt(t[2])};return i.data=t.slice(3),i}:(this.decode=p.decodeBed,this.delimiter=/\s+/)}parseHeader(t){var e,i,r,n=t.split("\n"),s=n.length;for(i=0;i<s;i++){if(!((e=n[i]).startsWith("track")||e.startsWith("#")||e.startsWith("browser"))){r={};break}e.startsWith("track")?r=this.parseTrackLine(e):e.startsWith("##gff-version 3")&&(this.format="gff3",r||(r={}),r.format="gff3")}return r}parseFeatures(t,e,i,r){if(!t)return null;var n,s,a,o,l,h,c=t.split("\n"),u=c.length,d=[],p=0,g=(this.decode,this.format),m=this.delimiter||"\t";for(l=this.skipRows;l<u;l++)if(!((o=c[l]).startsWith("track")||o.startsWith("#")||o.startsWith("browser")))if("wig"===g&&o.startsWith("fixedStep"))n=this.parseFixedStep(o);else if("wig"===g&&o.startsWith("variableStep"))n=this.parseVariableStep(o);else if(!((a=c[l].split(m)).length<1||"wig"!==g&&a.length<3))if(s=this.decode(a,n)){if(s.chr!==e||s.end<i||s.start>r)continue;d.length<f?d.push(s):(h=Math.floor(Math.random()*p))<f&&(d[h]=s),p++}else console.log(null);return d}static parseFixedStep(t){var e=t.split(/\s+/);return{format:"fixedStep",chrom:e[1].split("=")[1],start:parseInt(e[2].split("=")[1],10),step:parseInt(e[3].split("=")[1],10),span:e.length>4?parseInt(e[4].split("=")[1],10):1,index:0}}static parseVariableStep(t){var e=t.split(/\s+/);return{format:"variableStep",chrom:e[1].split("=")[1],span:e.length>2?parseInt(e[2].split("=")[1],10):1}}static parseTrackLine(t){var e,i,r,n={},s=t.split(/(?:")([^"]+)(?:")|([^\s"]+)(?=\s+|$)/g),a=[];for(e=1;e<s.length;e++)s[e]&&0!==s[e].trim().length&&((i=s[e].trim()).endsWith("=")>0?r=i:r?(a.push(r+i),r=void 0):a.push(i));return a.forEach(function(t){if(t){var e=t.split("=",2);2==e.length&&(n[e[0]]=e[1])}}),n}static decodeBed(t,e){var i,r,n,s,a,o,l,h,c,u,f,d,p,g;if(t.length<3)return null;if(i=t[0],r=parseInt(t[1]),n=t.length>2?parseInt(t[2]):r+1,d={chr:i,start:r,end:n,score:1e3},t.length>3){l=(o=t[3].replace(/"/g,"")).split(";");for(var m=0;m<l.length;m++){var _=l[m].split("=");"gene_id"==_[0]&&(s=_[1]),"gene_name"==_[0]&&(a=_[1])}d.id=s||o,d.name=a||o}if(t.length>4&&(d.score=parseFloat(t[4])),t.length>5&&(d.strand=t[5]),t.length>6&&(d.cdStart=parseInt(t[6])),t.length>7&&(d.cdEnd=parseInt(t[7])),t.length>8&&"."!==t[8]&&"0"!==t[8]&&(d.color=igv.createColorString(t[8])),t.length>11){h=parseInt(t[9]),c=t[10].split(","),u=t[11].split(","),f=[];for(m=0;m<h;m++){var v={start:p=r+parseInt(u[m]),end:g=p+parseInt(c[m])};(d.cdStart>g||d.cdEnd<d.cdStart)&&(v.utr=!0),d.cdStart>=p&&d.cdStart<=g&&(v.cdStart=d.cdStart),d.cdEnd>=p&&d.cdEnd<=g&&(v.cdEnd=d.cdEnd),f.push(v)}d.exons=f}return d.popupData=function(){var t=[];return d.name&&t.push({name:"Name",value:d.name}),"+"!==d.strand&&"-"!==d.strand||t.push({name:"Strand",value:d.strand}),t},d}static decodeRefflat(t,e){if(t.length<10)return null;for(var i={chr:t[2],start:parseInt(t[4]),end:parseInt(t[5]),id:t[1],name:t[0],strand:t[3],cdStart:parseInt(t[6]),cdEnd:parseInt(t[7])},r=parseInt(t[8]),n=t[9].split(","),s=t[10].split(","),a=[],o=0;o<r;o++)a.push({start:parseInt(n[o]),end:parseInt(s[o])});return i.exons=a,i.popupData=function(){return[{name:"Name",value:i.name}]},i}static decodePeak(t,e){var i,r,n,s,a,o,l,h,c;return t.length<9?null:(i=t[0],r=parseInt(t[1]),n=parseInt(t[2]),a=t[3],o=parseFloat(t[4]),s=t[5].trim(),h=parseFloat(t[6]),c=parseFloat(t[7]),l=parseFloat(t[8]),0===o&&(o=h),{chr:i,start:r,end:n,name:a,score:o,strand:s,signal:h,pValue:c,qValue:l})}static decodeBedGraph(t,e){return t.length<3?null:{chr:t[0],start:parseInt(t[1]),end:parseInt(t[2]),value:parseFloat(t[3])}}static decodeWig(t,e){var i,r,n;return"fixedStep"===e.format?(r=(i=e.index*e.step+e.start)+e.span,n=parseFloat(t[0]),++e.index,isNaN(n)?null:{chr:e.chrom,start:i,end:r,value:n}):"variableStep"===e.format?t.length<2?null:(r=(i=parseInt(t[0],10))+e.span,n=parseFloat(t[1]),isNaN(n)?null:{chr:e.chrom,start:i,end:r,value:n}):decodeBedGraph(t)}static decodeAneu(t,e){var i,r,n,s;return t.length<4?null:(i=t[1],r=parseInt(t[2]),n=t.length>3?parseInt(t[3]):r+1,s={chr:i,start:r,end:n},t.length>4&&(s.score=parseFloat(t[4]),s.value=s.score),s.popupData=function(){return[{name:"Name",value:s.name}]},s)}static decodeFusionJuncSpan(t,e){var i=t[0],r=t[1],n=parseInt(t[2]),s=parseInt(t[3]),a=parseInt(t[4]),o=parseInt(t[5]),l=t[6],h={chr:i,name:r,junction_left:n,junction_right:s,num_junction_reads:a,num_spanning_frags:o,spanning_frag_coords:[],start:-1,end:-1},c=n,u=s;if(o>0)for(var f=l.split(","),d=0;d<f.length;d++){var p=f[d].split("-"),g=p[0],m=p[1];g<c&&(c=g),m>u&&(u=m),h.spanning_frag_coords.push({left:g,right:m})}return h.start=c,h.end=u,h.popupData=function(){return[{name:"Name",value:h.name}]},h}static decodeGtexGWAS(t,e){return t.length<8?null:{chr:t[0],start:parseInt(t[1])-1,end:parseInt(t[3].split(":")[1]),pvalue:parseFloat(t[5])}}static decodeGFF(t,e){var i,r,n,s,a,o,l,h,c,u,f,p,g=this.format;if(t.length<9)return null;i=t[0],a=t[2],r=parseInt(t[3])-1,n=parseInt(t[4]),o="."===t[5]?0:parseFloat(t[5]),s=t[6],"."===t[7]||parseInt(t[7]),l=t[8];var m="gff3"===g?"=":/\s+/,_={};if(l.split(";").forEach(function(t){var e,i,r=t.trim().split(m,2);2==r.length&&(e=r[0].trim(),(i=r[1].trim()).startsWith('"')&&i.endsWith('"')&&(i=i.substr(1,i.length-2)),"ID"===r[0]?h=r[1]:"Parent"===r[0]?c=r[1]:"color"===r[0].toLowerCase()?u=igv.createColorString(r[1]):"transcript_id"===r[0]&&(h=r[1]),_[e]=i)}),this.nameField)f=_[this.nameField];else for(p=0;p<d.length;p++)if(_.hasOwnProperty(d[p])){this.nameField=d[p],f=_[this.nameField];break}return{id:h,parent:c,name:f,type:a,chr:i,start:r,end:n,score:o,strand:s,color:u,attributeString:l,popupData:function(){var t,e,i=[];return this.attributeString.split(";").forEach(function(r){var n=r.trim().split(m,2);2===n.length&&void 0!==n[1]&&(t=n[0].trim(),(e=n[1].trim()).startsWith('"')&&e.endsWith('"')&&(e=e.substr(1,e.length-2)),i.push({name:t,value:e}))}),i}}}decodeCustom(t,e){var i,r,n,s,a=this.format,o=a.coords||0;return t.length<3?null:(r=t[a.chr],n=parseInt(t[a.start])-o,s=void 0!==a.end?parseInt(t[a.end]):n+1,i={chr:r,start:n,end:s},a.fields&&a.fields.forEach(function(e,r){r!=a.chr&&r!=a.start&&r!=a.end&&(i[e]=t[r])}),i)}}class g{constructor(t,e){this.treeMap=g.buildTreeMap(t),this.range=e}queryFeatures(t,e,i){var r,n,s,a,o,l,h;return(l=this.treeMap[t])?0==(h=l.findOverlapping(e,i)).length?[]:(r=[],h.forEach(function(t){for(n=t.value,a=n.length,o=0;o<a&&!((s=n[o]).start>i);o++)s.end>=e&&r.push(s)}),r):[]}allFeatures(){var t=[],e=this.treeMap;if(e)for(var i in e){if(e.hasOwnProperty(i))e[i].mapIntervals(function(e){t=t.concat(e.value)})}return t}static buildTreeMap(t){var e={},i=[],r={};if(t){t.forEach(function(t){var r,n=t.chr;(r=e[n])||(i.push(n),r=[],e[n]=r),r.push(t)});for(let t=0;t<i.length;t++){let n=i[t];r[n]=g.buildIntervalTree(e[n])}}return r}static buildIntervalTree(t){var e,i,r,n,s,a,o,l;for(s=new b,o=t.length,a=Math.max(10,Math.round(o/100)),t.sort(function(t,e){return t.start===e.start?0:t.start>e.start?1:-1}),e=0;e<o;e+=a)i=Math.min(o,e+a),r=(l=t.slice(e,i))[0].start,n=r,l.forEach(function(t){n=Math.max(n,t.end)}),s.insert(r,n,l);return s}}const m=1,_=2;let v={};v.color=m,v.parent=v,v.left=v,v.right=v;class b{constructor(){this.root=v}insert(t,e,i){var r=new y(t,e,i),n=new x(r);for(this.treeInsert(n),n.color=_;n!=this.root&&n.parent.color==_;){var s;if(n.parent==n.parent.parent.left)(s=n.parent.parent.right).color==_?(n.parent.color=m,s.color=m,n.parent.parent.color=_,n=n.parent.parent):(n==n.parent.right&&(n=n.parent,this.leftRotate(n)),n.parent.color=m,n.parent.parent.color=_,this.rightRotate(n.parent.parent));else(s=n.parent.parent.left).color==_?(n.parent.color=m,s.color=m,n.parent.parent.color=_,n=n.parent.parent):(n==n.parent.left&&(n=n.parent,this.rightRotate(n)),n.parent.color=m,n.parent.parent.color=_,this.leftRotate(n.parent.parent))}this.root.color=m}findOverlapping(t,e){var i=new y(t,e,0);if(this.root===v)return[];var r=this.searchAll(i,this.root,[]);return r.length>1&&r.sort(function(t,e){return t.low-e.low}),r}logIntervals(){!function t(e,i){var r="";for(var n=0;n<i;n++)r+=" ";console.log(r+e.interval.low+" "+e.interval.high);i+=5;e.left!=v&&t(e.left,i);e.right!=v&&t(e.right,i)}(this.root,0)}mapIntervals(t){!function e(i){t(i.interval);i.left!=v&&e(i.left);i.right!=v&&e(i.right)}(this.root)}searchAll(t,e,i){return e.interval.overlaps(t)&&i.push(e.interval),e.left!=v&&e.left.max>=t.low&&this.searchAll(t,e.left,i),e.right!=v&&e.right.min<=t.high&&this.searchAll(t,e.right,i),i}leftRotate(t){var e=t.right;t.right=e.left,e.left!=v&&(e.left.parent=t),e.parent=t.parent,t.parent==v?this.root=e:t.parent.left==t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e,this.applyUpdate(t)}rightRotate(t){var e=t.left;t.left=e.right,e.right!=v&&(e.right.parent=t),e.parent=t.parent,t.parent==v?this.root=e:t.parent.right==t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e,this.applyUpdate(t)}treeInsert(t){for(var e=this.root,i=v;e!=v;)i=e,e=t.interval.low<=e.interval.low?e.left:e.right;t.parent=i,i==v?(this.root=t,t.left=t.right=v):t.interval.low<=i.interval.low?i.left=t:i.right=t,this.applyUpdate(t)}applyUpdate(t){for(;t!=v;){var e=t.left.max>t.right.max?t.left.max:t.right.max,i=t.interval.high;t.max=e>i?e:i;var r=t.left.min<t.right.min?t.left.min:t.right.min,n=t.interval.low;t.min=r<n?r:n,t=t.parent}}}class y{constructor(t,e,i){this.low=t,this.high=e,this.value=i}equals(t){return!!t&&(this==t||this.low==otherInterval.low&&this.high==otherInterval.high)}compareTo(t){return this.low<t.low?-1:this.low>t.low?1:this.high<t.high?-1:this.high>t.high?1:0}overlaps(t){try{return this.low<=t.high&&t.low<=this.high}catch(t){igv.presentAlert(t)}}}class x{constructor(t){this.parent=v,this.left=v,this.right=v,this.interval=t,this.color=_}}class w{constructor(t,e,i,r){this.chr=t,this.start=e,this.end=i,this.features=r}contains(t,e,i){return this.chr==t&&this.start<=e&&this.end>=i}containsRange(t){return this.chr===t.chr&&this.start<=t.start&&this.end>=t.end}rangesToGet(t){let e=!1,i={};return this.chr!==t.chr?(i.all=[t.start,t.end],e=!0,this.start=t.start,this.end=t.end):(t.start<this.start&&(i.left=[t.start,this.start],e=!0,this.start=t.start),t.end>this.end&&(i.right=[this.end,t.end],e=!0,this.end=t.end)),!!e&&i}}class k{constructor(t){this.file=t,this.indexed=!0,this.indexed&&(this.indexFile=this.file+".fai")}init(){var t=this;return t.indexed?new Promise(function(e,i){t.getIndex().then(function(i){var r=0;t.chromosomes={},t.chromosomeNames.forEach(function(e){var i=t.index[e].size;t.chromosomes[e]=new igv.Chromosome(e,r++,i)}),e()}).catch(i)}):t.loadAll()}getSequence(t,e,i){return this.indexed?this.getSequenceIndexed(t,e,i):getSequenceNonIndexed.this(t,e,i)}getSequenceIndexed(t,e,i){var r=this;return new Promise(function(n,s){var a=r.interval;if(a&&a.contains(t,e,i))n(u(a,e,i));else{var o=e,l=i;if(i-e<1e5){var h=i-e,c=Math.round(e+h/2);o=Math.max(0,c-5e4),l=c+5e4}r.readSequence(t,o,l).then(function(s){r.interval=new w(t,o,l,s),n(u(r.interval,e,i))}).catch(s)}function u(t,e,i){var r=e-t.start,n=i-e;return t.features?t.features.substr(r,n):null}})}getSequenceNonIndexed(t,e,i){var r=this;return new Promise(function(n,s){var a=r.sequences[t];a&&a.length>i&&n(a.substring(e,i))})}getIndex(){var t=this;return new Promise(function(e,i){t.index?e(t.index):n.a.load(t.indexFile,{}).then(function(i){var r=i.split("\n"),n=r.length,s=0;for(t.chromosomeNames=[],t.index={};s<n;){var a=r[s++].split("\t");if(5==a.length){var o=a[0],l={size:parseInt(a[1]),position:parseInt(a[2]),basesPerLine:parseInt(a[3]),bytesPerLine:parseInt(a[4])};t.chromosomeNames.push(o),t.index[o]=l}}e&&e(t.index)}).catch(i)})}loadAll(){var t=this;return new Promise(function(e,i){t.chromosomeNames=[],t.chromosomes={},t.sequences={},n.a.load(t.file,{withCredentials:t.withCredentials}).then(function(i){for(var r,n,s=i.splitLines(),a=s.length,o=0,l="",h=0;o<a;)(r=s[o++].trim()).startsWith("#")||0===r.length||(r.startsWith(">")?(l&&(t.chromosomeNames.push(n),t.sequences[n]=l,t.chromosomes[n]=new igv.Chromosome(n,h++,l.length)),n=r.substr(1).split("\\s+")[0],l=""):l+=r);e()})})}readSequence(t,e,i){var r=this;return new Promise(function(s,a){r.getIndex().then(function(){var o=r.index[t];if(o){var l=Math.max(0,e),h=Math.min(o.size,i),c=o.bytesPerLine,u=o.basesPerLine,f=o.position,d=c-u,p=Math.floor(l/u),g=Math.floor(h/u),m=l-p*u,_=f+p*c+m,v=f+g*c+(h-g*u)-1-_+1;v<=0&&s(null),n.a.load(r.file,{range:{start:_,size:v}}).then(function(t){var e,i="",r=0,n=t.length;for(m>0&&(e=Math.min(h-l,u-m),i+=t.substr(r,e),r+=e+d,e);r<n;)e=Math.min(u,n-r),i+=t.substr(r,e),r+=e+d,e;s(i)}).catch(a)}else console.log("No index entry for chr: "+t),r.interval=new w(t,e,i,null),s(null)}).catch(a)})}}},function(t,e,i){"use strict";i.d(e,"b",function(){return E}),i.d(e,"a",function(){return P});var r=15,n=1440,s=0,a=0,o=1,l=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],h=0,c=9,u=5,f=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],d=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],g=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],m=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],_=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];function v(){}function b(){this.was=[0]}v.prototype.inflateInit=function(t,e){return t||(t=r),e&&(e=!1),this.istate=new b,this.istate.inflateInit(this,e?-t:t)},v.prototype.inflate=function(t){return null==this.istate?-2:this.istate.inflate(this,t)},v.prototype.inflateEnd=function(){if(null==this.istate)return-2;var t=istate.inflateEnd(this);return this.istate=null,t},v.prototype.inflateSync=function(){return istate.inflateSync(this)},v.prototype.inflateSetDictionary=function(t,e){return istate.inflateSetDictionary(this,t,e)},b.prototype.inflateReset=function(t){return null==t||null==t.istate?-2:(t.total_in=t.total_out=0,t.msg=null,t.istate.mode=0!=t.istate.nowrap?7:0,t.istate.blocks.reset(t,null),a)},b.prototype.inflateEnd=function(t){return null!=this.blocks&&this.blocks.free(t),this.blocks=null,a},b.prototype.inflateInit=function(t,e){t.msg=null,this.blocks=null;let i=0;return e<0&&(e=-e,i=1),e<8||e>15?(this.inflateEnd(t),-2):(this.wbits=e,t.istate.blocks=new w(t,0!=t.istate.nowrap?null:this,1<<e),this.inflateReset(t),a)},b.prototype.inflate=function(t,e){var i,r;if(null==t||null==t.istate||null==t.next_in)return-2;for(e=4==e?-5:a,i=-5;;)switch(t.istate.mode){case 0:if(0==t.avail_in)return i;if(i=e,t.avail_in--,t.total_in++,8!=(15&(t.istate.method=t.next_in[t.next_in_index++]))){t.istate.mode=13,t.msg="unknown compression method",t.istate.marker=5;break}if(8+(t.istate.method>>4)>t.istate.wbits){t.istate.mode=13,t.msg="invalid window size",t.istate.marker=5;break}t.istate.mode=1;case 1:if(0==t.avail_in)return i;if(i=e,t.avail_in--,t.total_in++,r=255&t.next_in[t.next_in_index++],((t.istate.method<<8)+r)%31!=0){t.istate.mode=13,t.msg="incorrect header check",t.istate.marker=5;break}if(0==(32&r)){t.istate.mode=7;break}t.istate.mode=2;case 2:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need=(255&t.next_in[t.next_in_index++])<<24&4278190080,t.istate.mode=3;case 3:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<16&16711680,t.istate.mode=4;case 4:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<8&65280,t.istate.mode=5;case 5:return 0==t.avail_in?i:(i=e,t.avail_in--,t.total_in++,t.istate.need+=255&t.next_in[t.next_in_index++],t.adler=t.istate.need,t.istate.mode=6,2);case 6:return t.istate.mode=13,t.msg="need dictionary",t.istate.marker=0,-2;case 7:if(-3==(i=t.istate.blocks.proc(t,i))){t.istate.mode=13,t.istate.marker=0;break}if(i==a&&(i=e),i!=o)return i;if(i=e,t.istate.blocks.reset(t,t.istate.was),0!=t.istate.nowrap){t.istate.mode=12;break}t.istate.mode=8;case 8:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need=(255&t.next_in[t.next_in_index++])<<24&4278190080,t.istate.mode=9;case 9:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<16&16711680,t.istate.mode=10;case 10:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<8&65280,t.istate.mode=11;case 11:if(0==t.avail_in)return i;if(i=e,t.avail_in--,t.total_in++,t.istate.need+=255&t.next_in[t.next_in_index++],t.istate.was[0]!=t.istate.need){t.istate.mode=13,t.msg="incorrect data check",t.istate.marker=5;break}t.istate.mode=12;case 12:return o;case 13:return-3;default:return-2}},b.prototype.inflateSetDictionary=function(t,e,i){var r=0,n=i;return null==t||null==t.istate||6!=t.istate.mode?-2:t._adler.adler32(1,e,0,i)!=t.adler?-3:(t.adler=t._adler.adler32(0,null,0,0),n>=1<<t.istate.wbits&&(r=i-(n=(1<<t.istate.wbits)-1)),t.istate.blocks.set_dictionary(e,r,n),t.istate.mode=7,a)};var y=[0,0,255,255];b.prototype.inflateSync=function(t){var e,i,r,n,s;if(null==t||null==t.istate)return-2;if(13!=t.istate.mode&&(t.istate.mode=13,t.istate.marker=0),0==(e=t.avail_in))return-5;for(i=t.next_in_index,r=t.istate.marker;0!=e&&r<4;)t.next_in[i]==y[r]?r++:r=0!=t.next_in[i]?0:4-r,i++,e--;return t.total_in+=i-t.next_in_index,t.next_in_index=i,t.avail_in=e,t.istate.marker=r,4!=r?-3:(n=t.total_in,s=t.total_out,this.inflateReset(t),t.total_in=n,t.total_out=s,t.istate.mode=7,a)},b.prototype.inflateSyncPoint=function(t){return null==t||null==t.istate||null==t.istate.blocks?-2:t.istate.blocks.sync_point()};var x=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function w(t,e,i){this.hufts=new Int32Array(3*n),this.window=new Uint8Array(i),this.end=i,this.checkfn=e,this.mode=h,this.reset(t,null),this.left=0,this.table=0,this.index=0,this.blens=null,this.bb=new Int32Array(1),this.tb=new Int32Array(1),this.codes=new k,this.last=0,this.bitk=0,this.bitb=0,this.read=0,this.write=0,this.check=0,this.inftree=new S}w.prototype.reset=function(t,e){e&&(e[0]=this.check),6==this.mode&&this.codes.free(t),this.mode=h,this.bitk=0,this.bitb=0,this.read=this.write=0,this.checkfn&&(t.adler=this.check=t._adler.adler32(0,null,0,0))},w.prototype.proc=function(t,e){var i,r,n,s,c,u,f;for(s=t.next_in_index,c=t.avail_in,r=this.bitb,n=this.bitk,f=(u=this.write)<this.read?this.read-u-1:this.end-u;;)switch(this.mode){case h:for(;n<3;){if(0==c)return this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=u,this.inflate_flush(t,e);e=a,c--,r|=(255&t.next_in[s++])<<n,n+=8}switch(i=7&r,this.last=1&i,i>>>1){case 0:r>>>=3,r>>>=i=7&(n-=3),n-=i,this.mode=1;break;case 1:A(m=new Int32Array(1),_=new Int32Array(1),v=[],b=[],t),this.codes.init(m[0],_[0],v[0],0,b[0],0,t),r>>>=3,n-=3,this.mode=6;break;case 2:r>>>=3,n-=3,this.mode=3;break;case 3:return r>>>=3,n-=3,this.mode=13,t.msg="invalid block type",e=-3,this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=u,this.inflate_flush(t,e)}break;case 1:for(;n<32;){if(0==c)return this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=u,this.inflate_flush(t,e);e=a,c--,r|=(255&t.next_in[s++])<<n,n+=8}if((~r>>>16&65535)!=(65535&r))return this.mode=13,t.msg="invalid stored block lengths",e=-3,this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=u,this.inflate_flush(t,e);this.left=65535&r,r=n=0,this.mode=0!=left?2:0!=this.last?7:h;break;case 2:if(0==c)return this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,write=u,this.inflate_flush(t,e);if(0==f&&(u==end&&0!=read&&(f=(u=0)<this.read?this.read-u-1:this.end-u),0==f&&(this.write=u,e=this.inflate_flush(t,e),f=(u=this.write)<this.read?this.read-u-1:this.end-u,u==this.end&&0!=this.read&&(f=(u=0)<this.read?this.read-u-1:this.end-u),0==f)))return this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=u,this.inflate_flush(t,e);if(e=a,(i=this.left)>c&&(i=c),i>f&&(i=f),P(t.next_in,s,window,u,i),s+=i,c-=i,u+=i,f-=i,0!=(this.left-=i))break;this.mode=0!=this.last?7:h;break;case 3:for(;n<14;){if(0==c)return this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=u,this.inflate_flush(t,e);e=a,c--,r|=(255&t.next_in[s++])<<n,n+=8}if(this.table=i=16383&r,(31&i)>29||(i>>5&31)>29)return this.mode=9,t.msg="too many length or distance symbols",e=-3,this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=u,this.inflate_flush(t,e);if(i=258+(31&i)+(i>>5&31),null==this.blens||this.blens.length<i)this.blens=new Int32Array(i);else for(var d=0;d<i;d++)this.blens[d]=0;r>>>=14,n-=14,this.index=0,this.mode=4;case 4:for(;this.index<4+(this.table>>>10);){for(;n<3;){if(0==c)return this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=u,this.inflate_flush(t,e);e=a,c--,r|=(255&t.next_in[s++])<<n,n+=8}this.blens[x[this.index++]]=7&r,r>>>=3,n-=3}for(;this.index<19;)this.blens[x[this.index++]]=0;if(this.bb[0]=7,(i=this.inftree.inflate_trees_bits(this.blens,this.bb,this.tb,this.hufts,t))!=a)return-3==(e=i)&&(this.blens=null,this.mode=9),this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,write=u,this.inflate_flush(t,e);this.index=0,this.mode=5;case 5:for(;i=this.table,this.index<258+(31&i)+(i>>5&31);){var p,g;for(i=this.bb[0];n<i;){if(0==c)return this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=u,this.inflate_flush(t,e);e=a,c--,r|=(255&t.next_in[s++])<<n,n+=8}if(i=this.hufts[3*(this.tb[0]+(r&l[i]))+1],(g=this.hufts[3*(this.tb[0]+(r&l[i]))+2])<16)r>>>=i,n-=i,this.blens[this.index++]=g;else{for(d=18==g?7:g-14,p=18==g?11:3;n<i+d;){if(0==c)return this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=u,this.inflate_flush(t,e);e=a,c--,r|=(255&t.next_in[s++])<<n,n+=8}if(n-=i,p+=(r>>>=i)&l[d],r>>>=d,n-=d,(d=this.index)+p>258+(31&(i=this.table))+(i>>5&31)||16==g&&d<1)return this.blens=null,this.mode=9,t.msg="invalid bit length repeat",e=-3,this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=u,this.inflate_flush(t,e);g=16==g?this.blens[d-1]:0;do{this.blens[d++]=g}while(0!=--p);this.index=d}}this.tb[0]=-1;var m=new Int32Array(1),_=new Int32Array(1),v=new Int32Array(1),b=new Int32Array(1);if(m[0]=9,_[0]=6,i=this.table,(i=this.inftree.inflate_trees_dynamic(257+(31&i),1+(i>>5&31),this.blens,m,_,v,b,this.hufts,t))!=a)return-3==i&&(this.blens=null,this.mode=13),e=i,this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=u,this.inflate_flush(t,e);this.codes.init(m[0],_[0],this.hufts,v[0],this.hufts,b[0],t),this.mode=6;case 6:if(this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=u,(e=this.codes.proc(this,t,e))!=o)return this.inflate_flush(t,e);if(e=a,this.codes.free(t),s=t.next_in_index,c=t.avail_in,r=this.bitb,n=this.bitk,f=(u=this.write)<this.read?this.read-u-1:this.end-u,0==this.last){this.mode=h;break}this.mode=7;case 7:if(this.write=u,e=this.inflate_flush(t,e),f=(u=this.write)<this.read?this.read-u-1:this.end-u,this.read!=this.write)return this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=u,this.inflate_flush(t,e);this.mode=12;case 8:return e=o,this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=u,this.inflate_flush(t,e);case 9:return e=-3,this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=u,this.inflate_flush(t,e);default:return e=-2,this.bitb=r,this.bitk=n,t.avail_in=c,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=u,this.inflate_flush(t,e)}},w.prototype.free=function(t){this.reset(t,null),this.window=null,this.hufts=null},w.prototype.set_dictionary=function(t,e,i){P(t,e,window,0,i),this.read=this.write=i},w.prototype.sync_point=function(){return 1==this.mode},w.prototype.inflate_flush=function(t,e){var i,r,n;return r=t.next_out_index,(i=((n=this.read)<=this.write?this.write:this.end)-n)>t.avail_out&&(i=t.avail_out),0!=i&&-5==e&&(e=a),t.avail_out-=i,t.total_out+=i,null!=this.checkfn&&(t.adler=this.check=t._adler.adler32(this.check,this.window,n,i)),P(this.window,n,t.next_out,r,i),r+=i,(n+=i)==this.end&&(n=0,this.write==this.end&&(this.write=0),(i=this.write-n)>t.avail_out&&(i=t.avail_out),0!=i&&-5==e&&(e=a),t.avail_out-=i,t.total_out+=i,null!=this.checkfn&&(t.adler=this.check=t._adler.adler32(this.check,this.window,n,i)),P(this.window,n,t.next_out,r,i),r+=i,n+=i),t.next_out_index=r,this.read=n,e};function k(){}function S(){}function A(t,e,i,r,n){return t[0]=c,e[0]=u,i[0]=f,r[0]=d,a}k.prototype.init=function(t,e,i,r,n,s,a){this.mode=0,this.lbits=t,this.dbits=e,this.ltree=i,this.ltree_index=r,this.dtree=n,this.dtree_index=s,this.tree=null},k.prototype.proc=function(t,e,i){var r,n,s,h,c,u,f,d=0,p=0,g=0;for(g=e.next_in_index,h=e.avail_in,d=t.bitb,p=t.bitk,u=(c=t.write)<t.read?t.read-c-1:t.end-c;;)switch(this.mode){case 0:if(u>=258&&h>=10&&(t.bitb=d,t.bitk=p,e.avail_in=h,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=c,i=this.inflate_fast(this.lbits,this.dbits,this.ltree,this.ltree_index,this.dtree,this.dtree_index,t,e),g=e.next_in_index,h=e.avail_in,d=t.bitb,p=t.bitk,u=(c=t.write)<t.read?t.read-c-1:t.end-c,i!=a)){this.mode=i==o?7:9;break}this.need=this.lbits,this.tree=this.ltree,this.tree_index=this.ltree_index,this.mode=1;case 1:for(r=this.need;p<r;){if(0==h)return t.bitb=d,t.bitk=p,e.avail_in=h,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=c,t.inflate_flush(e,i);i=a,h--,d|=(255&e.next_in[g++])<<p,p+=8}if(n=3*(this.tree_index+(d&l[r])),d>>>=this.tree[n+1],p-=this.tree[n+1],0==(s=this.tree[n])){this.lit=this.tree[n+2],this.mode=6;break}if(0!=(16&s)){this.get=15&s,this.len=this.tree[n+2],this.mode=2;break}if(0==(64&s)){this.need=s,this.tree_index=n/3+this.tree[n+2];break}if(0!=(32&s)){this.mode=7;break}return this.mode=9,e.msg="invalid literal/length code",i=-3,t.bitb=d,t.bitk=p,e.avail_in=h,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=c,t.inflate_flush(e,i);case 2:for(r=this.get;p<r;){if(0==h)return t.bitb=d,t.bitk=p,e.avail_in=h,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=c,t.inflate_flush(e,i);i=a,h--,d|=(255&e.next_in[g++])<<p,p+=8}this.len+=d&l[r],d>>=r,p-=r,this.need=this.dbits,this.tree=this.dtree,this.tree_index=this.dtree_index,this.mode=3;case 3:for(r=this.need;p<r;){if(0==h)return t.bitb=d,t.bitk=p,e.avail_in=h,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=c,t.inflate_flush(e,i);i=a,h--,d|=(255&e.next_in[g++])<<p,p+=8}if(n=3*(this.tree_index+(d&l[r])),d>>=this.tree[n+1],p-=this.tree[n+1],0!=(16&(s=this.tree[n]))){this.get=15&s,this.dist=this.tree[n+2],this.mode=4;break}if(0==(64&s)){this.need=s,this.tree_index=n/3+this.tree[n+2];break}return this.mode=9,e.msg="invalid distance code",i=-3,t.bitb=d,t.bitk=p,e.avail_in=h,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=c,t.inflate_flush(e,i);case 4:for(r=this.get;p<r;){if(0==h)return t.bitb=d,t.bitk=p,e.avail_in=h,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=c,t.inflate_flush(e,i);i=a,h--,d|=(255&e.next_in[g++])<<p,p+=8}this.dist+=d&l[r],d>>=r,p-=r,this.mode=5;case 5:for(f=c-this.dist;f<0;)f+=t.end;for(;0!=this.len;){if(0==u&&(c==t.end&&0!=t.read&&(u=(c=0)<t.read?t.read-c-1:t.end-c),0==u&&(t.write=c,i=t.inflate_flush(e,i),u=(c=t.write)<t.read?t.read-c-1:t.end-c,c==t.end&&0!=t.read&&(u=(c=0)<t.read?t.read-c-1:t.end-c),0==u)))return t.bitb=d,t.bitk=p,e.avail_in=h,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=c,t.inflate_flush(e,i);t.window[c++]=t.window[f++],u--,f==t.end&&(f=0),this.len--}this.mode=0;break;case 6:if(0==u&&(c==t.end&&0!=t.read&&(u=(c=0)<t.read?t.read-c-1:t.end-c),0==u&&(t.write=c,i=t.inflate_flush(e,i),u=(c=t.write)<t.read?t.read-c-1:t.end-c,c==t.end&&0!=t.read&&(u=(c=0)<t.read?t.read-c-1:t.end-c),0==u)))return t.bitb=d,t.bitk=p,e.avail_in=h,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=c,t.inflate_flush(e,i);i=a,t.window[c++]=this.lit,u--,this.mode=0;break;case 7:if(p>7&&(p-=8,h++,g--),t.write=c,i=t.inflate_flush(e,i),u=(c=t.write)<t.read?t.read-c-1:t.end-c,t.read!=t.write)return t.bitb=d,t.bitk=p,e.avail_in=h,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=c,t.inflate_flush(e,i);this.mode=8;case 8:return i=o,t.bitb=d,t.bitk=p,e.avail_in=h,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=c,t.inflate_flush(e,i);case 9:return i=-3,t.bitb=d,t.bitk=p,e.avail_in=h,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=c,t.inflate_flush(e,i);default:return i=-2,t.bitb=d,t.bitk=p,e.avail_in=h,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=c,t.inflate_flush(e,i)}},k.prototype.free=function(t){},k.prototype.inflate_fast=function(t,e,i,r,n,s,h,c){var u,f,d,p,g,m,_,v,b,y,x,w,k,S,A,T;_=c.next_in_index,v=c.avail_in,g=h.bitb,m=h.bitk,y=(b=h.write)<h.read?h.read-b-1:h.end-b,x=l[t],w=l[e];do{for(;m<20;)v--,g|=(255&c.next_in[_++])<<m,m+=8;if(0!=(p=(f=i)[T=3*((d=r)+(u=g&x))]))for(;;){if(g>>=f[T+1],m-=f[T+1],0!=(16&p)){for(p&=15,k=f[T+2]+(g&l[p]),g>>=p,m-=p;m<15;)v--,g|=(255&c.next_in[_++])<<m,m+=8;for(p=(f=n)[T=3*((d=s)+(u=g&w))];;){if(g>>=f[T+1],m-=f[T+1],0!=(16&p)){for(p&=15;m<p;)v--,g|=(255&c.next_in[_++])<<m,m+=8;if(S=f[T+2]+(g&l[p]),g>>=p,m-=p,y-=k,b>=S)A=b-S,h.window[b++]=h.window[A++],h.window[b++]=h.window[A++],k-=2;else{A=b-S;do{A+=h.end}while(A<0);if(k>(p=h.end-A)){if(k-=p,b-A>0&&p>b-A)do{h.window[b++]=h.window[A++]}while(0!=--p);else P(h.window,A,h.window,b,p),b+=p,A+=p,p=0;A=0}}do{h.window[b++]=h.window[A++]}while(0!=--k);break}if(0!=(64&p))return c.msg="invalid distance code",v+=k=m>>3<(k=c.avail_in-v)?m>>3:k,_-=k,m-=k<<3,h.bitb=g,h.bitk=m,c.avail_in=v,c.total_in+=_-c.next_in_index,c.next_in_index=_,h.write=b,-3;u+=f[T+2],p=f[T=3*(d+(u+=g&l[p]))]}break}if(0!=(64&p))return 0!=(32&p)?(v+=k=m>>3<(k=c.avail_in-v)?m>>3:k,_-=k,m-=k<<3,h.bitb=g,h.bitk=m,c.avail_in=v,c.total_in+=_-c.next_in_index,c.next_in_index=_,h.write=b,o):(c.msg="invalid literal/length code",v+=k=m>>3<(k=c.avail_in-v)?m>>3:k,_-=k,m-=k<<3,h.bitb=g,h.bitk=m,c.avail_in=v,c.total_in+=_-c.next_in_index,c.next_in_index=_,h.write=b,-3);if(u+=f[T+2],0==(p=f[T=3*(d+(u+=g&l[p]))])){g>>=f[T+1],m-=f[T+1],h.window[b++]=f[T+2],y--;break}}else g>>=f[T+1],m-=f[T+1],h.window[b++]=f[T+2],y--}while(y>=258&&v>=10);return v+=k=m>>3<(k=c.avail_in-v)?m>>3:k,_-=k,m-=k<<3,h.bitb=g,h.bitk=m,c.avail_in=v,c.total_in+=_-c.next_in_index,c.next_in_index=_,h.write=b,a},S.prototype.huft_build=function(t,e,i,r,s,o,l,h,c,u,f){var d,p,g,m,_,v,b,y,x,w,k,S,A,T,C;w=0,_=i;do{this.c[t[e+w]]++,w++,_--}while(0!=_);if(this.c[0]==i)return l[0]=-1,h[0]=0,a;for(y=h[0],v=1;v<=15&&0==this.c[v];v++);for(b=v,y<v&&(y=v),_=15;0!=_&&0==this.c[_];_--);for(g=_,y>_&&(y=_),h[0]=y,T=1<<v;v<_;v++,T<<=1)if((T-=this.c[v])<0)return-3;if((T-=this.c[_])<0)return-3;for(this.c[_]+=T,this.x[1]=v=0,w=1,A=2;0!=--_;)this.x[A]=v+=this.c[w],A++,w++;_=0,w=0;do{0!=(v=t[e+w])&&(this.v[this.x[v]++]=_),w++}while(++_<i);for(i=this.x[g],this.x[0]=_=0,w=0,m=-1,S=-y,this.u[0]=0,k=0,C=0;b<=g;b++)for(d=this.c[b];0!=d--;){for(;b>S+y;){if(m++,C=(C=g-(S+=y))>y?y:C,(p=1<<(v=b-S))>d+1&&(p-=d+1,A=b,v<C))for(;++v<C&&!((p<<=1)<=this.c[++A]);)p-=this.c[A];if(C=1<<v,this.hn[0]+C>n)return-3;this.u[m]=k=this.hn[0],this.hn[0]+=C,0!=m?(this.x[m]=_,this.r[0]=v,this.r[1]=y,v=_>>>S-y,this.r[2]=k-this.u[m-1]-v,P(this.r,0,c,3*(this.u[m-1]+v),3)):l[0]=k}for(this.r[1]=b-S,w>=i?this.r[0]=192:f[w]<r?(this.r[0]=this.v[w]<256?0:96,this.r[2]=this.v[w++]):(this.r[0]=o[this.v[w]-r]+16+64,this.r[2]=s[this.v[w++]-r]),p=1<<b-S,v=_>>>S;v<C;v+=p)P(this.r,0,c,3*(k+v),3);for(v=1<<b-1;0!=(_&v);v>>>=1)_^=v;for(_^=v,x=(1<<S)-1;(_&x)!=this.x[m];)m--,x=(1<<(S-=y))-1}return 0!=T&&1!=g?-5:a},S.prototype.inflate_trees_bits=function(t,e,i,r,n){var s;return this.initWorkArea(19),this.hn[0]=0,-3==(s=this.huft_build(t,0,19,19,null,null,i,e,r,this.hn,this.v))?n.msg="oversubscribed dynamic bit lengths tree":-5!=s&&0!=e[0]||(n.msg="incomplete dynamic bit lengths tree",s=-3),s},S.prototype.inflate_trees_dynamic=function(t,e,i,r,n,s,o,l,h){var c;return this.initWorkArea(288),this.hn[0]=0,(c=this.huft_build(i,0,t,257,p,g,s,r,l,this.hn,this.v))!=a||0==r[0]?(-3==c?h.msg="oversubscribed literal/length tree":-4!=c&&(h.msg="incomplete literal/length tree",c=-3),c):(this.initWorkArea(288),(c=this.huft_build(i,t,e,0,m,_,o,n,l,this.hn,this.v))!=a||0==n[0]&&t>257?(-3==c?h.msg="oversubscribed distance tree":-5==c?(h.msg="incomplete distance tree",c=-3):-4!=c&&(h.msg="empty distance tree with lengths",c=-3),c):a)},S.prototype.initWorkArea=function(t){null==this.hn&&(this.hn=new Int32Array(1),this.v=new Int32Array(t),this.c=new Int32Array(16),this.r=new Int32Array(3),this.u=new Int32Array(15),this.x=new Int32Array(16)),this.v.length<t&&(this.v=new Int32Array(t));for(var e=0;e<t;e++)this.v[e]=0;for(e=0;e<16;e++)this.c[e]=0;for(e=0;e<3;e++)this.r[e]=0;P(this.c,0,this.u,0,15),P(this.c,0,this.x,0,16)};var T="function"==typeof new Uint8Array(1).subarray;function P(t,e,i,r,n){if(0!=n){if(!t)throw"Undef src";if(!i)throw"Undef dest";0==e&&n==t.length?C(t,i,r):T?C(t.subarray(e,e+n),i,r):1==t.BYTES_PER_ELEMENT&&n>100?C(new Uint8Array(t.buffer,t.byteOffset+e,n),i,r):function(t,e,i,r,n){for(var s=0;s<n;++s)i[r+s]=t[e+s]}(t,e,i,r,n)}}function C(t,e,i){e.set(t,i)}function E(t,e,i,n){t=e?new Uint8Array(t,e,i):new Uint8Array(t);var l=new v;l.inflateInit(r,!0),l.next_in=t,l.next_in_index=0,l.avail_in=t.length;for(var h=[],c=0;;){var u=new Uint8Array(32e3);l.next_out=u,l.next_out_index=0,l.avail_out=u.length;var f=l.inflate(s);if(f!=a&&f!=o)throw l.msg;if(0!=l.avail_out){var d=new Uint8Array(u.length-l.avail_out);P(u,0,d,0,u.length-l.avail_out),u=d}if(h.push(u),c+=u.length,f==o)break}if(n&&(n[0]=(e||0)+l.next_in_index),1==h.length)return h[0].buffer;for(var p=new Uint8Array(c),g=0,m=0;m<h.length;++m){var _=h[m];P(_,0,p,g,_.length),g+=_.length}return p.buffer}},function(t,e){t.exports=require("jquery")},function(t,e,i){"use strict";(function(t,r){i.d(e,"a",function(){return a}),i.d(e,"b",function(){return y});var n=i(1);class s{constructor(t,e,i){this.path=t.url,this.contentLength=e,this.bufferSize=i||512e3,this.range={start:-1,size:-1},this.config=t}dataViewForRange(t,e){var i=this;return new Promise(function(r,s){var a,o;function l(t,e,i){var n=t.data.byteLength,s=e.start-t.range.start,a=i?new Uint8Array(t.data,s,n-s):new DataView(t.data,s,n-s);r(a)}i.data&&i.range.start<=t.start&&i.range.start+i.range.size>=t.start+t.size?l(i,t,e):(a=Math.max(i.bufferSize,t.size),o=i.contentLength>0&&t.start+a>i.contentLength?{start:t.start}:{start:t.start,size:a},n.a.loadArrayBuffer(i.path,Object.assign(i.config,{range:o})).then(function(r){i.data=r,i.range=o,l(i,t,e)}).catch(s))})}}class a{constructor(t,e){this.reader=new f(t),this.bufferedReader=new s(t),this.create_feature=e||a.createFeature}getFeatures(e,i,r,n,s){this.st=(new Date).getTime();var o=this;return new Promise(function(l,h){o.features&&n?l(o.features):o.reader.getZoomHeaders().then(function(n){var c,u=o.reader,f=o.bufferedReader,d=s.bpPerPixel,p=a.zoomLevelForScale(d,n);p&&"BigWig"===u.type?(c=p.indexOffset,o.decodeFunction=a.decodeZoomData):(c=u.header.fullIndexOffset,"BigWig"===u.type?o.decodeFunction=a.decodeWigData:o.decodeFunction=o.decodeBedData),u.loadRPTree(c).then(function(n){var s=o.reader.chromTree.dictionary[e];void 0===s?l(null):n.findLeafItemsOverlapping(s,i,r).then(function(n){var a=[];n&&0!=n.length||l([]),n.forEach(function(n){a.push(new Promise(function(a,l){var h=[];f.dataViewForRange({start:n.dataOffset,size:n.dataSize},!0).then(function(n){var l=new t.Zlib.Inflate(n).decompress();o.decodeFunction(new DataView(l.buffer),e,s,i,r,h),a(h)}).catch(l)}))}),Promise.all(a).then(function(t){(new Date).getTime(),o.st;var e,i=t[0];if(t.length>1)for(e=1;e<t.length;e++)i=i.concat(t[e]);i.sort(function(t,e){return t.start-e.start}),o.features=i,l(i)}).catch(h)}).catch(function(t){h(t)})}).catch(function(t){h(t)})}).catch(function(t){h(t)})})}getDefaultRange(){return void 0!=this.reader.totalSummary?this.reader.totalSummary.defaultRange:void 0}static zoomLevelForScale(t,e){var i,r,n=null;for(i=0;i<e.length;i++)if((r=e[i]).reductionLevel>t){n=r;break}return null==n&&(n=e[e.length-1]),n&&n.reductionLevel<4*t?n:null}static decodeWigData(t,e,i,r,n,s){var a,o=new y(t),l=o.getInt(),h=o.getInt(),c=o.getInt(),u=o.getInt(),f=o.getInt(),d=o.getByte(),p=(o.getByte(),o.getUShort());if(l===i)for(;p-- >0;){switch(d){case 1:h=o.getInt(),c=o.getInt(),a=o.getFloat();break;case 2:h=o.getInt(),a=o.getFloat(),c=h+f;break;case 3:a=o.getFloat(),c=h+f,h+=u}if(h>=n)break;c>r&&Number.isFinite(a)&&s.push({chr:e,start:h,end:c,value:a})}}static decodeZoomData(t,e,i,r,n,s){for(var a,o,l,h,c,u=new y(t);u.remLength()>=32;)if(u.getInt()===i){if(a=u.getInt(),o=u.getInt(),l=u.getInt(),u.getFloat(),u.getFloat(),h=u.getFloat(),u.getFloat(),c=0==l?0:h/l,a>=n&&a<1e9){console.log("should have broken");break}o>r&&Number.isFinite(c)&&s.push({chr:e,start:a,end:o,value:c})}}decodeBedData(t,e,i,r,n,s){for(var a,o,l,h,c,u=new y(t);u.remLength()>=13;)u.getInt()==i&&(a=u.getInt(),o=u.getInt(),l=u.getString(),c={chr:e,start:a,end:o},a<n&&o>=r&&(s.push(c),h=l.split("\t"),this.create_feature(h,c)))}static createFeature(t,e){if(t.length>0&&(e.name=t[0]),t.length>1&&(e.score=parseFloat(t[1])),t.length>2&&(e.strand=t[2]),t.length>3&&(e.cdStart=parseInt(t[3])),t.length>4&&(e.cdEnd=parseInt(t[4])),t.length,t.length>8){exonCount=parseInt(t[6]),exonSizes=t[7].split(","),exonStarts=t[8].split(","),exons=[];for(var i=0;i<exonCount;i++)eStart=start+parseInt(exonStarts[i]),eEnd=eStart+parseInt(exonSizes[i]),exons.push({start:eStart,end:eEnd});e.exons=exons}}}const o=2291137574,l=654085990,h=2273964779,c=3958540679,u=64;class f{constructor(t){this.path=t.url,this.headPath=t.headURL||this.path,this.rpTreeCache={},this.config=r({},t,!0)}getZoomHeaders(){var t=this;return new Promise(function(e,i){t.zoomLevelHeaders?e(t.zoomLevelHeaders):t.loadHeader().then(function(){e(t.zoomLevelHeaders)}).catch(function(t){i(t)})})}loadHeader(){var t=this;return new Promise(function(e,i){n.a.loadArrayBuffer(t.path,Object.assign(t.config,{range:{start:0,size:u}})).then(function(r){if(r){t.littleEndian=!0;var n=new y(new DataView(r));if((s=n.getUInt())===o)t.type="BigWig";else if(s==h)t.type="BigBed";else{var s;t.littleEndian=!1,n.littleEndian=!1,n.position=0,(s=n.getUInt())===l?t.type="BigWig":s==c&&(t.type="BigBed")}t.header={},t.header.bwVersion=n.getUShort(),t.header.nZoomLevels=n.getUShort(),t.header.chromTreeOffset=n.getLong(),t.header.fullDataOffset=n.getLong(),t.header.fullIndexOffset=n.getLong(),t.header.fieldCount=n.getUShort(),t.header.definedFieldCount=n.getUShort(),t.header.autoSqlOffset=n.getLong(),t.header.totalSummaryOffset=n.getLong(),t.header.uncompressBuffSize=n.getInt(),t.header.reserved=n.getLong(),t.loadZoomHeadersAndChrTree().then(e).catch(i)}}).catch(function(t){i(t)})})}loadZoomHeadersAndChrTree(){var t=u,e=this;return new Promise(function(i,r){var s={start:t,size:e.header.fullDataOffset-t+5};n.a.loadArrayBuffer(e.path,Object.assign(e.config,{range:s})).then(function(r){var n,s,a=e.header.nZoomLevels,o=new y(new DataView(r));for(e.zoomLevelHeaders=[],e.firstZoomDataOffset=Number.MAX_VALUE,n=0;n<a;n++)s=new d(a-n,o),e.firstZoomDataOffset=Math.min(s.dataOffset,e.firstZoomDataOffset),e.zoomLevelHeaders.push(s);e.header.autoSqlOffset>0&&(o.position=e.header.autoSqlOffset-t,e.autoSql=o.getString()),e.header.totalSummaryOffset>0&&(o.position=e.header.totalSummaryOffset-t,e.totalSummary=new w(o)),e.header.chromTreeOffset>0&&(o.position=e.header.chromTreeOffset-t,e.chromTree=new k(o,t)),o.position=e.header.fullDataOffset-t,e.dataCount=o.getInt(),i()}).catch(function(t){r(t)})})}loadRPTree(t){var e=this;return new Promise(function(i,r){var n=e.rpTreeCache[t];n?i(n):(n=new v(t,e.contentLength,e.config,e.littleEndian),e.rpTreeCache[t]=n,n.load().then(function(){i(n)}).catch(r))})}}class d{constructor(t,e){this.index=t,this.reductionLevel=e.getInt(),this.reserved=e.getInt(),this.dataOffset=e.getLong(),this.indexOffset=e.getLong()}}const p=48,g=32,m=24,_=512e3;class v{constructor(t,e,i,r){this.config=i,this.filesize=e,this.fileOffset=t,this.path=i.url,this.littleEndian=r}load(){var t=this;return new Promise(function(e,i){var r=t.fileOffset+p,n=new s(t.config,t.filesize,_);t.readNode(r,n).then(function(i){t.rootNode=i,e(t)}).catch(i)})}readNode(t,e){var i=this;return new Promise(function(r,n){e.dataViewForRange({start:t,size:4},!1).then(function(s){var a=new y(s,i.littleEndian),o=1===a.getByte(),l=(a.getByte(),a.getUShort()),h={start:t+=4,size:l*(o?g:m)};e.dataViewForRange(h,!1).then(function(t){var e,i=new Array(l),n=new y(t);if(o){for(e=0;e<l;e++){var s={isLeaf:!0,startChrom:n.getInt(),startBase:n.getInt(),endChrom:n.getInt(),endBase:n.getInt(),dataOffset:n.getLong(),dataSize:n.getLong()};i[e]=s}r(new b(i))}else{for(e=0;e<l;e++){s={isLeaf:!1,startChrom:n.getInt(),startBase:n.getInt(),endChrom:n.getInt(),endBase:n.getInt(),childOffset:n.getLong()};i[e]=s}r(new b(i))}}).catch(n)}).catch(n)})}findLeafItemsOverlapping(t,e,i){var r=this;return new Promise(function(n,a){var o=[],l=new Set,h=new s(r.config,r.filesize,_);l.add(0),function s(c,u){if(v.overlaps(c,t,e,i)){var f=c.items;f.forEach(function(n){v.overlaps(n,t,e,i)&&(n.isLeaf?o.push(n):n.childNode?s(n.childNode):(l.add(n.childOffset),r.readNode(n.childOffset,h).then(function(t){n.childNode=t,s(t,n.childOffset)}).catch(a)))})}void 0!=u&&l.delete(u);0===l.size&&n(o)}(r.rootNode,0)})}static overlaps(t,e,i,r){return t?(e>t.startChrom||e==t.startChrom&&r>=t.startBase)&&(e<t.endChrom||e==t.endChrom&&i<t.endBase):(console.log("null item"),!1)}}class b{constructor(t){this.items=t;var e,i,r=Number.MAX_VALUE,n=0,s=Number.MAX_VALUE,a=0;for(e=0;e<t.length;e++)i=t[e],r=Math.min(r,i.startChrom),n=Math.max(n,i.endChrom),s=Math.min(s,i.startBase),a=Math.max(a,i.endBase);this.startChrom=r,this.endChrom=n,this.startBase=s,this.endBase=a}}class y{constructor(t,e){this.littleEndian=e||!0,this.position=0,this.view=t,this.length=t.byteLength}available(){return this.length-this.position}remLength(){return this.length-this.position}hasNext(){return this.position<this.length-1}getByte(){var t=this.view.getUint8(this.position,this.littleEndian);return this.position++,t}getShort(){var t=this.view.getInt16(this.position,this.littleEndian);return this.position+=2,t}getUShort(){var t=this.view.getUint16(this.position,this.littleEndian);return this.position+=2,t}getInt(){var t=this.view.getInt32(this.position,this.littleEndian);return this.position+=4,t}getUInt(){var t=this.view.getUint32(this.position,this.littleEndian);return this.position+=4,t}getLong(){var t=[];t[0]=this.view.getUint8(this.position),t[1]=this.view.getUint8(this.position+1),t[2]=this.view.getUint8(this.position+2),t[3]=this.view.getUint8(this.position+3),t[4]=this.view.getUint8(this.position+4),t[5]=this.view.getUint8(this.position+5),t[6]=this.view.getUint8(this.position+6),t[7]=this.view.getUint8(this.position+7);var e=0;if(this.littleEndian)for(var i=t.length-1;i>=0;i--)e=256*e+t[i];else for(i=0;i<t.length;i++)e=256*e+t[i];return this.position+=8,e}getString(t){for(var e,i="";0!=(e=this.view.getUint8(this.position++))&&(i+=String.fromCharCode(e),!t||i.length!=t););return i}getFixedLengthString(t){var e,i,r="";for(e=0;e<t;e++)(i=this.view.getUint8(this.position++))>0&&(r+=String.fromCharCode(i));return r}getFixedLengthTrimmedString(t){var e,i,r="";for(e=0;e<t;e++)(i=this.view.getUint8(this.position++))>32&&(r+=String.fromCharCode(i));return r}getFloat(){var t=this.view.getFloat32(this.position,this.littleEndian);return this.position+=4,t}getDouble(){var t=this.view.getFloat64(this.position,this.littleEndian);return this.position+=8,t}skip(t){return this.position+=t,this.position}getVPointer(){var t=this.position,e=this.view.getUint8(t+1)<<8|this.view.getUint8(t),i=4294967296*(255&this.view.getUint8(t+6))+16777216*(255&this.view.getUint8(t+5))+65536*(255&this.view.getUint8(t+4))+256*(255&this.view.getUint8(t+3))+(255&this.view.getUint8(t+2));return this.position+=8,new x(i,e)}}class x{constructor(t,e){this.block=t,this.offset=e}isLessThan(t){return this.block<t.block||this.block===t.block&&this.offset<t.offset}isGreaterThan(t){return this.block>t.block||this.block===t.block&&this.offset>t.offset}print(){return this.block+":"+this.offset}}class w{constructor(t){t?(this.basesCovered=t.getLong(),this.minVal=t.getDouble(),this.maxVal=t.getDouble(),this.sumData=t.getDouble(),this.sumSquares=t.getDouble(),this.computeStats()):(this.basesCovered=0,this.minVal=0,this.maxVal=0,this.sumData=0,this.sumSquares=0,this.mean=0,this.stddev=0)}computeStats(){var t=this.basesCovered;if(t>0){this.mean=this.sumData/t,this.stddev=Math.sqrt(this.sumSquares/(t-1));this.minVal<0&&(this.mean,this.stddev),this.maxVal>0&&(this.mean,this.stddev);this.defaultRange={min:0,max:this.mean+3*this.stddev}}}updateStats(t){this.basesCovered+=t.count,this.sumData+=status.sumData,this.sumSquares+=sumSquares,this.minVal=MIN(_minVal,min),this.maxVal=MAX(_maxVal,max),computeStats.call(this)}}class k{constructor(t,e){var i=null;this.header={},this.header.magic=t.getInt(),this.header.blockSize=t.getInt(),this.header.keySize=t.getInt(),this.header.valSize=t.getInt(),this.header.itemCount=t.getLong(),this.header.reserved=t.getLong(),this.dictionary={},function t(r,n,s,a){n>=0&&(r.position=n);var o,l,h,c,u,f,d=r.getByte(),p=(r.getByte(),r.getUShort());if(1==d)for(o=0;o<p;o++)l=r.getFixedLengthTrimmedString(s),h=r.getInt(),r.getInt(),i&&(l=i.getChromosomeName(l)),a[l]=h;else for(o=0;o<p;o++)l=r.getFixedLengthTrimmedString(s),c=r.getLong(),u=c-e,f=r.position,t(r,u,s,a),r.position=f}(t,-1,this.header.keySize,this.dictionary);this.header.keySize}}}).call(this,i(9),i(11))},function(t,e,i){"use strict";(function(t){i.d(e,"c",function(){return o}),i.d(e,"a",function(){return F}),i.d(e,"b",function(){return j});var r=i(1),n=i(5),s=i(3),a=i(2);let o=function(e,i,s){return new Promise(function(a,o){r.a.loadArrayBuffer(e,{headers:i.headers,withCredentials:i.withCredentials}).then(function(i){var r,o,h,c,u,f,d,p,g,m,_,v,b,y,x=[],w=Number.MAX_VALUE,k=0;if(i){if(s)i=new t.Zlib.Gunzip(new Uint8Array(i)).decompress().buffer;if(!(21578050===(r=(u=new n.b(new DataView(i))).getInt())||s&&21578324===r))throw new Error(e+" is not a "+(s?"tabix":"bai")+" file");if(c=u.getInt(),s){u.getInt(),u.getInt(),u.getInt(),u.getInt(),u.getInt(),u.getInt(),u.getInt();for(y={},v=0;v<c;v++){var S=u.getString();null,y[S]=v}}for(b=0;b<c;++b){for(f={},d=[],o=u.getInt(),_=0;_<o;++_)if(37450==(p=u.getInt())){A=u.getInt(),g=u.getVPointer(),m=u.getVPointer();u.getLong(),u.getLong()}else{f[p]=[];var A=u.getInt();for(v=0;v<A;v++)g=u.getVPointer(),m=u.getVPointer(),g&&m&&(g.block<w&&(w=g.block),m.block>k&&(k=m.block),f[p].push([g,m]))}for(h=u.getInt(),v=0;v<h;v++)g=u.getVPointer(),d.push(g);o>0&&(x[b]={binIndex:f,linearIndex:d})}a(new l(x,w,k,y,s))}else a(null)}).catch(o)})};class l{constructor(t,e,i,r,n){this.firstAlignmentBlock=e,this.indices=t,this.lastAlignmentBlock=i,this.sequenceIndexMap=r,this.tabix=n}blocksForRange(t,e,i){var r,n,s,a,o,h,c,u,f=this.indices[t];if(f){for(r=l.reg2bins(e,i),n=[],r.forEach(function(t){if(f.binIndex[t])for(var e=f.binIndex[t],i=e.length,r=0;r<i;++r){var s=e[r][0],a=e[r][1];n.push({minv:s,maxv:a,bin:t})}}),s=f.linearIndex.length,a=null,o=Math.min(e>>14,s-1),h=Math.min(i>>14,s-1),u=o;u<=h;++u)(c=f.linearIndex[u])&&(a&&!c.isLessThan(a)||(a=c));return function(t,e){var i=[],r=null;return 0===t.length?t:(t.sort(function(t,e){var i=t.minv.block-e.minv.block;return 0!=i?i:t.minv.offset-e.minv.offset}),t.forEach(function(t){e&&!t.maxv.isGreaterThan(e)||(null===r?(i.push(t),r=t):t.minv.block-r.maxv.block<65e3?t.maxv.isGreaterThan(r.maxv)&&(r.maxv=t.maxv):(i.push(t),r=t))}),i)}(n,a)}return[]}static reg2bins(t,e){var i,r=[];for(e>=1<<29&&(e=1<<29),--e,r.push(0),i=1+(t>>26);i<=1+(e>>26);++i)r.push(i);for(i=9+(t>>23);i<=9+(e>>23);++i)r.push(i);for(i=73+(t>>20);i<=73+(e>>20);++i)r.push(i);for(i=585+(t>>17);i<=585+(e>>17);++i)r.push(i);for(i=4681+(t>>14);i<=4681+(e>>14);++i)r.push(i);return r}}var h=["=","A","C","x","G","x","x","x","T","x","x","x","x","x","x","N"],c=["M","I","D","N","S","H","P","=","X","?","?","?","?","?","?","?"],u=16,f=32,d=64,p=128,g=4,m=8,_=1,v=2,b=256,y=2048,x=512,w=1024;const k=65536,S=100,A=50,T=2500;class P{constructor(t){this.config=t,this.filter=t.filter||new q,this.bamPath=t.url,this.baiPath=t.indexURL||this.bamPath+".bai",this.headPath=t.headURL||this.bamPath,this.samplingWindowSize=void 0===t.samplingWindowSize?S:t.samplingWindowSize,this.samplingDepth=void 0===t.samplingDepth?A:t.samplingDepth,this.samplingDepth>T&&(igv.log("Warning: attempt to set sampling depth > maximum value of 2500"),this.samplingDepth=T),t.viewAsPairs?this.pairsSupported=!0:this.pairsSupported=void 0===t.pairsSupported||t.pairsSupported}readAlignments(t,e,i){var n=this;return new Promise(function(a,o){var l;(l=n,new Promise(function(t,e){l.chrToIndex?t(l.chrToIndex):l.readHeader().then(function(){t(l.chrToIndex)}).catch(e)})).then(function(l){var d=l[t],p=new O(t,e,i,n.samplingWindowSize,n.samplingDepth,n.pairsSupported);void 0===d?a(p):C(n).then(function(t){var l=t.blocksForRange(d,e,i),g=[];if(!l)return a(null),void o("Error reading bam index");0!==l.length?(l.forEach(function(t){g.push(new Promise(function(a,o){var l=t.minv.block,g={start:l,size:t.maxv.block+k-l+1};r.a.loadArrayBuffer(n.bamPath,{headers:n.config.headers,range:g,withCredentials:n.config.withCredentials}).then(function(r){!function(t,e,i,r,a,o,l){var d,p,g,m,_,v,b,y,x,w,k,S,A,T,P,C,I,F,M,R,U,L,q,H;for(;;){if(d=E(t,e),(p=e+d+4)>t.length)return;if(g=new D,_=E(t,e+4),v=E(t,e+8),_<0)return;if(_>o||v>a)return;if(!(_<o)){for(b=E(t,e+12),(4294901760&b)>>16,y=(65280&b)>>8,x=255&b,w=E(t,e+16),k=(4294901760&w)>>16,S=65535&w,g.flags=k,g.strand=!(k&u),A=E(t,e+20),T=E(t,e+24),P=E(t,e+28),g.fragmentLength=E(t,e+32),C="",I=0;I<x-1;++I)C+=String.fromCharCode(t[e+36+I]);for(F=e+36+x,M=0,R="",L=[],U=0;U<S;++U){var O=E(t,F),N=O>>4,B=c[15&O];"M"!=B&&"EQ"!=B&&"X"!=B&&"D"!=B&&"N"!=B&&"="!=B||(M+=N),R=R+N+B,F+=4,L.push({len:N,ltr:B})}if(g.cigar=R,g.lengthOnRef=M,!(g.start+g.lengthOnRef<r)){for(q="",H=A+1>>1,I=0;I<H;++I){var W=t[F+I];q+=h[(240&W)>>4],q+=h[15&W]}if(q=q.substring(0,A),F+=H,g.seq=q,1===A&&"*"===String.fromCharCode(t[F+I]+33));else for(g.qual=[],I=0;I<A;++I)g.qual.push(t[F+I]);F+=A,g.start=v,g.mq=y,g.readName=C,g.chr=n.indexToChr[_],T>=0&&(g.mate={chr:n.indexToChr[T],position:P,strand:!(k&f)}),g.tagBA=new Uint8Array(t.buffer.slice(F,p)),F+=p,(!r||g.start<=a&&g.start+g.lengthOnRef>=r&&l.pass(g))&&(void 0!==o&&_!=o||(m=s(g,L),g.blocks=m.blocks,g.insertions=m.insertions,i.push(g))),e=p}}}}(new Uint8Array(new H(r)),t.minv.offset,p,e,i,d,n.filter),a(p)}).catch(function(t){o(t)})}))}),Promise.all(g).then(function(t){p.finish(),a(p)}).catch(function(t){o(t)})):a(p)}).catch(o)}).catch(o)});function s(t,e){for(var i,r,n,s,a=[],o=0,l=t.start,h=e.length,c=0;c<h;c++){var u=e[c];switch(u.ltr){case"H":case"P":break;case"S":o+=u.len,s="S";break;case"N":l+=u.len,s="N";break;case"D":l+=u.len,s="D";break;case"I":r="*"===t.seq?"*":t.seq.substr(o,u.len),n=t.qual?t.qual.slice(o,u.len):void 0,void 0===i&&(i=[]),i.push({start:l,len:u.len,seq:r,qual:n}),o+=u.len;break;case"M":case"EQ":case"=":case"X":r="*"===t.seq?"*":t.seq.substr(o,u.len),n=t.qual?t.qual.slice(o,u.len):void 0,a.push({start:l,len:u.len,seq:r,qual:n,gapType:s}),o+=u.len,l+=u.len;break;default:console.log("Error processing cigar element: "+u.len+u.ltr)}}return{blocks:a,insertions:i}}}readHeader(){var t=this;return new Promise(function(e,i){C(t).then(function(n){var s=n.firstAlignmentBlock+k;r.a.loadArrayBuffer(t.bamPath,{headers:t.config.headers,range:{start:0,size:s},withCredentials:t.config.withCredentials}).then(function(i){for(var r=new H(i,s),n=new Uint8Array(r),a=(E(n,0),E(n,4)),o=0;o<a;++o)String.fromCharCode(n[o+8]);var l=E(n,a+8),h=a+12;t.chrToIndex={},t.indexToChr=[];for(o=0;o<l;++o){for(var c=E(n,h),u="",f=0;f<c-1;++f)u+=String.fromCharCode(n[h+4+f]);E(n,h+c+4);null,t.chrToIndex[u]=o,t.indexToChr.push(u),h=h+8+c}e()}).catch(i)}).catch(i)})}}function C(t){return new Promise(function(e,i){t.index?e(t.index):o(t.baiPath,t.config).then(function(i){t.index=i,e(t.index)}).catch(i)})}function E(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}function I(t,e){return t[e+1]<<8|t[e]}class F{constructor(t){this.config=t,this.alignmentContainer=void 0,this.maxRows=t.maxRows||1e3,t.seq_url&&(this.sequence_source=new a.b(t.seq_url)),"ga4gh"===t.sourceType?this.bamReader=new igv.Ga4ghAlignmentReader(t):this.bamReader=new P(t),this.viewAsPairs=!0}setViewAsPairs(t){var e,i,r;if(this.viewAsPairs!==t&&(this.viewAsPairs=t,this.alignmentContainer)){var n,s=this.alignmentContainer;t?(e=s.packedAlignmentRows,i={},r=[],e.forEach(function(t){t.alignments.forEach(function(t){var e;R(t)?(e=i[t.readName])?(e.setSecondAlignment(t),i[t.readName]=void 0):(e=new igv.PairedAlignment(t),i[t.readName]=e,r.push(e)):r.push(t)})}),n=r):n=M(s.packedAlignmentRows),s.packedAlignmentRows=U(n,s.start,s.end,this.maxRows)}}getAlignments(t,e,i){var r=this;return new Promise(function(n,s){r.alignmentContainer&&r.alignmentContainer.contains(t,e,i)?n(r.alignmentContainer):r.bamReader.readAlignments(t,e,i).then(function(t){var e=r.config.maxRows||500,i=t.alignments;r.viewAsPairs||(i=M([{alignments:i}])),t.packedAlignmentRows=U(i,t.start,t.end,e),t.alignments=void 0,r.alignmentContainer=t,r.sequence_source?r.sequence_source.getSequence(t.chr,t.start,t.end).then(function(e){e&&(t.coverageMap.refSeq=e,t.sequence=e,n(t))}).catch(s):n(t)}).catch(s)})}}function M(t){var e=[];return t.forEach(function(t){t.alignments.forEach(function(t){t instanceof j?(t.firstAlignment&&e.push(t.firstAlignment),t.secondAlignment&&e.push(t.secondAlignment)):e.push(t)})}),e}function R(t){return t.isPaired()&&t.isMateMapped()&&t.chr===t.mate.chr&&(t.isFirstOfPair()||t.isSecondOfPair())&&!(t.isSecondary()||t.isSupplementary())}function U(t,e,i,r){if(t){if(t.sort(function(t,e){return t.start-e.start}),0===t.length)return[];var n,s,a,o,l=[],h=0,c=0,u=e,f=[],d=Math.max(e,t[0].start);for(t.forEach(function(t){var e=Math.max(0,t.start-d);void 0===l[e]&&(l[e]=[]),l[e].push(t)});h<t.length&&f.length<r;){for(n=new G;u<=i;){for(a=void 0;!a&&u<=i;)void 0===l[s=u-d]?++u:a=l[s];if(!a)break;o=a.pop(),0===a.length&&(l[s]=void 0),n.alignments.push(o),u=o.start+o.lengthOnRef+8,++h}if(n.alignments.length>0&&f.push(n),u=d,h===c)break;c=h}return f}}class D{constructor(){this.hidden=!1}isMapped(){return 0==(this.flags&g)}isPaired(){return 0!=(this.flags&_)}isProperPair(){return 0!=(this.flags&v)}isFirstOfPair(){return 0!=(this.flags&d)}isSecondOfPair(){return 0!=(this.flags&p)}isSecondary(){return 0!=(this.flags&b)}isSupplementary(){return 0!=(this.flags&y)}isFailsVendorQualityCheck(){return 0!=(this.flags&x)}isDuplicate(){return 0!=(this.flags&w)}isMateMapped(){return 0==(this.flags&m)}isNegativeStrand(){return 0!=(this.flags&u)}isMateNegativeStrand(){return 0!=(this.flags&f)}tags(){return this.tagDict||(this.tagBA?(this.tagDict=function(t){for(var e=0,i=t.length,r={};e<i;){var n,s=String.fromCharCode(t[e])+String.fromCharCode(t[e+1]),a=String.fromCharCode(t[e+2]);if("A"==a)n=String.fromCharCode(t[e+3]),e+=4;else if("i"===a||"I"===a)n=E(t,e+3),e+=7;else if("c"===a||"C"===a)n=t[e+3],e+=4;else if("s"===a||"S"===a)n=I(t,e+3),e+=5;else if("f"===a)n=L(t,e+3),e+=7;else{if("Z"!==a){n="Error unknown type: "+a,r[s]=n;break}for(e+=3,n="";;){var o=t[e++];if(0===o)break;n+=String.fromCharCode(o)}}r[s]=n}return r}(this.tagBA),this.tagBA=void 0):this.tagDict={}),this.tagDict}popupData(t){var e,i,r=[];if(this.insertions)for(var n=0;n<this.insertions.length;n+=1){var s=this.insertions[n].start;if(t==s||t==s-1)return r.push({name:"Insertion",value:this.insertions[n].seq}),r.push({name:"Location",value:s}),r}for(var a in r.push({name:"Read Name",value:this.readName}),r.push("<hr>"),r.push({name:"Alignment Start",value:igv.numberFormatter(1+this.start),borderTop:!0}),r.push({name:"Read Strand",value:!0===this.strand?"(+)":"(-)",borderTop:!0}),r.push({name:"Cigar",value:this.cigar}),r.push({name:"Mapped",value:o(this.isMapped())}),r.push({name:"Mapping Quality",value:this.mq}),r.push({name:"Secondary",value:o(this.isSecondary())}),r.push({name:"Supplementary",value:o(this.isSupplementary())}),r.push({name:"Duplicate",value:o(this.isDuplicate())}),r.push({name:"Failed QC",value:o(this.isFailsVendorQualityCheck())}),this.isPaired()&&(r.push("<hr>"),r.push({name:"First in Pair",value:!this.isSecondOfPair(),borderTop:!0}),r.push({name:"Mate is Mapped",value:o(this.isMateMapped())}),this.isMateMapped()&&(r.push({name:"Mate Chromosome",value:this.mate.chr}),r.push({name:"Mate Start",value:this.mate.position+1}),r.push({name:"Mate Strand",value:!0===this.mate.strand?"(+)":"(-)"}),r.push({name:"Insert Size",value:this.fragmentLength}))),r.push("<hr>"),e=!0,i=this.tags())i.hasOwnProperty(a)&&(e?(r.push({name:a,value:i[a],borderTop:!0}),e=!1):r.push({name:a,value:i[a]}));return r;function o(t){return t?"Yes":"No"}}}function L(t,e){return new DataView(t.buffer).getFloat32(e,!0)}class q{constructor(t){t||(t={}),this.vendorFailed=void 0===t.vendorFailed||t.vendorFailed,this.duplicates=void 0===t.duplicates||t.duplicates,this.secondary=t.secondary||!1,this.supplementary=t.supplementary||!1,this.mqThreshold=void 0===t.mqThreshold?0:t.mqThreshold}pass(t){return(!this.vendorFailed||!t.isFailsVendorQualityCheck())&&((!this.duplicates||!t.isDuplicate())&&((!this.secondary||!t.isSecondary())&&((!this.supplementary||!t.isSupplementary())&&!(t.mq<this.mqThreshold))))}}class H{constructor(t,e){for(let e in t)console.log(e);var i=[],r=[0],n=0;for(e=e||t.byteLength-18;r[0]<e;){var a=new Uint8Array(t,r[0],18),o=a[11]<<8|a[10],l=(a[12],a[13],a[15],a[14],a[17]<<8|a[16]+1),h=12+o+r[0],c=t.byteLength-h;if(c<l+8)break;var u=Object(s.b)(t,h,c,r);r[0]+=8,n+=u.byteLength,i.push(u)}if(1==i.length)return i[0];for(var f=new Uint8Array(n),d=0,p=0;p<i.length;++p){var g=new Uint8Array(i[p]);Object(s.a)(g,0,f,d,g.length),d+=g.length}return f.buffer}}class O{constructor(t,e,i,r,n,s){this.chr=t,this.start=e,this.end=i,this.length=i-e,this.coverageMap=new W(t,e,i),this.alignments=[],this.downsampledIntervals=[],this.samplingWindowSize=void 0===r?100:r,this.samplingDepth=void 0===n?50:n,this.pairsSupported=s,this.paired=!1,this.pairsCache={},this.downsampledReads=new Set,this.currentBucket=new B(this.start,this.start+this.samplingWindowSize,this),this.filter=function(t){return t.isMapped()&&!t.isFailsVendorQualityCheck()}}push(t){!1!==this.filter(t)&&(this.coverageMap.incCounts(t),this.pairsSupported&&this.downsampledReads.has(t.readName)||(t.start>=this.currentBucket.end&&(N.call(this),this.currentBucket=new B(t.start,t.start+this.samplingWindowSize,this)),this.currentBucket.addAlignment(t)))}forEach(t){this.alignments.forEach(t)}finish(){if(void 0!==this.currentBucket&&N.call(this),this.pairsSupported){var t=[],e=this.downsampledReads;this.alignments.forEach(function(i){e.has(i.readName)||t.push(i)}),this.alignments=t}this.alignments.sort(function(t,e){return t.start-e.start}),this.pairsCache=void 0,this.downsampledReads=void 0}contains(t,e,i){return this.chr==t&&this.start<=e&&this.end>=i}hasDownsampledIntervals(){return this.downsampledIntervals&&this.downsampledIntervals.length>0}}function N(){this.alignments=this.alignments.concat(this.currentBucket.alignments),this.currentBucket.downsampledCount>0&&this.downsampledIntervals.push(new V(this.currentBucket.start,this.currentBucket.end,this.currentBucket.downsampledCount)),this.paired=this.paired||this.currentBucket.paired}class B{constructor(t,e,i){this.start=t,this.end=e,this.alignments=[],this.downsampledCount=0,this.samplingDepth=i.samplingDepth,this.pairsSupported=i.pairsSupported,this.downsampledReads=i.downsampledReads,this.pairsCache=i.pairsCache}addAlignment(t){var e,i,r,n;this.alignments.length<this.samplingDepth?this.pairsSupported&&R(t)?(n=this.pairsCache[t.readName])?(n.setSecondAlignment(t),this.pairsCache[t.readName]=void 0):(n=new j(t),this.paired=!0,this.pairsCache[t.readName]=n,this.alignments.push(n)):this.alignments.push(t):(e=this.samplingDepth/(this.samplingDepth+this.downsampledCount+1),Math.random()<e?(i=Math.floor(Math.random()*(this.alignments.length-1)),r=this.alignments[i],this.pairsSupported&&R(t)?(void 0!==this.pairsCache[r.readName]&&(this.pairsCache[r.readName]=void 0),n=new j(t),this.paired=!0,this.pairsCache[t.readName]=n,this.alignments[i]=n):this.alignments[i]=t,this.downsampledReads.add(r.readName)):this.downsampledReads.add(t.readName),this.downsampledCount++)}}class W{constructor(t,e,i){this.chr=t,this.bpStart=e,this.length=i-e,this.coverage=new Array(this.length),this.maximum=0}incCounts(t){var e=this;function i(i){var r,n,s,a,o;for(s=i.start-e.bpStart,a=0;a<i.len;s++,a++)e.coverage[s]||(e.coverage[s]=new z),n=i.seq.charAt(a),r=t.strand?"pos"+n:"neg"+n,o=i.qual[a],e.coverage[s][r]+=1,e.coverage[s]["qual"+n]+=o,e.coverage[s].total+=1,e.coverage[s].qual+=o,e.maximum=Math.max(e.coverage[s].total,e.maximum)}void 0===t.blocks?i(t):t.blocks.forEach(function(t){i(t)})}}W.threshold=.2,W.qualityWeight=!0;class z{constructor(){this.posA=0,this.negA=0,this.posT=0,this.negT=0,this.posC=0,this.negC=0,this.posG=0,this.negG=0,this.posN=0,this.negN=0,this.pos=0,this.neg=0,this.qualA=0,this.qualT=0,this.qualC=0,this.qualG=0,this.qualN=0,this.qual=0,this.total=0}isMismatch(t){var e,i=this,r=W.threshold*(W.qualityWeight&&this.qual?this.qual:this.total);return e=0,["A","T","C","G"].forEach(function(r){r!==t&&(e+=W.qualityWeight&&i.qual?i["qual"+r]:i["pos"+r]+i["neg"+r])}),e>=r}}class V{constructor(t,e,i){this.start=t,this.end=e,this.counts=i}popupData(t){return[{name:"start",value:this.start+1},{name:"end",value:this.end},{name:"# downsampled:",value:this.counts}]}}class j{constructor(t){this.firstAlignment=t,this.chr=t.chr,this.readName=t.readName,t.start<t.mate.position?(this.start=t.start,this.end=Math.max(t.mate.position,t.start+t.lengthOnRef),this.connectingStart=t.start+t.lengthOnRef,this.connectingEnd=t.mate.position):(this.start=t.mate.position,this.end=t.start+t.lengthOnRef,this.connectingStart=t.mate.position,this.connectingEnd=t.start),this.lengthOnRef=this.end-this.start}setSecondAlignment(t){this.secondAlignment=t,t.start>this.firstAlignment.start?(this.end=t.start+t.lengthOnRef,this.connectingEnd=t.start):(this.start=t.start,this.connectingStart=t.start+t.lengthOnRef),this.lengthOnRef=this.end-this.start}popupData(t){var e=[];return e=e.concat(this.firstAlignment.popupData(t)),this.secondAlignment&&(e.push("-------------------------------"),e=e.concat(this.secondAlignment.popupData(t))),e}isPaired(){return!0}firstOfPairStrand(){return this.firstAlignment.isFirstOfPair()?this.firstAlignment.strand:this.secondAlignment?this.secondAlignment.strand:this.firstAlignment.strand}}class G{constructor(){this.alignments=[],this.score=void 0}findCenterAlignment(t,e){var i=void 0;return this.alignments.forEach(function(r){void 0===i&&(r.start+r.lengthOnRef<t||r.start>e||(i=r))}),i}updateScore(t,e,i){this.score=this.caculateScore(t,1+t,e,i)}caculateScore(t,e,i,r){var n,s;return void 0===(s=this.findCenterAlignment(t,e))?Number.MAX_VALUE:"NUCLEOTIDE"===r.sort?(n=void 0,s.blocks.forEach(function(e){var r,s,a,o,l,h=i.sequence,c=i.coverageMap;if("*"!==e.seq)for(var u=0,f=e.start-i.start,d=e.start,p=e.seq.length;u<p;u++,f++,d++)t===d&&(r=h.charAt(f),"="===(s=e.seq.charAt(u))&&(s=r),"N"===s?n=2:s===r?n=3:"X"===s||s!==r?(o=(a=c.coverage[d-c.bpStart])["pos"+s]+a["neg"+s],l=a.qual?a.qual:0,n=-(o+l/1e3)):console.log("BamAlignmentRow.caculateScore - huh?"));else n=3}),void 0===n?Number.MAX_VALUE:n):"STRAND"===r.sort?s.strand?1:-1:"START"===r.sort?s.start:Number.MAX_VALUE}}}).call(this,i(9))},function(t,e,i){"use strict";(function(t,r){i.d(e,"a",function(){return s});let n={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};class s{static addAlphaToRGB(t,e){return t.startsWith("rgb")?t.replace("rgb","rgba").replace(")",", "+e+")"):(console.log(t+" is not an rgb style string"),t)}static presentAlert(e,i){let r=t("<div>").css({position:"absolute","background-color":"white"}).attr("class","mlv-alert").appendTo(e);t("<div>").css({display:"flex","justify-content":"center"}).appendTo(r).append(t('<i class="fas fa-exclamation-circle"></i>').css({color:"red","font-size":"16px","text-align":"center"})),r.append(t("<div>"+i+"</div>").css({color:"red","font-size":"14px","text-align":"center"}));let n=Math.round(e.width()/2-r.width()/2),s=Math.round(e.height()/2-r.height()/2);r.css({left:n+"px",top:s+"px"})}static spinner(e){var i;return i=t('<i class="fa fa-lg fa-spinner fa-spin igv-spinner">').css({position:"absolute",top:"50%",left:"50%"}),e&&i.css("font-size",e),i[0]}static getSpinnerObjectWithParentElement(t){return t.find("div.igv-spinner-container")}static startSpinnerAtParentElement(t){t.children(".fa-spinner").show()}static stopSpinnerAtParentElement(t){t.children(".fa-spinner").hide()}static parseUri(t){for(var e=n,i=e.parser[e.strictMode?"strict":"loose"].exec(t),r={},s=14;s--;)r[e.key[s]]=i[s]||"";return r[e.q.name]={},r[e.key[12]].replace(e.q.parser,function(t,i,n){i&&(r[e.q.name][i]=n)}),r}static domElementRectAsString(t){return" x "+t.clientLeft+" y "+t.clientTop+" w "+t.clientWidth+" h "+t.clientHeight}static isNumber(t){return""!==t&&(void 0!==t&&(!isNaN(parseFloat(t))&&isFinite(t)))}static guid(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}static random(t,e){return Math.random()*(e-t)+t}static numberFormatter(t){var e=String(t).split(/[.,]/);return e[0].split("").reverse().reduce(function(t,e,i){return i%3==0?t+","+e:t+e}).split("").reverse().join("")+(e[1]?"."+e[1]:"")}static numberUnFormatter(t){return t.split(",").join().replace(",","","g")}static translateMouseCoordinates(e,i){var r=t.event.fix(e);return{x:r.pageX-t(i).offset().left,y:r.pageY-t(i).offset().top}}static formatPopoverText(t){var e='<table class="igv-popover-table">';return t.forEach(function(t){t.name?e+='<tr><td class="igv-popover-td"><div class="igv-popoverNameValue"><span class="igv-popoverName">'+t.name+'</span><span class="igv-popoverValue">'+t.value+"</span></div></td></tr>":e+="<tr><td>"+t.toString()+"</td></tr>"}),e+="</table>"}static throttle(t,e,i){var r,n;return e||(e=200),function(){var s=i||this,a=+new Date,o=arguments;r&&a<r+e?(clearTimeout(n),n=setTimeout(function(){r=a,t.apply(s,o)},e)):(r=a,t.apply(s,o))}}static splitStringRespectingQuotes(t,e){var i,r,n=[],s=t.length,a=0,o=!1;if(s>0)for(n[a]=t.charAt(0),i=1;i<s;i++)'"'===(r=t.charAt(i))?o=!o:o||r!==e?n[a]+=r:n[++a]="";return n}static addAjaxExtensions(){t.ajaxTransport("+binary",function(t,e,i){return{send:function(e,i){var n=new r,s=t.url,a=t.type;t.data;if(n.addEventListener("load",function(){var e={};e[t.dataType]=n.response,i(n.status,n.statusText,e,n.getAllResponseHeaders())}),n.open(a,s),n.responseType="arraybuffer",t.headers)for(var o in t.headers)t.headers.hasOwnProperty(o)&&n.setRequestHeader(o,t.headers[o])},abort:function(){i.abort()}}})}static isStringOrNumber(t){return!(!t.substring&&!t.toFixed)}static constrainBBox(t,e){var i,r,n={},s={};return s.left=s.top=0,s.right=e.outerWidth(),s.bottom=e.outerHeight(),r=t.offset(),n.left=r.left-e.offset().left,n.top=r.top-e.offset().top,n.right=n.left+t.outerWidth(),n.bottom=n.top+t.outerHeight(),(i=n.bottom-s.bottom)>0&&(r.top-=i,n.top-=i,n.bottom-=i,(i=n.top-s.top)<0&&(r.top-=i)),r}static log(t){igv.enableLogging&&console&&console.log&&console.log(t)}}}).call(this,i(4),i(12))},function(t,e){t.exports=require("canvas")},function(t,e){
/** @license zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */(function(){"use strict";function t(t){throw t}var e=void 0,i=!0,r=this;function n(t,i){var n,s=t.split("."),a=r;!(s[0]in a)&&a.execScript&&a.execScript("var "+s[0]);for(;s.length&&(n=s.shift());)s.length||i===e?a=a[n]?a[n]:a[n]={}:a[n]=i}var s="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array;function a(e,i){this.index="number"==typeof i?i:0,this.m=0,this.buffer=e instanceof(s?Uint8Array:Array)?e:new(s?Uint8Array:Array)(32768),2*this.buffer.length<=this.index&&t(Error("invalid index")),this.buffer.length<=this.index&&this.f()}a.prototype.f=function(){var t,e=this.buffer,i=e.length,r=new(s?Uint8Array:Array)(i<<1);if(s)r.set(e);else for(t=0;t<i;++t)r[t]=e[t];return this.buffer=r},a.prototype.d=function(t,e,i){var r,n=this.buffer,s=this.index,a=this.m,o=n[s];if(i&&1<e&&(t=8<e?(f[255&t]<<24|f[t>>>8&255]<<16|f[t>>>16&255]<<8|f[t>>>24&255])>>32-e:f[t]>>8-e),8>e+a)o=o<<e|t,a+=e;else for(r=0;r<e;++r)o=o<<1|t>>e-r-1&1,8==++a&&(a=0,n[s++]=f[o],o=0,s===n.length&&(n=this.f()));n[s]=o,this.buffer=n,this.m=a,this.index=s},a.prototype.finish=function(){var t,e=this.buffer,i=this.index;return 0<this.m&&(e[i]<<=8-this.m,e[i]=f[e[i]],i++),s?t=e.subarray(0,i):(e.length=i,t=e),t};var o,l=new(s?Uint8Array:Array)(256);for(o=0;256>o;++o){for(var h=u=o,c=7,u=u>>>1;u;u>>>=1)h<<=1,h|=1&u,--c;l[o]=(h<<c&255)>>>0}var f=l;function d(t,e,i){var r,n="number"==typeof e?e:e=0,s="number"==typeof i?i:t.length;for(r=-1,n=7&s;n--;++e)r=r>>>8^g[255&(r^t[e])];for(n=s>>3;n--;e+=8)r=(r=(r=(r=(r=(r=(r=(r=r>>>8^g[255&(r^t[e])])>>>8^g[255&(r^t[e+1])])>>>8^g[255&(r^t[e+2])])>>>8^g[255&(r^t[e+3])])>>>8^g[255&(r^t[e+4])])>>>8^g[255&(r^t[e+5])])>>>8^g[255&(r^t[e+6])])>>>8^g[255&(r^t[e+7])];return(4294967295^r)>>>0}var p=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],g=s?new Uint32Array(p):p;function m(){}function _(t){this.buffer=new(s?Uint16Array:Array)(2*t),this.length=0}function v(t){var e,i,r,n,a,o,l,h,c,u=t.length,f=0,d=Number.POSITIVE_INFINITY;for(h=0;h<u;++h)t[h]>f&&(f=t[h]),t[h]<d&&(d=t[h]);for(e=1<<f,i=new(s?Uint32Array:Array)(e),r=1,n=0,a=2;r<=f;){for(h=0;h<u;++h)if(t[h]===r){for(o=0,l=n,c=0;c<r;++c)o=o<<1|1&l,l>>=1;for(c=o;c<e;c+=a)i[c]=r<<16|h;++n}++r,n<<=1,a<<=1}return[i,f,d]}function b(t,e){this.k=x,this.I=0,this.input=s&&t instanceof Array?new Uint8Array(t):t,this.b=0,e&&(e.lazy&&(this.I=e.lazy),"number"==typeof e.compressionType&&(this.k=e.compressionType),e.outputBuffer&&(this.a=s&&e.outputBuffer instanceof Array?new Uint8Array(e.outputBuffer):e.outputBuffer),"number"==typeof e.outputIndex&&(this.b=e.outputIndex)),this.a||(this.a=new(s?Uint8Array:Array)(32768))}m.prototype.getName=function(){return this.name},m.prototype.getData=function(){return this.data},m.prototype.X=function(){return this.Y},n("Zlib.GunzipMember",m),n("Zlib.GunzipMember.prototype.getName",m.prototype.getName),n("Zlib.GunzipMember.prototype.getData",m.prototype.getData),n("Zlib.GunzipMember.prototype.getMtime",m.prototype.X),_.prototype.getParent=function(t){return 2*((t-2)/4|0)},_.prototype.push=function(t,e){var i,r,n,s=this.buffer;for(i=this.length,s[this.length++]=e,s[this.length++]=t;0<i&&(r=this.getParent(i),s[i]>s[r]);)n=s[i],s[i]=s[r],s[r]=n,n=s[i+1],s[i+1]=s[r+1],s[r+1]=n,i=r;return this.length},_.prototype.pop=function(){var t,e,i,r,n,s=this.buffer;for(e=s[0],t=s[1],this.length-=2,s[0]=s[this.length],s[1]=s[this.length+1],n=0;!((r=2*n+2)>=this.length)&&(r+2<this.length&&s[r+2]>s[r]&&(r+=2),s[r]>s[n]);)i=s[n],s[n]=s[r],s[r]=i,i=s[n+1],s[n+1]=s[r+1],s[r+1]=i,n=r;return{index:t,value:e,length:this.length}};var y,x=2,w={NONE:0,v:1,o:x,aa:3},k=[];for(y=0;288>y;y++)switch(i){case 143>=y:k.push([y+48,8]);break;case 255>=y:k.push([y-144+400,9]);break;case 279>=y:k.push([y-256+0,7]);break;case 287>=y:k.push([y-280+192,8]);break;default:t("invalid literal: "+y)}b.prototype.g=function(){var r,n,o,l,h=this.input;switch(this.k){case 0:for(o=0,l=h.length;o<l;){var c,u,f,d=n=s?h.subarray(o,o+65535):h.slice(o,o+65535),p=(o+=n.length)===l,g=e,m=e,_=this.a,v=this.b;if(s){for(_=new Uint8Array(this.a.buffer);_.length<=v+d.length+5;)_=new Uint8Array(_.length<<1);_.set(this.a)}if(c=p?1:0,_[v++]=0|c,f=65536+~(u=d.length)&65535,_[v++]=255&u,_[v++]=u>>>8&255,_[v++]=255&f,_[v++]=f>>>8&255,s)_.set(d,v),v+=d.length,_=_.subarray(0,v);else{for(g=0,m=d.length;g<m;++g)_[v++]=d[g];_.length=v}this.b=v,this.a=_}break;case 1:var b=new a(s?new Uint8Array(this.a.buffer):this.a,this.b);b.d(1,1,i),b.d(1,2,i);var y,w,S,A=T(this,h);for(y=0,w=A.length;y<w;y++)if(S=A[y],a.prototype.d.apply(b,k[S]),256<S)b.d(A[++y],A[++y],i),b.d(A[++y],5),b.d(A[++y],A[++y],i);else if(256===S)break;this.a=b.finish(),this.b=this.a.length;break;case x:var P,I,F,M,R,U,D,L,q,H,O,N,B,W,z,V=new a(s?new Uint8Array(this.a.buffer):this.a,this.b),j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=Array(19);for(P=x,V.d(1,1,i),V.d(P,2,i),I=T(this,h),D=E(U=C(this.V,15)),q=E(L=C(this.U,7)),F=286;257<F&&0===U[F-1];F--);for(M=30;1<M&&0===L[M-1];M--);var Z,X,Q,Y,J,$,K=F,tt=M,et=new(s?Uint32Array:Array)(K+tt),it=new(s?Uint32Array:Array)(316),rt=new(s?Uint8Array:Array)(19);for(Z=X=0;Z<K;Z++)et[X++]=U[Z];for(Z=0;Z<tt;Z++)et[X++]=L[Z];if(!s)for(Z=0,Y=rt.length;Z<Y;++Z)rt[Z]=0;for(Z=J=0,Y=et.length;Z<Y;Z+=X){for(X=1;Z+X<Y&&et[Z+X]===et[Z];++X);if(Q=X,0===et[Z])if(3>Q)for(;0<Q--;)it[J++]=0,rt[0]++;else for(;0<Q;)($=138>Q?Q:138)>Q-3&&$<Q&&($=Q-3),10>=$?(it[J++]=17,it[J++]=$-3,rt[17]++):(it[J++]=18,it[J++]=$-11,rt[18]++),Q-=$;else if(it[J++]=et[Z],rt[et[Z]]++,3>--Q)for(;0<Q--;)it[J++]=et[Z],rt[et[Z]]++;else for(;0<Q;)($=6>Q?Q:6)>Q-3&&$<Q&&($=Q-3),it[J++]=16,it[J++]=$-3,rt[16]++,Q-=$}for(r=s?it.subarray(0,J):it.slice(0,J),H=C(rt,7),W=0;19>W;W++)G[W]=H[j[W]];for(R=19;4<R&&0===G[R-1];R--);for(O=E(H),V.d(F-257,5,i),V.d(M-1,5,i),V.d(R-4,4,i),W=0;W<R;W++)V.d(G[W],3,i);for(W=0,z=r.length;W<z;W++)if(N=r[W],V.d(O[N],H[N],i),16<=N){switch(W++,N){case 16:B=2;break;case 17:B=3;break;case 18:B=7;break;default:t("invalid code: "+N)}V.d(r[W],B,i)}var nt,st,at,ot,lt,ht,ct,ut,ft=[D,U],dt=[q,L];for(lt=ft[0],ht=ft[1],ct=dt[0],ut=dt[1],nt=0,st=I.length;nt<st;++nt)if(at=I[nt],V.d(lt[at],ht[at],i),256<at)V.d(I[++nt],I[++nt],i),ot=I[++nt],V.d(ct[ot],ut[ot],i),V.d(I[++nt],I[++nt],i);else if(256===at)break;this.a=V.finish(),this.b=this.a.length;break;default:t("invalid compression type")}return this.a};var S=function(){function e(e){switch(i){case 3===e:return[257,e-3,0];case 4===e:return[258,e-4,0];case 5===e:return[259,e-5,0];case 6===e:return[260,e-6,0];case 7===e:return[261,e-7,0];case 8===e:return[262,e-8,0];case 9===e:return[263,e-9,0];case 10===e:return[264,e-10,0];case 12>=e:return[265,e-11,1];case 14>=e:return[266,e-13,1];case 16>=e:return[267,e-15,1];case 18>=e:return[268,e-17,1];case 22>=e:return[269,e-19,2];case 26>=e:return[270,e-23,2];case 30>=e:return[271,e-27,2];case 34>=e:return[272,e-31,2];case 42>=e:return[273,e-35,3];case 50>=e:return[274,e-43,3];case 58>=e:return[275,e-51,3];case 66>=e:return[276,e-59,3];case 82>=e:return[277,e-67,4];case 98>=e:return[278,e-83,4];case 114>=e:return[279,e-99,4];case 130>=e:return[280,e-115,4];case 162>=e:return[281,e-131,5];case 194>=e:return[282,e-163,5];case 226>=e:return[283,e-195,5];case 257>=e:return[284,e-227,5];case 258===e:return[285,e-258,0];default:t("invalid length: "+e)}}var r,n,s=[];for(r=3;258>=r;r++)n=e(r),s[r]=n[2]<<24|n[1]<<16|n[0];return s}(),A=s?new Uint32Array(S):S;function T(r,n){function a(e,r){var n,s,a,o,l=e.P,h=[],c=0;switch(n=A[e.length],h[c++]=65535&n,h[c++]=n>>16&255,h[c++]=n>>24,i){case 1===l:s=[0,l-1,0];break;case 2===l:s=[1,l-2,0];break;case 3===l:s=[2,l-3,0];break;case 4===l:s=[3,l-4,0];break;case 6>=l:s=[4,l-5,1];break;case 8>=l:s=[5,l-7,1];break;case 12>=l:s=[6,l-9,2];break;case 16>=l:s=[7,l-13,2];break;case 24>=l:s=[8,l-17,3];break;case 32>=l:s=[9,l-25,3];break;case 48>=l:s=[10,l-33,4];break;case 64>=l:s=[11,l-49,4];break;case 96>=l:s=[12,l-65,5];break;case 128>=l:s=[13,l-97,5];break;case 192>=l:s=[14,l-129,6];break;case 256>=l:s=[15,l-193,6];break;case 384>=l:s=[16,l-257,7];break;case 512>=l:s=[17,l-385,7];break;case 768>=l:s=[18,l-513,8];break;case 1024>=l:s=[19,l-769,8];break;case 1536>=l:s=[20,l-1025,9];break;case 2048>=l:s=[21,l-1537,9];break;case 3072>=l:s=[22,l-2049,10];break;case 4096>=l:s=[23,l-3073,10];break;case 6144>=l:s=[24,l-4097,11];break;case 8192>=l:s=[25,l-6145,11];break;case 12288>=l:s=[26,l-8193,12];break;case 16384>=l:s=[27,l-12289,12];break;case 24576>=l:s=[28,l-16385,13];break;case 32768>=l:s=[29,l-24577,13];break;default:t("invalid distance")}for(n=s,h[c++]=n[0],h[c++]=n[1],h[c++]=n[2],a=0,o=h.length;a<o;++a)_[v++]=h[a];y[h[0]]++,x[h[3]]++,b=e.length+r-1,p=null}var o,l,h,c,u,f,d,p,g,m={},_=s?new Uint16Array(2*n.length):[],v=0,b=0,y=new(s?Uint32Array:Array)(286),x=new(s?Uint32Array:Array)(30),w=r.I;if(!s){for(h=0;285>=h;)y[h++]=0;for(h=0;29>=h;)x[h++]=0}for(y[256]=1,o=0,l=n.length;o<l;++o){for(h=u=0,c=3;h<c&&o+h!==l;++h)u=u<<8|n[o+h];if(m[u]===e&&(m[u]=[]),f=m[u],!(0<b--)){for(;0<f.length&&32768<o-f[0];)f.shift();if(o+3>=l){for(p&&a(p,-1),h=0,c=l-o;h<c;++h)g=n[o+h],_[v++]=g,++y[g];break}0<f.length?(d=P(n,o,f),p?p.length<d.length?(g=n[o-1],_[v++]=g,++y[g],a(d,0)):a(p,-1):d.length<w?p=d:a(d,0)):p?a(p,-1):(g=n[o],_[v++]=g,++y[g])}f.push(o)}return _[v++]=256,y[256]++,r.V=y,r.U=x,s?_.subarray(0,v):_}function P(t,e,i){var r,n,s,a,o,l,h=0,c=t.length;a=0,l=i.length;t:for(;a<l;a++){if(r=i[l-a-1],s=3,3<h){for(o=h;3<o;o--)if(t[r+o-1]!==t[e+o-1])continue t;s=h}for(;258>s&&e+s<c&&t[r+s]===t[e+s];)++s;if(s>h&&(n=r,h=s),258===s)break}return new function(t,e){this.length=t,this.P=e}(h,e-n)}function C(t,e){var i,r,n,a,o,l=t.length,h=new _(572),c=new(s?Uint8Array:Array)(l);if(!s)for(a=0;a<l;a++)c[a]=0;for(a=0;a<l;++a)0<t[a]&&h.push(a,t[a]);if(i=Array(h.length/2),r=new(s?Uint32Array:Array)(h.length/2),1===i.length)return c[h.pop().index]=1,c;for(a=0,o=h.length/2;a<o;++a)i[a]=h.pop(),r[a]=i[a].value;for(n=function(t,e,i){function r(t){var i=p[t][g[t]];i===e?(r(t+1),r(t+1)):--f[i],++g[t]}var n,a,o,l,h,c=new(s?Uint16Array:Array)(i),u=new(s?Uint8Array:Array)(i),f=new(s?Uint8Array:Array)(e),d=Array(i),p=Array(i),g=Array(i),m=(1<<i)-e,_=1<<i-1;for(c[i-1]=e,a=0;a<i;++a)m<_?u[a]=0:(u[a]=1,m-=_),m<<=1,c[i-2-a]=(c[i-1-a]/2|0)+e;for(c[0]=u[0],d[0]=Array(c[0]),p[0]=Array(c[0]),a=1;a<i;++a)c[a]>2*c[a-1]+u[a]&&(c[a]=2*c[a-1]+u[a]),d[a]=Array(c[a]),p[a]=Array(c[a]);for(n=0;n<e;++n)f[n]=i;for(o=0;o<c[i-1];++o)d[i-1][o]=t[o],p[i-1][o]=o;for(n=0;n<i;++n)g[n]=0;for(1===u[i-1]&&(--f[0],++g[i-1]),a=i-2;0<=a;--a){for(l=n=0,h=g[a+1],o=0;o<c[a];o++)(l=d[a+1][h]+d[a+1][h+1])>t[n]?(d[a][o]=l,p[a][o]=e,h+=2):(d[a][o]=t[n],p[a][o]=n,++n);g[a]=0,1===u[a]&&r(a)}return f}(r,r.length,e),a=0,o=i.length;a<o;++a)c[i[a].index]=n[a];return c}function E(t){var e,i,r,n,a=new(s?Uint16Array:Array)(t.length),o=[],l=[],h=0;for(e=0,i=t.length;e<i;e++)o[t[e]]=1+(0|o[t[e]]);for(e=1,i=16;e<=i;e++)l[e]=h,h+=0|o[e],h<<=1;for(e=0,i=t.length;e<i;e++)for(h=l[t[e]],l[t[e]]+=1,r=a[e]=0,n=t[e];r<n;r++)a[e]=a[e]<<1|1&h,h>>>=1;return a}function I(t,e){this.input=t,this.b=this.c=0,this.i={},e&&(e.flags&&(this.i=e.flags),"string"==typeof e.filename&&(this.filename=e.filename),"string"==typeof e.comment&&(this.A=e.comment),e.deflateOptions&&(this.l=e.deflateOptions)),this.l||(this.l={})}I.prototype.g=function(){var t,i,r,n,a,o,l,h,c=new(s?Uint8Array:Array)(32768),u=0,f=this.input,p=this.c,g=this.filename,m=this.A;if(c[u++]=31,c[u++]=139,c[u++]=8,t=0,this.i.fname&&(t|=R),this.i.fcomment&&(t|=U),this.i.fhcrc&&(t|=M),c[u++]=t,i=(Date.now?Date.now():+new Date)/1e3|0,c[u++]=255&i,c[u++]=i>>>8&255,c[u++]=i>>>16&255,c[u++]=i>>>24&255,c[u++]=0,c[u++]=F,this.i.fname!==e){for(l=0,h=g.length;l<h;++l)255<(o=g.charCodeAt(l))&&(c[u++]=o>>>8&255),c[u++]=255&o;c[u++]=0}if(this.i.comment){for(l=0,h=m.length;l<h;++l)255<(o=m.charCodeAt(l))&&(c[u++]=o>>>8&255),c[u++]=255&o;c[u++]=0}return this.i.fhcrc&&(r=65535&d(c,0,u),c[u++]=255&r,c[u++]=r>>>8&255),this.l.outputBuffer=c,this.l.outputIndex=u,c=(a=new b(f,this.l)).g(),u=a.b,s&&(u+8>c.buffer.byteLength?(this.a=new Uint8Array(u+8),this.a.set(new Uint8Array(c.buffer)),c=this.a):c=new Uint8Array(c.buffer)),n=d(f,e,e),c[u++]=255&n,c[u++]=n>>>8&255,c[u++]=n>>>16&255,c[u++]=n>>>24&255,h=f.length,c[u++]=255&h,c[u++]=h>>>8&255,c[u++]=h>>>16&255,c[u++]=h>>>24&255,this.c=p,s&&u<c.length&&(this.a=c=c.subarray(0,u)),c};var F=255,M=2,R=8,U=16;function D(e,i){switch(this.p=[],this.q=32768,this.e=this.j=this.c=this.u=0,this.input=s?new Uint8Array(e):e,this.w=!1,this.r=q,this.L=!1,!i&&(i={})||(i.index&&(this.c=i.index),i.bufferSize&&(this.q=i.bufferSize),i.bufferType&&(this.r=i.bufferType),i.resize&&(this.L=i.resize)),this.r){case L:this.b=32768,this.a=new(s?Uint8Array:Array)(32768+this.q+258);break;case q:this.b=0,this.a=new(s?Uint8Array:Array)(this.q),this.f=this.T,this.B=this.Q,this.s=this.S;break;default:t(Error("invalid inflate mode"))}}n("Zlib.Gzip",I),n("Zlib.Gzip.prototype.compress",I.prototype.g);var L=0,q=1,H={N:L,M:q};D.prototype.h=function(){for(;!this.w;){var r=rt(this,3);switch(1&r&&(this.w=i),r>>>=1){case 0:var n=this.input,a=this.c,o=this.a,l=this.b,h=e,c=e,u=e,f=o.length,d=e;switch(this.e=this.j=0,(h=n[a++])===e&&t(Error("invalid uncompressed block header: LEN (first byte)")),c=h,(h=n[a++])===e&&t(Error("invalid uncompressed block header: LEN (second byte)")),c|=h<<8,(h=n[a++])===e&&t(Error("invalid uncompressed block header: NLEN (first byte)")),u=h,(h=n[a++])===e&&t(Error("invalid uncompressed block header: NLEN (second byte)")),c===~(u|=h<<8)&&t(Error("invalid uncompressed block header: length verify")),a+c>n.length&&t(Error("input buffer is broken")),this.r){case L:for(;l+c>o.length;){if(c-=d=f-l,s)o.set(n.subarray(a,a+d),l),l+=d,a+=d;else for(;d--;)o[l++]=n[a++];this.b=l,o=this.f(),l=this.b}break;case q:for(;l+c>o.length;)o=this.f({F:2});break;default:t(Error("invalid inflate mode"))}if(s)o.set(n.subarray(a,a+c),l),l+=c,a+=c;else for(;c--;)o[l++]=n[a++];this.c=a,this.b=l,this.a=o;break;case 1:this.s(tt,it);break;case 2:st(this);break;default:t(Error("unknown BTYPE: "+r))}}return this.B()};var O,N,B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=s?new Uint16Array(B):B,z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],V=s?new Uint16Array(z):z,j=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],G=s?new Uint8Array(j):j,Z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],X=s?new Uint16Array(Z):Z,Q=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Y=s?new Uint8Array(Q):Q,J=new(s?Uint8Array:Array)(288);for(O=0,N=J.length;O<N;++O)J[O]=143>=O?8:255>=O?9:279>=O?7:8;var $,K,tt=v(J),et=new(s?Uint8Array:Array)(30);for($=0,K=et.length;$<K;++$)et[$]=5;var it=v(et);function rt(i,r){for(var n,s=i.j,a=i.e,o=i.input,l=i.c;a<r;)(n=o[l++])===e&&t(Error("input buffer is broken")),s|=n<<a,a+=8;return n=s&(1<<r)-1,i.j=s>>>r,i.e=a-r,i.c=l,n}function nt(t,i){for(var r,n,s,a=t.j,o=t.e,l=t.input,h=t.c,c=i[0],u=i[1];o<u&&(r=l[h++])!==e;)a|=r<<o,o+=8;return s=(n=c[a&(1<<u)-1])>>>16,t.j=a>>s,t.e=o-s,t.c=h,65535&n}function st(t){function e(t,e,i){var r,n,s,a;for(a=0;a<t;)switch(r=nt(this,e),r){case 16:for(s=3+rt(this,2);s--;)i[a++]=n;break;case 17:for(s=3+rt(this,3);s--;)i[a++]=0;n=0;break;case 18:for(s=11+rt(this,7);s--;)i[a++]=0;n=0;break;default:n=i[a++]=r}return i}var i,r,n,a,o=rt(t,5)+257,l=rt(t,5)+1,h=rt(t,4)+4,c=new(s?Uint8Array:Array)(W.length);for(a=0;a<h;++a)c[W[a]]=rt(t,3);i=v(c),r=new(s?Uint8Array:Array)(o),n=new(s?Uint8Array:Array)(l),t.s(v(e.call(t,o,i,r)),v(e.call(t,l,i,n)))}function at(t){this.input=t,this.c=0,this.t=[],this.D=!1}function ot(t){if("string"==typeof t){var e,i,r=t.split("");for(e=0,i=r.length;e<i;e++)r[e]=(255&r[e].charCodeAt(0))>>>0;t=r}for(var n,s=1,a=0,o=t.length,l=0;0<o;){o-=n=1024<o?1024:o;do{a+=s+=t[l++]}while(--n);s%=65521,a%=65521}return(a<<16|s)>>>0}function lt(e,i){var r,n;switch(this.input=e,this.c=0,!i&&(i={})||(i.index&&(this.c=i.index),i.verify&&(this.Z=i.verify)),r=e[this.c++],n=e[this.c++],15&r){case ht:this.method=ht;break;default:t(Error("unsupported compression method"))}0!=((r<<8)+n)%31&&t(Error("invalid fcheck flag:"+((r<<8)+n)%31)),32&n&&t(Error("fdict flag is not supported")),this.K=new D(e,{index:this.c,bufferSize:i.bufferSize,bufferType:i.bufferType,resize:i.resize})}D.prototype.s=function(t,e){var i=this.a,r=this.b;this.C=t;for(var n,s,a,o,l=i.length-258;256!==(n=nt(this,t));)if(256>n)r>=l&&(this.b=r,i=this.f(),r=this.b),i[r++]=n;else for(o=V[s=n-257],0<G[s]&&(o+=rt(this,G[s])),n=nt(this,e),a=X[n],0<Y[n]&&(a+=rt(this,Y[n])),r>=l&&(this.b=r,i=this.f(),r=this.b);o--;)i[r]=i[r++-a];for(;8<=this.e;)this.e-=8,this.c--;this.b=r},D.prototype.S=function(t,e){var i=this.a,r=this.b;this.C=t;for(var n,s,a,o,l=i.length;256!==(n=nt(this,t));)if(256>n)r>=l&&(l=(i=this.f()).length),i[r++]=n;else for(o=V[s=n-257],0<G[s]&&(o+=rt(this,G[s])),n=nt(this,e),a=X[n],0<Y[n]&&(a+=rt(this,Y[n])),r+o>l&&(l=(i=this.f()).length);o--;)i[r]=i[r++-a];for(;8<=this.e;)this.e-=8,this.c--;this.b=r},D.prototype.f=function(){var t,e,i=new(s?Uint8Array:Array)(this.b-32768),r=this.b-32768,n=this.a;if(s)i.set(n.subarray(32768,i.length));else for(t=0,e=i.length;t<e;++t)i[t]=n[t+32768];if(this.p.push(i),this.u+=i.length,s)n.set(n.subarray(r,r+32768));else for(t=0;32768>t;++t)n[t]=n[r+t];return this.b=32768,n},D.prototype.T=function(t){var e,i,r,n=this.input.length/this.c+1|0,a=this.input,o=this.a;return t&&("number"==typeof t.F&&(n=t.F),"number"==typeof t.O&&(n+=t.O)),2>n?i=(r=(a.length-this.c)/this.C[2]/2*258|0)<o.length?o.length+r:o.length<<1:i=o.length*n,s?(e=new Uint8Array(i)).set(o):e=o,this.a=e},D.prototype.B=function(){var t,e,i,r,n,a=0,o=this.a,l=this.p,h=new(s?Uint8Array:Array)(this.u+(this.b-32768));if(0===l.length)return s?this.a.subarray(32768,this.b):this.a.slice(32768,this.b);for(e=0,i=l.length;e<i;++e)for(r=0,n=(t=l[e]).length;r<n;++r)h[a++]=t[r];for(e=32768,i=this.b;e<i;++e)h[a++]=o[e];return this.p=[],this.buffer=h},D.prototype.Q=function(){var t,e=this.b;return s?this.L?(t=new Uint8Array(e)).set(this.a.subarray(0,e)):t=this.a.subarray(0,e):(this.a.length>e&&(this.a.length=e),t=this.a),this.buffer=t},at.prototype.W=function(){return this.D||this.h(),this.t.slice()},at.prototype.h=function(){for(var r=this.input.length;this.c<r;){var n,a,o=new m,l=e,h=e,c=e,u=e,f=e,p=e,g=e,_=this.input,v=this.c;switch(o.G=_[v++],o.H=_[v++],(31!==o.G||139!==o.H)&&t(Error("invalid file signature:"+o.G+","+o.H)),o.z=_[v++],o.z){case 8:break;default:t(Error("unknown compression method: "+o.z))}if(o.n=_[v++],a=_[v++]|_[v++]<<8|_[v++]<<16|_[v++]<<24,o.Y=new Date(1e3*a),o.ea=_[v++],o.da=_[v++],0<(4&o.n)&&(o.$=_[v++]|_[v++]<<8,v+=o.$),0<(o.n&R)){for(p=[],f=0;0<(u=_[v++]);)p[f++]=String.fromCharCode(u);o.name=p.join("")}if(0<(o.n&U)){for(p=[],f=0;0<(u=_[v++]);)p[f++]=String.fromCharCode(u);o.A=p.join("")}0<(o.n&M)&&(o.R=65535&d(_,0,v),o.R!==(_[v++]|_[v++]<<8)&&t(Error("invalid header crc16"))),l=_[_.length-4]|_[_.length-3]<<8|_[_.length-2]<<16|_[_.length-1]<<24,_.length-v-4-4<512*l&&(c=l),h=new D(_,{index:v,bufferSize:c}),o.data=n=h.h(),v=h.c,o.ba=g=(_[v++]|_[v++]<<8|_[v++]<<16|_[v++]<<24)>>>0,d(n,e,e)!==g&&t(Error("invalid CRC-32 checksum: 0x"+d(n,e,e).toString(16)+" / 0x"+g.toString(16))),o.ca=l=(_[v++]|_[v++]<<8|_[v++]<<16|_[v++]<<24)>>>0,(4294967295&n.length)!==l&&t(Error("invalid input size: "+(4294967295&n.length)+" / "+l)),this.t.push(o),this.c=v}this.D=i;var b,y,x,w=this.t,k=0,S=0;for(b=0,y=w.length;b<y;++b)S+=w[b].data.length;if(s)for(x=new Uint8Array(S),b=0;b<y;++b)x.set(w[b].data,k),k+=w[b].data.length;else{for(x=[],b=0;b<y;++b)x[b]=w[b].data;x=Array.prototype.concat.apply([],x)}return x},n("Zlib.Gunzip",at),n("Zlib.Gunzip.prototype.decompress",at.prototype.h),n("Zlib.Gunzip.prototype.getMembers",at.prototype.W),lt.prototype.h=function(){var e,i=this.input;return e=this.K.h(),this.c=this.K.c,this.Z&&((i[this.c++]<<24|i[this.c++]<<16|i[this.c++]<<8|i[this.c++])>>>0!==ot(e)&&t(Error("invalid adler-32 checksum"))),e};var ht=8;function ct(t,e){this.input=t,this.a=new(s?Uint8Array:Array)(32768),this.k=ut.o;var i,r={};for(i in!e&&(e={})||"number"!=typeof e.compressionType||(this.k=e.compressionType),e)r[i]=e[i];r.outputBuffer=this.a,this.J=new b(this.input,r)}var ut=w;function ft(t,e){var i,r,s,a;if(Object.keys)i=Object.keys(e);else for(r in i=[],s=0,e)i[s++]=r;for(s=0,a=i.length;s<a;++s)n(t+"."+(r=i[s]),e[r])}ct.prototype.g=function(){var e,i,r,n,a,o,l,h=0;switch(l=this.a,e=ht){case ht:i=Math.LOG2E*Math.log(32768)-8;break;default:t(Error("invalid compression method"))}switch(r=i<<4|e,l[h++]=r,e){case ht:switch(this.k){case ut.NONE:a=0;break;case ut.v:a=1;break;case ut.o:a=2;break;default:t(Error("unsupported compression type"))}break;default:t(Error("invalid compression method"))}return n=a<<6|0,l[h++]=n|31-(256*r+n)%31,o=ot(this.input),this.J.b=h,h=(l=this.J.g()).length,s&&((l=new Uint8Array(l.buffer)).length<=h+4&&(this.a=new Uint8Array(l.length+4),this.a.set(l),l=this.a),l=l.subarray(0,h+4)),l[h++]=o>>24&255,l[h++]=o>>16&255,l[h++]=o>>8&255,l[h++]=255&o,l},n("Zlib.Inflate",lt),n("Zlib.Inflate.prototype.decompress",lt.prototype.h),ft("Zlib.Inflate.BufferType",{ADAPTIVE:H.M,BLOCK:H.N}),n("Zlib.Deflate",ct),n("Zlib.Deflate.compress",function(t,e){return new ct(t,e).g()}),n("Zlib.Deflate.prototype.compress",ct.prototype.g),ft("Zlib.Deflate.CompressionType",{NONE:ut.NONE,FIXED:ut.v,DYNAMIC:ut.o})}).call(this)},function(t,e){t.exports=require("fs")},function(t,e){t.exports=require("extend")},function(t,e,i){(function(){var e,r,n,s,a,o,l,h,c,u,f,d,p=function(t,e){for(var i in e)g.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},g={}.hasOwnProperty;l=function(){function t(){this.onloadstart=null,this.onprogress=null,this.onabort=null,this.onerror=null,this.onload=null,this.ontimeout=null,this.onloadend=null,this._listeners={}}return t.prototype.onloadstart=null,t.prototype.onprogress=null,t.prototype.onabort=null,t.prototype.onerror=null,t.prototype.onload=null,t.prototype.ontimeout=null,t.prototype.onloadend=null,t.prototype.addEventListener=function(t,e){var i;t=t.toLowerCase(),(i=this._listeners)[t]||(i[t]=[]),this._listeners[t].push(e)},t.prototype.removeEventListener=function(t,e){var i;t=t.toLowerCase(),this._listeners[t]&&-1!==(i=this._listeners[t].indexOf(e))&&this._listeners[t].splice(i,1)},t.prototype.dispatchEvent=function(t){var e,i,r,n,s;if(t.currentTarget=t.target=this,e=t.type,s=this._listeners[e])for(i=0,r=s.length;i<r;i++)(n=s[i]).call(this,t);(n=this["on"+e])&&n.call(this,t)},t}(),c=i(24),u=i(23),f=i(22),d=i(21),o=function(t){function i(t){i.__super__.constructor.call(this),this.onreadystatechange=null,this._anonymous=t&&t.anon,this.readyState=i.UNSENT,this.response=null,this.responseText="",this.responseType="",this.responseURL="",this.status=0,this.statusText="",this.timeout=0,this.upload=new h(this),this._method=null,this._url=null,this._sync=!1,this._headers=null,this._loweredHeaders=null,this._mimeOverride=null,this._request=null,this._response=null,this._responseParts=null,this._responseHeaders=null,this._aborting=null,this._error=null,this._loadedBytes=0,this._totalBytes=0,this._lengthComputable=!1}return p(i,l),i.prototype.onreadystatechange=null,i.prototype.readyState=null,i.prototype.response=null,i.prototype.responseText=null,i.prototype.responseType=null,i.prototype.status=null,i.prototype.timeout=null,i.prototype.upload=null,i.prototype.open=function(t,e,r,n,a){var o;if((t=t.toUpperCase())in this._restrictedMethods)throw new s("HTTP method "+t+" is not allowed in XHR");switch(o=this._parseUrl(e),void 0===r&&(r=!0),this.readyState){case i.UNSENT:case i.OPENED:case i.DONE:break;case i.HEADERS_RECEIVED:case i.LOADING:}this._method=t,this._url=o,this._sync=!r,this._headers={},this._loweredHeaders={},this._mimeOverride=null,this._setReadyState(i.OPENED),this._request=null,this._response=null,this.status=0,this.statusText="",this._responseParts=[],this._responseHeaders=null,this._loadedBytes=0,this._totalBytes=0,this._lengthComputable=!1},i.prototype.setRequestHeader=function(t,r){var n;if(this.readyState!==i.OPENED)throw new e("XHR readyState must be OPENED");n=t.toLowerCase(),this._restrictedHeaders[n]||/^sec\-/.test(n)||/^proxy-/.test(n)?console.warn('Refused to set unsafe header "'+t+'"'):(r=r.toString(),n in this._loweredHeaders?(t=this._loweredHeaders[n],this._headers[t]=this._headers[t]+", "+r):(this._loweredHeaders[n]=t,this._headers[t]=r))},i.prototype.send=function(t){if(this.readyState!==i.OPENED)throw new e("XHR readyState must be OPENED");if(this._request)throw new e("send() already called");switch(this._url.protocol){case"file:":this._sendFile(t);break;case"http:":case"https:":this._sendHttp(t);break;default:throw new r("Unsupported protocol "+this._url.protocol)}},i.prototype.abort=function(){this._request&&(this._request.abort(),this._setError(),this._dispatchProgress("abort"),this._dispatchProgress("loadend"))},i.prototype.getResponseHeader=function(t){var e;return this._responseHeaders&&(e=t.toLowerCase())in this._responseHeaders?this._responseHeaders[e]:null},i.prototype.getAllResponseHeaders=function(){var t,e;return this._responseHeaders?function(){var i,r;for(t in r=[],i=this._responseHeaders)e=i[t],r.push(t+": "+e);return r}.call(this).join("\r\n"):""},i.prototype.overrideMimeType=function(t){if(this.readyState===i.LOADING||this.readyState===i.DONE)throw new e("overrideMimeType() not allowed in LOADING or DONE");this._mimeOverride=t.toLowerCase()},i.prototype.nodejsSet=function(t){var e;if("httpAgent"in t&&(this.nodejsHttpAgent=t.httpAgent),"httpsAgent"in t&&(this.nodejsHttpsAgent=t.httpsAgent),"baseUrl"in t){if(null!==(e=t.baseUrl)&&!d.parse(e,!1,!0).protocol)throw new a("baseUrl must be an absolute URL");this.nodejsBaseUrl=e}},i.nodejsSet=function(t){i.prototype.nodejsSet(t)},i.prototype.UNSENT=0,i.UNSENT=0,i.prototype.OPENED=1,i.OPENED=1,i.prototype.HEADERS_RECEIVED=2,i.HEADERS_RECEIVED=2,i.prototype.LOADING=3,i.LOADING=3,i.prototype.DONE=4,i.DONE=4,i.prototype.nodejsHttpAgent=c.globalAgent,i.prototype.nodejsHttpsAgent=u.globalAgent,i.prototype.nodejsBaseUrl=null,i.prototype._restrictedMethods={CONNECT:!0,TRACE:!0,TRACK:!0},i.prototype._restrictedHeaders={"accept-charset":!0,"accept-encoding":!0,"access-control-request-headers":!0,"access-control-request-method":!0,connection:!0,"content-length":!0,cookie:!0,cookie2:!0,date:!0,dnt:!0,expect:!0,host:!0,"keep-alive":!0,origin:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,via:!0},i.prototype._privateHeaders={"set-cookie":!0,"set-cookie2":!0},i.prototype._userAgent="Mozilla/5.0 ("+f.type()+" "+f.arch()+") node.js/"+process.versions.node+" v8/"+process.versions.v8,i.prototype._setReadyState=function(t){var e;this.readyState=t,e=new n("readystatechange"),this.dispatchEvent(e)},i.prototype._sendFile=function(){if("GET"!==this._url.method)throw new r("The file protocol only supports GET");throw new Error("Protocol file: not implemented")},i.prototype._sendHttp=function(t){if(this._sync)throw new Error("Synchronous XHR processing not implemented");null==t||"GET"!==this._method&&"HEAD"!==this._method?t||(t=""):(console.warn("Discarding entity body for "+this._method+" requests"),t=null),this.upload._setData(t),this._finalizeHeaders(),this._sendHxxpRequest()},i.prototype._sendHxxpRequest=function(){var t,e,i,r;"http:"===this._url.protocol?(e=c,t=this.nodejsHttpAgent):(e=u,t=this.nodejsHttpsAgent),i=e.request({hostname:this._url.hostname,port:this._url.port,path:this._url.path,auth:this._url.auth,method:this._method,headers:this._headers,agent:t}),this._request=i,this.timeout&&i.setTimeout(this.timeout,(r=this,function(){return r._onHttpTimeout(i)})),i.on("response",function(t){return function(e){return t._onHttpResponse(i,e)}}(this)),i.on("error",function(t){return function(e){return t._onHttpRequestError(i,e)}}(this)),this.upload._startUpload(i),this._request===i&&this._dispatchProgress("loadstart")},i.prototype._finalizeHeaders=function(){this._headers.Connection="keep-alive",this._headers.Host=this._url.host,this._anonymous&&(this._headers.Referer="about:blank"),this._headers["User-Agent"]=this._userAgent,this.upload._finalizeHeaders(this._headers,this._loweredHeaders)},i.prototype._onHttpResponse=function(t,e){var r;if(this._request===t){switch(e.statusCode){case 301:case 302:case 303:case 307:case 308:return this._url=this._parseUrl(e.headers.location),this._method="GET","content-type"in this._loweredHeaders&&(delete this._headers[this._loweredHeaders["content-type"]],delete this._loweredHeaders["content-type"]),"Content-Type"in this._headers&&delete this._headers["Content-Type"],delete this._headers["Content-Length"],this.upload._reset(),this._finalizeHeaders(),void this._sendHxxpRequest()}var n;return this._response=e,this._response.on("data",(n=this,function(t){return n._onHttpResponseData(e,t)})),this._response.on("end",function(t){return function(){return t._onHttpResponseEnd(e)}}(this)),this._response.on("close",function(t){return function(){return t._onHttpResponseClose(e)}}(this)),this.responseURL=this._url.href.split("#")[0],this.status=this._response.statusCode,this.statusText=c.STATUS_CODES[this.status],this._parseResponseHeaders(e),(r=this._responseHeaders["content-length"])?(this._totalBytes=parseInt(r),this._lengthComputable=!0):this._lengthComputable=!1,this._setReadyState(i.HEADERS_RECEIVED)}},i.prototype._onHttpResponseData=function(t,e){if(this._response===t)return this._responseParts.push(e),this._loadedBytes+=e.length,this.readyState!==i.LOADING&&this._setReadyState(i.LOADING),this._dispatchProgress("progress")},i.prototype._onHttpResponseEnd=function(t){if(this._response===t)return this._parseResponse(),this._request=null,this._response=null,this._setReadyState(i.DONE),this._dispatchProgress("load"),this._dispatchProgress("loadend")},i.prototype._onHttpResponseClose=function(t){var e;if(this._response===t)return e=this._request,this._setError(),e.abort(),this._setReadyState(i.DONE),this._dispatchProgress("error"),this._dispatchProgress("loadend")},i.prototype._onHttpTimeout=function(t){if(this._request===t)return this._setError(),t.abort(),this._setReadyState(i.DONE),this._dispatchProgress("timeout"),this._dispatchProgress("loadend")},i.prototype._onHttpRequestError=function(t,e){if(this._request===t)return this._setError(),t.abort(),this._setReadyState(i.DONE),this._dispatchProgress("error"),this._dispatchProgress("loadend")},i.prototype._dispatchProgress=function(t){var e;(e=new n(t)).lengthComputable=this._lengthComputable,e.loaded=this._loadedBytes,e.total=this._totalBytes,this.dispatchEvent(e)},i.prototype._setError=function(){this._request=null,this._response=null,this._responseHeaders=null,this._responseParts=null},i.prototype._parseUrl=function(t){var e,i,r,n,s;return e=null===this.nodejsBaseUrl?t:d.resolve(this.nodejsBaseUrl,t),(s=d.parse(e,!1,!0)).hash=null,s.auth&&(void 0!==n&&null!==n||void 0!==r&&null!==r)&&(-1===(i=s.auth.indexOf(":"))?n||(n=s.auth):(n||(n=s.substring(0,i)),r||(r=s.substring(i+1)))),(n||r)&&(s.auth=n+":"+r),s},i.prototype._parseResponseHeaders=function(t){var e,i,r,n;for(i in this._responseHeaders={},r=t.headers)n=r[i],e=i.toLowerCase(),this._privateHeaders[e]||(null!==this._mimeOverride&&"content-type"===e&&(n=this._mimeOverride),this._responseHeaders[e]=n);null===this._mimeOverride||"content-type"in this._responseHeaders||(this._responseHeaders["content-type"]=this._mimeOverride)},i.prototype._parseResponse=function(){var t,e,i,r,n,s;switch(e=Buffer.concat?Buffer.concat(this._responseParts):this._concatBuffers(this._responseParts),this._responseParts=null,this.responseType){case"text":this._parseTextResponse(e);break;case"json":this.responseText=null;try{this.response=JSON.parse(e.toString("utf-8"))}catch(t){t,this.response=null}break;case"buffer":this.responseText=null,this.response=e;break;case"arraybuffer":for(this.responseText=null,t=new ArrayBuffer(e.length),s=new Uint8Array(t),i=r=0,n=e.length;0<=n?r<n:r>n;i=0<=n?++r:--r)s[i]=e[i];this.response=t;break;default:this._parseTextResponse(e)}},i.prototype._parseTextResponse=function(t){try{this.responseText=t.toString(this._parseResponseEncoding())}catch(e){e,this.responseText=t.toString("binary")}this.response=this.responseText},i.prototype._parseResponseEncoding=function(){var t,e;return null,(t=this._responseHeaders["content-type"])&&(e=/\;\s*charset\=(.*)$/.exec(t))?e[1]:"utf-8"},i.prototype._concatBuffers=function(t){var e,i,r,n,s,a,o;if(0===t.length)return new Buffer(0);if(1===t.length)return t[0];for(a=0,i=0,n=t.length;i<n;i++)a+=(e=t[i]).length;for(o=new Buffer(a),a=0,r=0,s=t.length;r<s;r++)(e=t[r]).copy(o,a),a+=e.length;return o},i}(),t.exports=o,o.XMLHttpRequest=o,s=function(t){function e(){e.__super__.constructor.apply(this,arguments)}return p(e,t),e}(Error),o.SecurityError=s,e=function(t){function e(){e.__super__.constructor.apply(this,arguments)}return p(e,t),e}(Error),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e}(Error),o.InvalidStateError=e,r=function(t){function e(){e.__super__.constructor.apply(this,arguments)}return p(e,t),e}(Error),o.SyntaxError=a,a=function(t){function e(){e.__super__.constructor.apply(this,arguments)}return p(e,t),e}(Error),n=function(){function t(t){this.type=t,this.target=null,this.currentTarget=null,this.lengthComputable=!1,this.loaded=0,this.total=0}return t.prototype.bubbles=!1,t.prototype.cancelable=!1,t.prototype.target=null,t.prototype.loaded=null,t.prototype.lengthComputable=null,t.prototype.total=null,t}(),o.ProgressEvent=n,h=function(t){function e(t){e.__super__.constructor.call(this),this._request=t,this._reset()}return p(e,l),e.prototype._reset=function(){this._contentType=null,this._body=null},e.prototype._setData=function(t){var e,i,r,n,s,a,o,l;if(void 0!==t&&null!==t)if("string"==typeof t)0!==t.length&&(this._contentType="text/plain;charset=UTF-8"),this._body=new Buffer(t,"utf8");else if(Buffer.isBuffer(t))this._body=t;else if(t instanceof ArrayBuffer){for(e=new Buffer(t.byteLength),l=new Uint8Array(t),i=r=0,a=t.byteLength;0<=a?r<a:r>a;i=0<=a?++r:--r)e[i]=l[i];this._body=e}else{if(!(t.buffer&&t.buffer instanceof ArrayBuffer))throw new Error("Unsupported send() data "+t);for(e=new Buffer(t.byteLength),s=t.byteOffset,l=new Uint8Array(t.buffer),i=n=0,o=t.byteLength;0<=o?n<o:n>o;i=0<=o?++n:--n)e[i]=l[i+s];this._body=e}},e.prototype._finalizeHeaders=function(t,e){this._contentType&&("content-type"in e||(t["Content-Type"]=this._contentType)),this._body&&(t["Content-Length"]=this._body.length.toString())},e.prototype._startUpload=function(t){this._body&&t.write(this._body),t.end()},e}(),o.XMLHttpRequestUpload=h}).call(this)},function(t,e,i){"use strict";i.r(e);i(26),i(20),i(19),i(18),i(17),i(16),i(15);var r=i(0);const n=i(10),s=i(8),a=i(14);var o=process.argv[2],l=i(10),h=l.readFileSync(o),c=JSON.parse(h);c.config.folder||(c.config.folder="images"),l.existsSync(c.config.folder)||l.mkdirSync(c.config.folder),new class{constructor(t,e){this.show_scale=!0,this.config=e||(e={}),this.config.height=this.config.height?this.config.height:200,this.config.width=this.config.width?this.config.width:300,this.config.type||(this.config.type="png"),this.c_type="png",this.stream="createPNGStream","svg"===e.type&&(this.c_type="svg"),"pdf"===e.type&&(this.stream="createPDFStream",this.c_type="pdf"),this.fixed_height_mode=!1,e.fixed_height_mode&&(this.fixed_height_mode=!0),this.tracks={},this.track_order=[];for(let e of t){let t=r.c.getTrack(e);this.tracks[t.config.track_id]=t,this.track_order.push(t.config.track_id)}for(let t of this.track_order){let e=this.tracks[t],i=e.config.scale_link_to;if(i){let t=this.tracks[i];t&&(e.scale_link_to=t)}}this.index=0}getTracksHeight(){let t=3,e={};for(let i in this.tracks){let r=this.tracks[i].config.group;if(r){if(e[r])continue;e[r]=!0}t+=this.tracks[i].config.height+3}return t}drawImages(){let t=this.config.images;if(this.index<t.length){let e=t[this.index],i=null;e.highlight&&(i={start:e.highlight[0],end:e.highlight[1],color:e.highlight[2]?e.highlight[3]:"blue"});let r=e.stub;r||(r=e.loc[0]+"_"+e.loc[1]+"_"+e.loc[2]);let n=a.resolve(this.config.folder,r+"."+this.config.type);this.drawImage(e.loc[0],e.loc[1],e.loc[2],n,i)}}drawImage(t,e,i,r,a){let o=(i-e)/this.config.width,l=this,h=this.fixed_height_mode?this.getTracksHeight():this.config.height;this.canvas=s.createCanvas(this.config.width,h,this.c_type),this.ctx=this.canvas.getContext("2d"),this.getAllFeatures(t,e,i,{pixelWidth:this.config.width,bpPerPixel:o}).then(function(t){if(t){var i={context:l.ctx,bpStart:e,bpPerPixel:o,pixelWidth:l.config.width,pixelHeight:h};let r=3;l.groups={},l.calculateMaxScale(t),l.ctx.clearRect(0,0,l.config.width,l.config.height),l.config.background_color&&"png"===l.config.type&&(l.ctx.fillStyle=l.config.background_color,l.ctx.fillRect(0,0,l.config.width,h));for(let e in t){let n=l.tracks[l.track_order[e]];i.features=t[e];let s=n.config.group,a=n.config.height;s?(l.groups[s]?l.groups[s].label_offset+=15:(l.groups[s]={top:r,height:n.config.height,label_offset:15},r+=n.config.height),i.top=l.groups[s].top,i.height=l.groups[s].height,a=i.height):i.top=r;let o=l.fixed_height_mode||n.config.discrete||s;o&&(l.ctx.save(),l.ctx.rect(0,i.top,i.pixelWidth,a),l.ctx.clip(),l.ctx.beginPath());let h=n.drawFeatures(i);if("ruler"!==n.config.type){l.ctx.fillStyle="black";let t=10;l.config.label_font_size?(l.ctx.font=l.config.label_font_size+"px Arial",t=l.config.label_font_size):l.ctx.font="10px Arial";let e=l.ctx.measureText(n.config.short_label).width+5,r=15;s&&(r=l.groups[s].label_offset,l.ctx.fillStyle=n.config.color,l.ctx.fillRect(l.config.width-(t+2),i.top+r-10,t,t),e+=t+2,l.ctx.fillStyle="black"),l.ctx.fillText(n.config.short_label,l.config.width-e,i.top+r)}o?(l.ctx.restore(),s||(r+=n.config.height+3)):h&&(r=h+3),l.show_scale&&(l.ctx.font="10px Arial",n.drawScale(i.pixelHeight,l.ctx))}if(a){let t=(a.start-i.bpStart)/i.bpPerPixel;t=t<0?0:t;let e=(a.end-a.start)/i.bpPerPixel;e=e>i.pixelWidth?i.pixelWidth:e,l.ctx.globalAlpha=.1,l.ctx.fillStyle=a.color,l.ctx.fillRect(t,0,e,i.pixelHeight),l.ctx.globalAlpha=1}}if("svg"===l.config.type)n.writeFileSync(r,l.canvas.toBuffer());else{const t=n.createWriteStream(r);l.canvas[l.stream]().pipe(t)}l.index++,l.drawImages()}).catch(function(t){console.log(t.toString()),l.index++,l.drawImages()})}autoScale(t,e,i){return t.forEach(function(t){e=Math.min(e,t.value),i=Math.max(i,t.value)}),{min:e,max:i}}calculateMaxScale(t){let e={};for(var i in t){let r=this.tracks[this.track_order[i]];r.set_scale=null;let n=r.config.group;if(n&&"fixed"!==r.config.scale&&!r.config.scale_link_to&&(r.config.scale_group=n),n=r.config.scale_group){let s=e[n];s?(s.features.push(t[i]),s.tracks.push(r)):(s={tracks:[r],features:[t[i]]},e[n]=s)}}for(let t in e){let i=e[t];if(!i.ignore){let t=0,e=-Number.MAX_VALUE,r=null;for(let n of i.features)t=(r=this.autoScale(n,t,e)).min,e=r.max;for(let t of i.tracks)t.set_scale=r}}}getAllFeatures(t,e,i,r){let n=[];for(let s of this.track_order){let a=this.tracks[s];n.push(a.getFeatures(t,e,i,!1,r))}return Promise.all(n)}}(c.tracks,c.config).drawImages()},function(t,e){t.exports=require("path")},function(t,e,i){"use strict";(function(t,e){var r=i(0);class n extends r.c{constructor(t){t.url=t.url.replace("hgTracks","hgRenderTracks"),t.url.includes("/s/")&&(t.url=n._convertSessionURL(t.url)),super(t),this.image=null,this.legend_width=74}static _convertSessionURL(t){let e=t.split("/");return e[0]+"//"+e[2]+"/cgi-bin/hgRenderTracks?hgS_doOtherUser=submit&hgS_otherUserName="+e[4]+"&hgS_otherUserSessionName="+e[5]}addExtraControls(e){let i=this;e.div.append("<hr>"),e.div.append(t("<label>").text("Session Url"));let r=t("<textarea>").val(e.config.url).css({width:"100%",height:"70px"}),n=t("<i class='fas fa-download'></i>").click(function(t){let n=i._convertURL(r.val());e.config.url=n,e.panel.setTrackAttribute(i.config.track_id,"url",n),e.panel.update()});e.div.append(n).append(r)}_convertURL(t){return t=t.replace("hgTracks","hgRenderTracks")}getFeatures(t,i,r,n,s){let a=this,o=s.pixelWidth+this.legend_width;return o=(r-i)/s.bpPerPixel+this.legend_width,new Promise(function(n,s){a.image=new e,a.image.onload=function(){a.config.height=a.image.height,n([])};let l=a.config.url,h="&position="+t+":"+i+"-"+r+"&pix="+o+"&hgt.labelWidth=10";a.image.src=l+h})}drawFeatures(t){let e=t.context;return this.top=t.top,e.globalAlpha=this.config.opacity,e.drawImage(this.image,-this.legend_width,t.top),e.globalAlpha=1,this.bottom=t.top+this.image.height,this.bottom}drawScale(t,e){e.globalAlpha=.7,e.drawImage(this.image,0,0,this.legend_width,t,0,this.top,this.legend_width,t),e.globalAlpha=1}}r.c.track_types.ucsc_track={class:n,name:"UCSC Session"}}).call(this,i(4),i(8).Image)},function(t,e,i){"use strict";(function(t){var e=i(0),r=i(6),n=i(7),s=0,a=5,o=5;const l=50;class h extends e.c{constructor(t){t.color||(t.color="#D3D3D3"),super(t),this._setFeatureSource(),this.config.bigwig&&(this.bigwig_track=new e.d({url:this.config.bigwig,type:"bigwig",discrete:!0,color:"#D3D3D3",scale:"dynamic",height:100})),this.config=t,void 0===t.coverageTrackHeight&&(t.coverageTrackHeight=l),this.visibilityWindow=t.visibilityWindow||3e4,this.viewAsPairs=!0,this.pairsSupported=void 0===t.pairsSupported,this.color=t.color||"rgb(185, 185, 185)",this.sortOption=t.sortOption||{sort:"NUCLEOTIDE"},this.sortDirection=!0,this.filterOption=t.filterOption||{name:"mappingQuality",params:[30,void 0]}}_setFeatureSource(){this.feature_source=new r.a(this.config),this.feature_source.setViewAsPairs(!0),this.coverageTrack=new u(this.config,this),this.alignmentTrack=new f(this.config,this)}getFeatures(t,e,i,r,n){return i-e>5e5&&this.bigwig_track?(this.draw_bigwig=!0,this.bigwig_track.getFeatures(t,e,i,r,n)):(this.draw_bigwig=!1,this.feature_source.getAlignments(t,e,i))}altClick(e,i){this.alignmentTrack.sortAlignmentRows(e,this.sortOption),this.trackView.redrawTile(this.featureSource.alignmentContainer),t(this.trackView.viewportDiv).scrollTop(0),this.sortDirection=!this.sortDirection}computePixelHeight(t){return this.coverageTrack.computePixelHeight(t)+this.alignmentTrack.computePixelHeight(t)}drawFeatures(t){if(this.top=t.top,!this.draw_bigwig)return this.coverageTrack.height>0&&this.coverageTrack.draw(t),this.bottom=this.alignmentTrack.draw(t),this.bottom;this.bottom=this.bigwig_track.drawFeatures(t)}paintAxis(t,e,i){this.coverageTrack.paintAxis(t,e,this.coverageTrackHeight)}getFeatureAt(t,e,i,r){var n,a,o,l,h,c,u=this.feature_source.alignmentContainer.packedAlignmentRows,f=this.feature_source.alignmentContainer.downsampledIntervals;if((n=Math.floor((i.y-this.top-this.coverageTrack.height-s)/this.config.featureHeight))<0){for(l=0,h=f.length;l<h;l++)if(f[l].start<=t&&f[l].end>=t){o=f[l];break}}else if(n<u.length)for(o=void 0,l=0,h=(a=u[n]).alignments.length;l<h;l++)if((c=a.alignments[l]).start<=t&&c.start+c.lengthOnRef>=t){o=c;break}return o}popupData(t,e,i){return i>=this.coverageTrack.top&&i<this.coverageTrack.height?this.coverageTrack.popupData(t,e,this.coverageTrack.top):this.alignmentTrack.popupData(t,e,i-this.alignmentTrack.top)}popupMenuItems(e){var i,r,n=this,s=[],a=[],o="tag"+(n.alignmentTrack.colorByTag?" ("+n.alignmentTrack.colorByTag+")":"");return a.push({key:"none",label:"track color"}),n.viewAsPairs||a.push({key:"strand",label:"read strand"}),n.pairsSupported&&n.alignmentTrack.hasPairs&&a.push({key:"firstOfPairStrand",label:"first-of-pair strand"}),a.push({key:"tag",label:o}),s.push(igv.colorPickerMenuItem(e,this.trackView)),s.push('<div class="igv-track-menu-category igv-track-menu-border-top">Color by</div>'),a.forEach(function(e){r=n.alignmentTrack.colorBy===e.key,s.push(function(e,i,r){var s=[],a={};s.push('<div class="igv-track-menu-item">'),s.push(i?'<i class="fa fa-check fa-check-shim"></i>':'<i class="fa fa-check fa-check-shim fa-check-hidden"></i>'),"tag"===e.key?s.push('<span id="color-by-tag">'):s.push("<span>");return s.push(e.label),s.push("</span>"),s.push("</div>"),a.object=t(s.join("")),a.click=function(){igv.popover.hide(),"tag"===e.key?(igv.dialog.configure(function(){return"Tag Name"},n.alignmentTrack.colorByTag?n.alignmentTrack.colorByTag:"",function(){var e=igv.dialog.$dialogInput.val().trim();n.alignmentTrack.colorBy="tag",e!==n.alignmentTrack.colorByTag&&(n.alignmentTrack.colorByTag=igv.dialog.$dialogInput.val().trim(),n.alignmentTrack.tagColors=new igv.PaletteColorTable("Set1"),t("#color-by-tag").text(n.alignmentTrack.colorByTag)),n.trackView.update()}),igv.dialog.show(t(n.trackView.trackDiv))):(n.alignmentTrack.colorBy=e.key,n.trackView.update())},a}(e,r))}),i=[],n.pairsSupported&&n.alignmentTrack.hasPairs&&(i.push('<div class="igv-track-menu-item igv-track-menu-border-top">'),i.push(!0===n.viewAsPairs?'<i class="fa fa-check fa-check-shim">':'<i class="fa fa-check fa-check-shim fa-check-hidden">'),i.push("</i>"),i.push("View as pairs"),i.push("</div>"),s.push({object:t(i.join("")),click:function(){var i=t(this).find("i");e.hide(),n.viewAsPairs=!n.viewAsPairs,!0===n.viewAsPairs?i.removeClass("fa-check-hidden"):i.addClass("fa-check-hidden"),n.featureSource.setViewAsPairs(n.viewAsPairs),n.trackView.update()}})),s}}function c(t,i,r){var n,s=[0,255,255];if(s)return n=t<5?.1:Math.max(.1,Math.min(1,.1+.9*(t-5)/15)),(n=Math.round(10*n)/10)>=1?e.a.nucleotideColors[i]:"rgba("+s[0]+","+s[1]+","+s[2]+","+n+")"}class u{constructor(t,e){this.parent=e,this.featureSource=e.featureSource,this.height=20,this.dataRange={min:0}}computePixelHeight(t){return this.height}draw(t){var i,r,n,s,a,o,l,h,c,u,f,d=this,p=t.features,g=t.context,m=t.bpPerPixel,_=t.bpStart,v=_+t.pixelWidth*m+1,b=p.coverageMap;b.refSeq&&(f=b.refSeq.toUpperCase()),this.dataRange.max=b.maximum;var y=t.top;for(t.top+=this.height,s=Math.max(1,Math.ceil(1/m)),l=0,h=b.coverage.length;l<h;l++)if(!((i=b.bpStart+l)<_)){if(i>v)break;(c=b.coverage[l])&&(a=Math.round(c.total/this.dataRange.max*this.height),n=this.height-a,r=Math.floor((i-_)/m),e.a.setProperties(g,{fillStyle:this.parent.config.color,strokeStyle:this.color}),e.a.fillRect(g,r,n+y,s,a))}if(f)for(l=0,h=b.coverage.length;l<h;l++)if(!((i=b.bpStart+l)<_)){if(i>v)break;(c=b.coverage[l])&&(a=c.total/this.dataRange.max*this.height,n=this.height-a,r=Math.floor((i-_)/m),o=f[l],c.isMismatch(o)&&(e.a.setProperties(g,{fillStyle:e.a.nucleotideColors[o]}),e.a.fillRect(g,r,n+y,s,a),u=0,["A","C","T","G"].forEach(function(t){var i;i=(c["pos"+t]+c["neg"+t])/d.dataRange.max*d.height,n=d.height-i-u,u+=i,e.a.setProperties(g,{fillStyle:e.a.nucleotideColors[t]}),e.a.fillRect(g,r,n+y,s,i)})))}}popupData(t,e,i){var r,n,s=this.featureSource.alignmentContainer.coverageMap,a=[];return r=t-s.bpStart,(n=s.coverage[r])&&(a.push(igv.browser.referenceFrame.chr+":"+igv.numberFormatter(1+t)),a.push({name:"Total Count",value:n.total}),tmp=n.posA+n.negA,tmp>0&&(tmp=tmp.toString()+" ("+Math.floor((n.posA+n.negA)/n.total*100)+"%)"),a.push({name:"A",value:tmp}),tmp=n.posC+n.negC,tmp>0&&(tmp=tmp.toString()+" ("+Math.floor(tmp/n.total*100)+"%)"),a.push({name:"C",value:tmp}),tmp=n.posG+n.negG,tmp>0&&(tmp=tmp.toString()+" ("+Math.floor(tmp/n.total*100)+"%)"),a.push({name:"G",value:tmp}),tmp=n.posT+n.negT,tmp>0&&(tmp=tmp.toString()+" ("+Math.floor(tmp/n.total*100)+"%)"),a.push({name:"T",value:tmp}),tmp=n.posN+n.negN,tmp>0&&(tmp=tmp.toString()+" ("+Math.floor(tmp/n.total*100)+"%)"),a.push({name:"N",value:tmp})),a}}class f{constructor(t,e){this.config=t,this.parent=e,this.featureSource=e.feature_source,this.alignmentRowHeight=t.alignmentRowHeight||6,this.negStrandColor=t.negStrandColor||"rgba(150, 150, 230, 0.75)",this.posStrandColor=t.posStrandColor||"rgba(230, 150, 150, 0.75)",this.insertionColor=t.insertionColor||"rgb(138, 94, 161)",this.deletionColor=t.deletionColor||"black",this.skippedColor=t.skippedColor||"rgb(150, 170, 170)",this.colorBy=t.colorBy||"none",this.colorByTag=t.colorByTag,this.bamColorTag=void 0===t.bamColorTag?"YC":t.bamColorTag,this.sortOption=t.sortOption||{sort:"NUCLEOTIDE"},this.sortDirection=!0,this.hasPairs=!1}computePixelHeight(t){if(t.packedAlignmentRows){var e=0;return t.hasDownsampledIntervals()&&(e+=o+a),e+this.config.featureHeight*t.packedAlignmentRows.length+5}return this.height}draw(t){var i=this,a=t.features,o=t.context,l=t.bpPerPixel,h=t.bpStart,u=t.pixelWidth,f=h+u*l+1,d=a.packedAlignmentRows,p=a.sequence,g="normal "+(this.config.featureHeight-2)+"px Arial";let m=t.top;function _(t,r,s){var a=i.getAlignmentColor(t.firstAlignment),c=a,u=(t.connectingStart-h)/l,d=(t.connectingEnd-h)/l,p=r+s/2;t.connectingEnd<h||t.connectingStart>f||(t.mq<=0&&(a=n.a.addAlphaToRGB(a,"0.15")),e.a.setProperties(o,{fillStyle:a,strokeStyle:c}),e.a.strokeLine(o,u,p,d,p))}function v(t,r,s){var u,d,m,_=i.getAlignmentColor(t),v=_,b=t.blocks;if(!(t.start+t.lengthOnRef<h||t.start>f))for(t.mq<=0&&(_=n.a.addAlphaToRGB(_,"0.15")),e.a.setProperties(o,{fillStyle:_,strokeStyle:v}),m=0;m<b.length;m++)if(!((d=b[m]).start+d.len<h)){if(y(d),d.start+d.len>f)break;t.insertions&&t.insertions.forEach(function(t){var n=(t.start-h)/l-1;e.a.fillRect(o,n,r-1,3,s+2,{fillStyle:i.insertionColor})})}function y(n){var f,d,y,x,w,k,S,A=n.start-a.start,T=(n.start-h)/l,P=(n.start+n.len-h)/l,C=Math.max(1,P-T),E=i.config.featureHeight/2,I=n.seq.toUpperCase(),F=i.skippedColor,M=i.deletionColor,R=r+s/2;if(void 0!==n.gapType&&void 0!==P&&void 0!==u&&("D"===n.gapType?e.a.strokeLine(o,u,R,T,R,{strokeStyle:M}):e.a.strokeLine(o,u,R,T,R,{strokeStyle:F})),u=P,!0===t.strand&&m===b.length-1?(k=[T,P,P+E,P,T,T],S=[r,r,r+s/2,r+s,r+s,r],e.a.fillPolygon(o,k,S,{fillStyle:_}),t.mq<=0&&e.a.strokePolygon(o,k,S,{strokeStyle:v})):!1===t.strand&&0===m?(k=[P,T,T-E,T,P,P],S=[r,r,r+s/2,r+s,r+s,r],e.a.fillPolygon(o,k,S,{fillStyle:_}),t.mq<=0&&e.a.strokePolygon(o,k,S,{strokeStyle:v})):(e.a.fillRect(o,T,r,C,s,{fillStyle:_}),t.mq<=0&&(o.save(),o.strokeStyle=v,o.strokeRect(T,r,C,s),o.restore())),p&&"*"!==I)for(var U=0,D=I.length;U<D;U++)d=I.charAt(U),f=p.charAt(A+U),"="===d&&(d=f),"X"!==d&&f===d||(w=n.qual&&n.qual.length>U?c(n.qual[U],d,n.start):e.a.nucleotideColors[d])&&(y=(n.start+U-h)/l,x=Math.max(1,1/l),l<.15?e.a.strokeText(o,d,y+x/2,r+2,{strokeStyle:w,font:g,textAlign:"center",textBaseline:"hanging"}):e.a.fillRect(o,y,r,x,s,{fillStyle:w}))}}return p&&(p=p.toUpperCase()),s=3,d&&d.forEach(function(t,e){var n,a=s+i.config.featureHeight*e+m,o=i.config.featureHeight-2;for(e=0;e<t.alignments.length;e++)if(n=t.alignments[e],i.hasPairs=i.hasPairs||n.isPaired(),!(n.start+n.lengthOnRef<h)){if(n.start>f)break;!0!==n.hidden&&(n instanceof r.b?(_(n,a,o),v(n.firstAlignment,a,o),n.secondAlignment&&v(n.secondAlignment,a,o)):v(n,a,o))}}),s+i.config.featureHeight*d.length+m}sortAlignmentRows(t,e){var i=this,r=this.featureSource.alignmentContainer,n=r.packedAlignmentRows;n.forEach(function(i){i.updateScore(t,r,e)}),n.sort(function(t,e){return i.sortDirection?t.score-e.score:e.score-t.score})}static doSortAlignmentRows(t,e,i,r){var n=e.packedAlignmentRows,s=e.sequence;s?(s=s.toUpperCase(),n.forEach(function(r){r.updateScore(t,e,i)}),n.sort(function(t,e){return r?t.score-e.score:e.score-t.score})):console.log("No sequence, no traversal. No discussion!")}popupData(t,e,i){var r,n,a,o,l,h,c=this.featureSource.alignmentContainer.packedAlignmentRows,u=this.featureSource.alignmentContainer.downsampledIntervals;if((r=Math.floor((i-s)/this.config.featureHeight))<0){for(o=0,l=u.length;o<l;o++)if(u[o].start<=t&&u[o].end>=t){a=u[o];break}}else if(r<c.length)for(a=void 0,o=0,l=(n=c[r]).alignments.length;o<l;o++)if((h=n.alignments[o]).start<=t&&h.start+h.lengthOnRef>=t){a=h;break}return a?a.popupData(t):[]}getAlignmentColor(t){var e,i,n=this.colorBy;switch(i=this.parent.config.color,n){case"strand":i=t.strand?this.posStrandColor:this.negStrandColor;break;case"firstOfPairStrand":t instanceof r.b?i=t.firstOfPairStrand()?this.posStrandColor:this.negStrandColor:t.isPaired()&&(t.isFirstOfPair()?i=t.strand?this.posStrandColor:this.negStrandColor:t.isSecondOfPair()?i=t.strand?this.negStrandColor:this.posStrandColor:console.log("ERROR. Paired alignments are either first or second."));break;case"tag":void 0!==(e=t.tags()[this.colorByTag])&&(i=this.bamColorTag===this.colorByTag?"rgb("+e+")":this.tagColors.getColor(e));break;default:i=this.parent.config.color}return i}}h.filters={noop:function(){return function(t){return!1}},strand:function(t){return function(e){return e.strand===t}},mappingQuality:function(t,e){return function(i){return!!(t&&i.mq<t)||!!(e&&i.mq>e)}}},e.c.custom_tracks.bam=h,e.c.track_types.bam={class:h,name:"BAM"}}).call(this,i(4))},function(t,e,i){"use strict";(function(t){var e=i(0);function r(e){return new Promise(function(i,r){let n=new t;n.start=e[0],n.end=e[1],n.onload=function(){i(n)},n.src=e[2]})}e.c.track_types.tiled_image_track={class:class extends e.c{constructor(t){super(t)}getFeatures(t,e,i,n,s){let a=this.config.images[t];if(!a)return new Promise(function(t,e){t([])});let o=[];for(let t of a){if(t[0]>i)break;t[1]<e||o.push(r(t))}return Promise.all(o)}drawScale(t,e){}drawFeatures(t){let e=t.bpStart+t.pixelWidth*t.bpPerPixel+1,i=0;for(let r of t.features){let n=(r.start-t.bpStart)/t.bpPerPixel;n=n<0?0:n;let s=0;t.bpStart>r.start&&(s=(t.bpStart-r.start)/(r.end-r.start)*r.width);let a=r.width;r.end>e&&(a=r.width-(r.end-e)/(r.end-r.start)*r.width);let o=t.pixelWidth;r.end<e&&(o=t.pixelWidth-(e-r.end)/t.bpPerPixel);let l=this.config.y_scale_factor?t.bpPerPixel/this.config.y_scale_factor:1;t.context.drawImage(r,s,0,a-s,r.height,n,t.top,o-n,r.height/l),i=r.height}return this.bottom=t.top+i,this.bottom}},name:"Tiled Image Track"}}).call(this,i(8).Image)},function(t,e,i){"use strict";(function(t){var e=i(2),r=i(0);let n=function(t,e){e.rjmcmc=parseFloat(t[0]),e.id=parseInt(t[1])};r.c.track_types.mlv_peaky_track={class:class extends r.b{_setFeatureSource(){let t=this.config.url;t.endsWith(".bb")||t.endsWith(".bigbed")?this.feature_source=new e.a(this.config,n):this.feature_source=new e.d(this.config,n)}getFeatureAt(t,e,i,r,n){if(!this.y_field)return super.getFeatureAt(t,e,i,r,n);let s=2*r,a=this.feature_source.featureCache.queryFeatures(e,t-s,t+s),o=this.config.height-12,l=this.min_max[1]-this.min_max[0],h=this.y_field.field,c=this.bottom-12;for(let t of a){let e=this.data_view.getItemById(t.id);if(!e)continue;let r=c-(e[h]-this.min_max[0])/l*o;if(i.y>=r&&i.y<=r+5)return t}return null}addExtraControls(e){let i=this;e.div.empty();let r=t("<div class='t-d-div'></div>");r.append("<label>Track Height:</label>").appendTo(e.div),t("<div>").slider({min:10,max:500,value:e.config.height,slide:function(t,i){e.config.height=i.value,e.panel.setTrackAttribute(e.config.track_id,"height",e.config.height),e.panel.update()}}).css({margin:"5px 3px"}).appendTo(r);let n=t("<div class='t-d-div'></div>");n.append("<label>Significance Level:</label>").appendTo(e.div),this.sig_slider=t("<div>").slider({min:0,max:1,step:.01,value:e.config.sig_val,slide:function(t,r){e.config.sig_val=r.value,e.panel.setTrackAttribute(e.config.track_id,"sig_val",e.config.sig_val),e.panel.update(),i.sig_input.val(r.value)}}).css({margin:"5px 3px"}),this.sig_slider.appendTo(n),i.sig_input=t("<input>").on("blur keypress",function(r){if("keypress"===r.type&&13!==r.which)return;let n=t(this).val();(n=parseFloat(n))>=0&&n<=1&&(e.config.sig_val=n,e.panel.setTrackAttribute(e.config.track_id,"sig_val",n),e.panel.update(),i.sig_slider.slider("option","value",n))}).appendTo(n).width(40).val(i.config.sig_val)}drawScale(t,e){let i=this.config.sig_val||0===this.config.sig_val?this.config.sig_val:.1,r=this.bottom-3-(i-0)/1*(this.config.height/2);e.textBaseline="alphabetic",e.fillText(i,20,r-2)}drawFeatures(t){let e=t.context;this.top=t.top;let i=this.config.sig_val||0===this.config.sig_val?this.config.sig_val:.1;this.bottom=this.top+this.config.height;let r=this.bottom-3,n=this.config.height/2,s=this.bottom-n-3,a=(this.config.viewpoint-t.bpStart)/t.bpPerPixel,o=r-(i-0)/1*n;e.moveTo(0,o),e.strokeStyle="gray",e.lineTo(t.pixelWidth,o),e.stroke();for(let o of t.features){let l=o.rjmcmc>=i;if(this.filter_function&&!this.filter_function(o))continue;let h=(o.start-t.bpStart)/t.bpPerPixel,c=(o.end-o.start)/t.bpPerPixel;c<2&&(c=2);let u=r-(o.rjmcmc-0)/1*n,f=l?"red":"gray";e.fillStyle=f,e.beginPath(),e.arc(h,u,3,0,2*Math.PI,!1),e.fill(),l&&(e.moveTo(h,s),e.bezierCurveTo(h,s-n,a,s-n,a,s),e.stroke())}return this.bottom}}}}).call(this,i(4))},function(t,e,i){"use strict";(function(t){var e=i(2),r=i(0);function n(t){let e=3*t;return function(t,i){i.data=[];for(let r=0;r<e;r+=3)i.data.push([parseFloat(t[r]),parseFloat(t[r+1]),parseFloat(t[r+2])])}}r.c.track_types.mlv_deseq_track={class:class extends r.b{constructor(t){t.format="feature",t.colors||(t.colors=["#FF0000","#0000FF","#008000"]),t.pvalue_cutoff||(t.pvalue_cutoff=.05),super(t)}_setFeatureSource(){this.config.url&&this.config.url.endsWith(".gz")?this.feature_source=new e.d(this.config,n(this.config.samples.length)):this.feature_source=new e.a(this.config,n(this.config.samples.length))}addExtraControls(e){e.div.empty();let i=t("<div class='t-d-div'></div>");i.append("<label>height:</label>").appendTo(e.div),t("<div>").slider({min:10,max:500,value:e.config.height,slide:function(t,i){e.config.height=i.value,e.panel.setTrackAttribute(e.config.track_id,"height",e.config.height),e.panel.update()}}).css({margin:"5px 3px"}).appendTo(i);let r=t("<div class='t-d-div'></div>").append("<label>pValue:</label>").appendTo(e.div);e.pval_slider=t("<div>").slider({max:1,min:0,step:.01,value:e.config.pvalue_cutoff,slide:function(t,i){e.config.pvalue_cutoff=i.value,e.panel&&(e.panel.setTrackAttribute(e.config.track_id,"pvalue_cutoff",i.value),e.panel.update()),e.pval_input.val(i.value)}}).css({margin:"5px 3px"}).appendTo(r),e.pval_input=t("<input>").on("blur keypress",function(t){if("keypress"===t.type&&13!==t.which)return;let i=e.pval_input.val();i=parseFloat(i),isNaN(i)||i<0||i>1||(e.pval_slider.slider("option","value",i),e.panel&&(e.panel.setTrackAttribute(e.config.track_id,"pvalue_cutoff",i),e.panel.update()))}).width(50).val(e.config.pvalue_cutoff).appendTo(r)}drawFeatures(t){let e=t.features,i=this.config.pvalue_cutoff,r=t.top,n=parseInt(r)+parseInt(this.config.height);this.top=r,this.bottom=n;let s=t.context,a=(this.config.colors,this.config.y_max?this.config.y_max:this.config.initial_y_max,this.config.height),o=this.config.samples.length,l=0,h=[];this.max_y_vals=[0,0,0],this.min_y_vals=[0,0,0];for(let i=0;i<e.length;i++){let r=e[i],n=r.end-r.start,s=(r.start+n/2-t.bpStart)/t.bpPerPixel;if(!(s>l))continue;l=Math.floor(s)+1,(n/=t.bpPerPixel)<1&&(n=1);let a=0,c={x_pos:s,len:n,y_vals:[],pvals:[]};for(let t=0;t<o;t++){if(this.filter_function&&(r.id=r.data[t][0],!this.filter_function(r))){a++,c.y_vals.push(!1);continue}let e=r.data[t][1];e>this.max_y_vals[t]?this.max_y_vals[t]=e:e<this.min_y_vals[t]&&(this.min_y_vals[t]=e),c.y_vals.push(e),c.pvals.push(r.data[t][2])}a!==o&&h.push(c)}this.centers=[];let c=[],u=[],f=a/o;for(let t=0;t<o;t++){let e=this.max_y_vals[t]/(this.max_y_vals[t]-this.min_y_vals[t])*f+t*f;this.centers.push(e+r),c.push(r+f*t),u.push(f/(this.max_y_vals[t]-this.min_y_vals[t]))}s.globalAlpha=1;for(let t of h)for(let e=0;e<o;e++){let r=t.y_vals[e];if(!1!==r)if(r*=u[e],s.fillStyle=this.colorScale(t.pvals[e]),r>0){let n=this.centers[e]-r,a=this.config.sample_colors[e][0];t.pvals[e]>i&&(a="lightgray"),s.fillStyle=a,s.fillRect(t.x_pos-t.len/2,n,t.len,r)}else{let n=this.config.sample_colors[e][1];t.pvals[e]>i&&(n="lightgray"),s.fillStyle=n,s.fillRect(t.x_pos-t.len/2,this.centers[e],t.len,-r)}}return n}getFeatureAt(t,e,i,r,n,s){let a=2*r,o=this.feature_source.featureCache.queryFeatures(e,t-a,t+a);if(o[0]){let t=n.getImageData(i.x,i.y+s,1,1).data;if(0===t[0]&&0===t[1]&&0===t[2])return null;let e=o[0],r=this.config.height/this.config.samples.length,a=Math.floor((i.y-this.top)/r),l=e.data[a][0];return e.id=l,e}return null}colorScale(t,e){let i=t/40*100;var r,n;return(i=i>100?100:i)<50?(n=255,r=Math.round(5.1*i)):(r=255,n=Math.round(510-5.1*i)),"#"+("000000"+(65536*r+256*n+0).toString(16)).slice(-6)}drawScale(t,e){let i=this.bottom,r=this.top,n=(i-r)/this.config.samples.length;e.save(),e.rect(0,r,120,i-r),e.clip(),e.fillStyle="black",e.textAlign="left",e.beginPath(),e.moveTo(0,r),e.lineTo(0,i);for(let t=0;t<this.config.samples.length;t++){let i=r+t*n;e.moveTo(0,i),e.lineTo(20,i),e.textBaseline="top",e.fillText(this.max_y_vals[t].toFixed(2),20,i),e.moveTo(0,this.centers[t]),e.lineTo(20,this.centers[t]),e.textBaseLine="middle",e.fillText(this.config.samples[t],3,i+n/2),i+=n,e.moveTo(0,i),e.lineTo(20,i),e.textBaseline="alphabetic",e.fillText(this.min_y_vals[t],20,i)}e.stroke(),e.restore()}}}}).call(this,i(4))},function(t,e,i){"use strict";(function(t){var e=i(2),r=i(0);function n(t){let e=2*t;return function(t,i){i.data=[];for(let r=0;r<e;r+=2)i.data.push([parseFloat(t[r]),parseFloat(t[r+1])])}}class s extends r.b{constructor(t){t.format="feature",t.colors||(t.colors=["#FF0000","#0000FF","#008000"]),super(t)}_setFeatureSource(){this.config.url&&this.config.url.endsWith(".gz")?this.feature_source=new e.d(this.config,n(this.config.conditions.length)):this.feature_source=new e.a(this.config,n(this.config.conditions.length))}addExtraControls(e){let i=this;e.div.empty();let r=4*this.config.initial_y_max,n=this.config.initial_y_max/6,s=this.config.y_max?this.config.y_max:this.config.initial_y_max,a=t("<div>");e.fixed_scale_check=t("<input>").attr({type:"checkbox"}).prop("checked",!e.config.dynamic_scale).click(function(i){let r=!0;t(this).prop("checked")&&(r=!1),e.config.dynamic_scale=r,e.panel&&(e.panel.setTrackAttribute(e.config.track_id,"dynamic_scale",r),e.panel.update()),e.scale_slider.slider(r?"disable":"enable"),e.max_y_input.attr("disabled",r)}),a.append(e.fixed_scale_check).append("<label>Fixed Scale</label><br>"),e.scale_slider=t("<div>").slider({max:r,min:n,step:(r-n)/100,value:s,slide:function(t,i){e.config.y_max=i.value,e.panel&&(e.panel.setTrackAttribute(e.config.track_id,"y_max",i.value),e.panel.update()),e.max_y_input.val(i.value)}}),e.max_y_input=t("<input>").on("blur keypress",function(t){if("keypress"===t.type&&13!==t.which)return;let i=e.max_y_input.val();i=parseFloat(i);let r=e.scale_slider,n=r.slider("option","max"),s=r.slider("option","min");i>n?r.slider("option","max",i):i<s&&r.slider("option","min",i),r.slider("option","step",(n-s)/100),r.slider("option","value",i),e.panel&&(e.panel.setTrackAttribute(e.config.track_id,"y_max",i),e.panel.update())}).width(50).val(s);let o=t("<div class='t-d-div'></div>");o.append("<label>Track Height:</label>").appendTo(e.div),t("<div>").slider({min:10,max:500,value:e.config.height,slide:function(t,i){e.config.height=i.value,e.panel.setTrackAttribute(e.config.track_id,"height",e.config.height),e.panel.update()}}).css({margin:"5px 3px"}).appendTo(o),e.div.append("<hr>"),a.append(e.scale_slider.css("margin-bottom","4px")).append("<span>Max Y:</span>").append(e.max_y_input).appendTo(e.div),e.div.append("<hr>");let l="sd-ra-name-"+e.id,h=t("<div>").append("<label>Display SD as:</label><br>"),c=!1;this.config.display_sd&&"box"!=this.config.display_sd||(c=!0),h.append(t("<input>").attr({type:"radio",value:"box",checked:c,name:l})),h.append(t("<span>").text("Box")),h.append(t("<input>").attr({type:"radio",value:"bar",checked:"bar"===this.config.display_sd,name:l})),h.append(t("<span>").text("Bar")),h.appendTo(e.div),t("input[name='"+l+"']").click(function(r){let n=t("input[name='"+l+"']:checked").val();e.config.display_sd=n,e.panel&&(e.panel.setTrackAttribute(i.config.track_id,"display_sd",n),e.panel.update())}),e.div.append("<hr>");let u=t("<div class='t-d-div'></div>").appendTo(e.div);u.append("<label>Sample Colors</label><br>");for(let r=0;r<this.config.conditions.length;r++){let n=t("<div>"),s=t("<input>").attr({type:"color"}).data("index",r).val(this.config.colors[r]).height(20).width(20).css({"margin-right":"3px",padding:"0px"}).change(function(r){let n=t(this).val();e.config.colors[t(this).data("index")]=n,e.panel&&(e.panel.setTrackAttribute(i.config.track_id,"colors",e.config.colors),e.panel.update())});n.append(s).append(t("<span>").text(this.config.conditions[r])).appendTo(u)}e.config.dynamic_scale&&(e.scale_slider.slider("disable"),e.max_y_input.slider("disable"))}calculateMaxY(t){let e=0,i=0,r=this.config.conditions.length;for(let n of t.features){let s=n.end-n.start,a=(n.start+s/2-t.bpStart)/t.bpPerPixel;if(a>e){e=Math.floor(a)+1;for(let t=0;t<r;t++){let e=n.data[t][0]+n.data[t][1];e>i&&(i=e)}}}return i}drawFeatures(t){let e=t.features,i=this.config.discrete?t.top:0,r=this.config.discrete?parseInt(i)+parseInt(this.config.height):t.pixelHeight;this.config.display_difference,this.top=i,this.bottom=r;let n=t.context,s=null,a=[],o=this.config.colors,l=this.config.y_max?this.config.y_max:this.config.initial_y_max;this.config.dynamic_scale&&(l=this.calculateMaxY(t));let h=this.config.discrete?this.config.height:t.pixelHeight,c=this.config.conditions.length,u=!1,f=!0;"bar"===this.config.display_sd&&(f=!1,t.bpPerPixel<100&&(u=!0));let d=0;for(let r=0;r<e.length;r+=1){let p=e[r],g=p.end-p.start,m=(p.start+g/2-t.bpStart)/t.bpPerPixel;if(!(m>d))continue;d=Math.floor(m)+1,0,(g/=t.bpPerPixel)<1&&(g=1);let _=[];for(let t=0;t<c;t++){let e=h-p.data[t][0]/l*h+i;e=e,this.config.asline&&null!=s?(n.strokeStyle=o[t],n.fillStyle=o[t],n.beginPath(),n.moveTo(s,a[t]),n.lineWidth=1,n.lineTo(m,e),n.stroke()):(n.fillStyle=o[t],n.strokeStyle=o[t],n.globalAlpha=.4,n.fillRect(m-g/2,e,g,this.bottom-e),n.globalAlpha=1);let r=p.data[t][1]/l*h;f?(n.globalAlpha=.4,n.fillRect(m-g/2,e-r,g,2*r),n.globalAlpha=1):u&&(n.beginPath(),n.moveTo(m-4,e-r),n.lineTo(m+4,e-r),n.moveTo(m,e-r),n.lineTo(m,e+r),n.moveTo(m-4,e+r),n.lineTo(m+4,e+r),n.stroke()),_.push(e)}a=_,s=m}if(this.config.exclusion_zone){let e=t.bpStart,i=t.bpStart+t.bpPerPixel*t.pixelWidth,r=this.config.exclusion_zone;if(r[0]>e&&r[0]<i||r[1]>e&&r[1]<i){let i=(r[0]-e)/t.bpPerPixel;i=i<0?0:i;let s=(r[1]-e)/t.bpPerPixel;s=s>t.pixelWidth?t.pixelWidth:s,n.fillStyle="white",n.strokeStyle="grey",n.rect(i,this.top+1,s-i,this.config.height-1),n.fill(),n.stroke()}if((r=this.config.viewpoint)&&(r[0]>e&&r[0]<i||r[1]>e&&r[1]<i)){let i=(r[0]-e)/t.bpPerPixel;i=i<0?0:i;let s=(r[1]-e)/t.bpPerPixel;s=s>t.pixelWidth?t.pixelWidth:s,n.fillStyle="grey",n.fillRect(i,this.top+1,s-i,this.config.height-1)}}return this.max_y=l,this.config.discrete?r:null}drawScale(t,e){let i=this.bottom,r=this.top;e.save(),e.rect(0,r,120,i-r),e.clip();let n=this.max_y;e.fillStyle="black",e.textAlign="left",e.beginPath(),e.moveTo(0,r),e.lineTo(0,i),e.moveTo(0,r),e.lineTo(20,r),e.moveTo(0,i),e.lineTo(20,i),e.font="12px Arial",e.stroke(),e.textBaseline="top",e.fillText(n.toFixed(2),20,r),e.textBaseline="alphabetic",e.fillText(0,20,i),e.font="14px Arial";let s=this.config.legend_label?this.config.legend_label:"Condition";e.fillText(s,10,r+30),e.font="12px Arial";let a=this.config.colors;for(let t=0;t<this.config.conditions.length;t++)e.fillStyle=a[t],e.globalAlpha=.4,e.fillRect(10,r+40+30*t,20,20),e.globalAlpha=1,e.fillRect(10,r+49+30*t,20,2),e.fillStyle="black",e.fillText(this.config.conditions[t],31,r+55+30*t);e.restore()}}r.c.custom_tracks.capture_compare=s,r.c.track_types.capture_compare={class:s}}).call(this,i(4))},function(t,e){t.exports=require("url")},function(t,e){t.exports=require("os")},function(t,e){t.exports=require("https")},function(t,e){t.exports=require("http")},function(t,e){t.exports=require("najax")},function(t,e,i){"use strict";(function(t){var e=i(2),r=i(0);class n extends e.c{constructor(t){t.sourceType="custom",t.featureHeight=t.featureHeight?t.featureHeight:12,super(t),this.header=!0}retrieveFeatures(e,i,r,n,s){let a=this;return new Promise(function(n,s){let o=a.config.url+"/"+e+"/"+i+"/"+r;t({url:o,dataType:"json"}).done(t=>{n(t)})})}}class s extends r.b{constructor(t){t.format="feature",super(t)}_setFeatureSource(){this.feature_source=new n(this.config)}}r.c.custom_tracks.custom_annotation=s,r.c.track_types.custom_annotation={class:s};let a=function(t,e){e.id=parseInt(t[0])};class o extends r.b{constructor(t){t.format="feature",super(t)}_setFeatureSource(){this.feature_source=new e.a(this.config,a)}}r.c.custom_tracks.peak_model_track=o,r.c.track_types.peak_model_track={class:o};r.c.track_types.mlv_feature_track={class:class extends r.b{_setFeatureSource(){let t=this.config.url;t.endsWith(".bb")||t.endsWith(".bigbed")?this.feature_source=new e.a(this.config,a):this.feature_source=new e.d(this.config,a)}setYField(t,e){this.data_view=t,this.config.featureHeight=5,this.config.displayMode="EXPANDED",this.y_field=e,t&&(this.min_max=t.getMinMax(e.field))}getFeatureAt(t,e,i,r,n){if(!this.y_field)return super.getFeatureAt(t,e,i,r,n);let s=2*r,a=this.feature_source.featureCache.queryFeatures(e,t-s,t+s),o=this.config.height-12,l=this.min_max[1]-this.min_max[0],h=this.y_field.field,c=this.bottom-12;for(let t of a){let e=this.data_view.getItemById(t.id);if(!e)continue;let r=c-(e[h]-this.min_max[0])/l*o;if(i.y>=r&&i.y<=r+5)return t}return null}drawScale(t,e){if(!this.y_field)return;let i=this.bottom-12,r=this.top;e.save(),e.rect(0,r,120,i-r),e.clip(),e.fillStyle="black",e.textAlign="left",e.beginPath(),e.moveTo(0,r),e.lineTo(0,i),e.moveTo(0,r),e.lineTo(20,r),e.textBaseline="top",e.fillText(this.min_max[1].toFixed(2),20,this.top),e.moveTo(0,i),e.lineTo(20,i),e.textBaseline="alphabetic",e.fillText(this.min_max[0],20,i),e.textBaseLine="middle",e.fillText(this.y_field.name,3,r+this.config.height/2),e.stroke(),e.restore()}drawFeatures(t){if(!this.y_field)return void super.drawFeatures(t);let e=this.min_max[1]-this.min_max[0],i=this.y_field.field,r=t.context;this.top=t.top,this.bottom=this.top+this.config.height;let n=this.bottom-12,s=n-this.top;for(let a of t.features){if(this.filter_function&&!this.filter_function(a))continue;let o=(a.start-t.bpStart)/t.bpPerPixel,l=(a.end-a.start)/t.bpPerPixel;l<2&&(l=2);let h=this.data_view.getItemById(a.id);if(!h)continue;let c=(h[i]-this.min_max[0])/e*s;a.color=this.config.color,this.color_function&&(a.color=this.color_function(a));let u=n-c;r.fillStyle=a.color,r.fillRect(o,u,l,4),this.renderFeatureLabel(r,a,o,o+l,u,0,t.pixelWidth)}return this.bottom}}};r.c.track_types.mlv_smooth_wig_track={class:class extends r.d{drawFeatures(t){let e,i=this,n=t.features,s=i.config.color,a=t.context,o=t.bpPerPixel,l=t.bpStart,h=t.pixelWidth,c=t.pixelHeight,u=this.config.discrete?t.top:0,f=l+h*o+1;if(this.config.group?c=t.height:this.config.discrete&&(c=this.config.height),s||(s="black"),i.prev_coords={x:0,y:0},n){if(i.scale_link_to){let t=i.scale_link_to.config;t&&(i.config.scale=t.scale,i.max_y=i.scale_link_to.max_y,i.min_y=i.scale_link_to.min_y)}else if(i.set_scale)i.min_y=i.set_scale.min,i.max_y=i.set_scale.max;else if(void 0===i.max_y&&"automatic"===i.config.scale||"dynamic"===i.config.scale){var d=function(t){var e=0,i=-Number.MAX_VALUE;return t.forEach(function(t){e=Math.min(e,t.value),i=Math.max(i,t.value)}),{min:e,max:i}}(n);i.min_y=d.min,i.max_y=d.max}else"fixed"===i.config.scale&&(i.min_y=i.config.min_y,i.max_y=i.config.max_y);if(e=i.max_y-i.min_y,a.globalAlpha=this.config.opacity?this.config.opacity:1,i.config.smooth){let t=u+c;i.smooths=Array(h).fill(t)}if(i.is_line){let t=(1-i.config.value/e)*c;r.a.strokeLine(a,0,t,h,t,{strokeStyle:i.config.color,lineWidth:i.config.width?i.config.width:1})}else n.forEach(function(t,n,h){var d,p,g,m,_,v,b,y,x;if(!(t.end<l)&&(!(t.start>f)&&(g=Math.floor((t.start-l)/o),b=Math.floor((t.end-l)/o),_=Math.max(0,b-g),y=i.min_y,x=i.max_y,y>0&&x<0||y<0&&x>0?t.value<0?(d=i.max_y/e,p=-t.value/e):(d=(i.max_y-t.value)/e,p=t.value/e):i.min_y<0?(d=0,p=-t.value/e):(d=1-(t.value-i.min_y)/e,p=(t.value+i.min_y)/e),m=(m=d*c+u)<u?u:m,v=(v=p*c)>c?c:v,"line"===i.config.display?(i.prev_coords.x&&r.a.strokeLine(a,g,m,i.prev_coords.x,i.prev_coords.y,{strokeStyle:s,lineWidth:3}),i.prev_coords.x=g,i.prev_coords.y=m):r.a.fillRect(a,g,m,_,v,{fillStyle:s}),i.config.smooth)))for(let t=g;t<g+_;t++)i.smooths[t]=m});if(i.config.smooth){let t=Math.round(i.config.smooth/o),e=t/2,r=0;for(let e=0;e<t;e++)r+=i.smooths[e];a.beginPath(),a.moveTo(e,r/t);for(let n=e+1;n<h-e;n++)r=r-i.smooths[n-e-1]+i.smooths[n+e],a.lineTo(n,r/t);a.strokeStyle="red",a.stroke()}if(a.globalAlpha=1,i.config.thresholds){let n=u+(1-i.config.thresholds[t.chr]/e)*c;r.a.strokeLine(a,0,n,h,n,{strokeStyle:"black",lineWidth:1})}}if(this.top=u,this.bottom=u+c,this.config.discrete)return this.bottom;this.top=0,this.bottom=0}}}}).call(this,i(25))}]);